{
  when(perspectives.as(Issuable.class,resource)).thenReturn(issuable);
  RulesBuilder rulesBuilder=new RulesBuilder();
  rulesBuilder.add(ruleKey1).setName("rule1").setDebtSubCharacteristic("MEMORY_EFFICIENCY");
  rulesBuilder.add(ruleKey2).setName("rule2").setDebtSubCharacteristic("MODULARITY");
  rules=rulesBuilder.build();
  when(ruleFinder.findByKey(ruleKey1)).thenReturn(org.sonar.api.rules.Rule.create(ruleKey1.repository(),ruleKey1.rule()));
  when(ruleFinder.findByKey(ruleKey2)).thenReturn(org.sonar.api.rules.Rule.create(ruleKey2.repository(),ruleKey2.rule()));
  when(debtModel.characteristics()).thenReturn(newArrayList(efficiency,memoryEfficiency,reusability,modularity));
  when(debtModel.characteristicByKey("EFFICIENCY")).thenReturn(efficiency);
  when(debtModel.characteristicByKey("MEMORY_EFFICIENCY")).thenReturn(memoryEfficiency);
  when(debtModel.characteristicByKey("REUSABILITY")).thenReturn(reusability);
  when(debtModel.characteristicByKey("MODULARITY")).thenReturn(modularity);
  decorator=new DebtDecorator(perspectives,debtModel,rules,ruleFinder);
}
