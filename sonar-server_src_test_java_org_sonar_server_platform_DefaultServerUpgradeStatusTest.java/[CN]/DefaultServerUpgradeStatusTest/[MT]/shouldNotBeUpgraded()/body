{
  DatabaseConnector connector=mock(DatabaseConnector.class);
  when(connector.getDatabaseVersion()).thenReturn(SchemaMigration.LAST_VERSION);
  DefaultServerUpgradeStatus status=new DefaultServerUpgradeStatus(connector);
  status.start();
  assertThat(status.isInstalledFromScratch(),is(false));
  assertThat(status.isUpgraded(),is(false));
  assertThat(status.getInitialDbVersion(),is(SchemaMigration.LAST_VERSION));
}
