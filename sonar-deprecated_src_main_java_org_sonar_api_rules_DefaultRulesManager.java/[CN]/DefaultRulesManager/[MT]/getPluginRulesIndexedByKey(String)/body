{
  Map<String,Rule> rulesByKey=rulesByPluginAndKey.get(pluginKey);
  if (rulesByKey == null) {
    rulesByKey=new HashMap<String,Rule>();
    List<Rule> rules=rulesDao.getRulesByPlugin(pluginKey);
    if (rules != null) {
      for (      Rule rule : rules) {
        rulesByKey.put(rule.getKey(),rule);
      }
    }
    rulesByPluginAndKey.put(pluginKey,rulesByKey);
  }
  return rulesByKey;
}
