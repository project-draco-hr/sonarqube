{
  for (  SyntaxHighlightingRule syntaxHighlightingRule : rulesMatchingCurrentIndex) {
    if (currentIndex == syntaxHighlightingRule.getEndPosition()) {
      injectClosingHtml(decoratedText);
      currentOpenTags.remove();
    }
  }
  for (  SyntaxHighlightingRule syntaxHighlightingRule : rulesMatchingCurrentIndex) {
    if (currentIndex == syntaxHighlightingRule.getStartPosition()) {
      injectOpeningHtmlForRule(syntaxHighlightingRule.getTextType(),decoratedText);
      currentOpenTags.add(syntaxHighlightingRule.getTextType());
    }
  }
}
