{
  List<SyntaxHighlightingRule> highlightingRules=syntaxHighlighting.getSyntaxHighlightingRuleSet();
  StringBuilder decoratedText=new StringBuilder();
  BufferedReader stringBuffer=null;
  try {
    stringBuffer=new BufferedReader(new StringReader(text));
    int currentCharValue=stringBuffer.read();
    int currentCharIndex=0;
    boolean isNewLine=true;
    while (currentCharValue != END_OF_STREAM) {
      if (isNewLine) {
        decoratedText.append(OPEN_TABLE_LINE);
        reopenCurrentSyntaxTags(decoratedText);
        isNewLine=false;
      }
      if (currentCharValue == END_OF_LINE) {
        closeCurrentSyntaxTags(decoratedText);
        decoratedText.append(CLOSE_TABLE_LINE);
        isNewLine=true;
      }
 else {
        Collection<SyntaxHighlightingRule> rulesMatchingCurrentIndex=Collections2.filter(highlightingRules,new IndexRuleFilter(currentCharIndex));
        if (rulesMatchingCurrentIndex.size() > 0) {
          injectHtml(currentCharIndex,rulesMatchingCurrentIndex,decoratedText);
        }
      }
      decoratedText.append((char)currentCharValue);
      currentCharValue=stringBuffer.read();
      currentCharIndex++;
    }
  }
 catch (  Exception Ex) {
  }
 finally {
    closeReaderSilently(stringBuffer);
  }
  return decoratedText.toString();
}
