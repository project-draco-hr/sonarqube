{
  for (  Metric metric : metrics.getMetrics()) {
    String metricKey=metric.getKey();
    if (CoreMetrics.getMetrics().contains(metric)) {
      throw new IllegalStateException(String.format("Metric [%s] is already defined by SonarQube",metricKey));
    }
    Metrics anotherRepository=metricsByRepository.get(metricKey);
    if (anotherRepository != null) {
      throw new IllegalStateException(String.format("Metric [%s] is already defined by the repository [%s]",metricKey,anotherRepository));
    }
    metricsByRepository.put(metricKey,metrics);
  }
}
