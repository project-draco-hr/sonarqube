{
  session=dbClient.openSession(false);
  backuper=mock(QProfileBackuper.class);
  db.truncateTables();
  ProfileExporter exporter1=newExporter("polop");
  ProfileExporter exporter2=newExporter("palap");
  ActiveRuleIndex activeRuleIndex=mock(ActiveRuleIndex.class);
  when(activeRuleIndex.findByProfile(Matchers.anyString())).thenReturn(Sets.<ActiveRuleDoc>newHashSet().iterator());
  exporters=new QProfileExporters(dbClient,new QProfileLoader(dbClient,activeRuleIndex,mock(RuleIndex.class)),null,null,new ProfileExporter[]{exporter1,exporter2},null);
  wsTester=new WsTester(new QProfilesWs(mock(RuleActivationActions.class),mock(BulkRuleActivationActions.class),mock(ProjectAssociationActions.class),new ExportAction(dbClient,new QProfileFactory(dbClient),backuper,exporters,LanguageTesting.newLanguages("xoo"))));
}
