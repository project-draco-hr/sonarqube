{
  long maxUpdatedAt=0L;
  bulk.start();
  while (dbRows.hasNext()) {
    SourceFileResultSetIterator.Row row=dbRows.next();
    addDeleteRequestsForLinesGreaterThan(bulk,row);
    for (    UpdateRequest updateRequest : row.getLineUpdateRequests()) {
      bulk.add(updateRequest);
    }
    maxUpdatedAt=Math.max(maxUpdatedAt,row.getUpdatedAt());
  }
  bulk.stop();
  return maxUpdatedAt;
}
