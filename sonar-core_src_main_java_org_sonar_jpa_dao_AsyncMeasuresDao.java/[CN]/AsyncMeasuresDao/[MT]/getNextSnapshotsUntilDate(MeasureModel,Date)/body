{
  Query query=getSession().createQuery("SELECT s FROM Snapshot s " + "WHERE s.resourceId=:projectId " + "AND s.createdAt>=:beginDate " + (date != null ? "AND s.createdAt<:endDate " : "") + "AND s.scope=:scope "+ "ORDER BY s.createdAt ASC ").setParameter("projectId",measure.getProjectId()).setParameter("beginDate",measure.getMeasureDate()).setParameter("scope",ResourceModel.SCOPE_PROJECT);
  if (date != null) {
    query.setParameter("endDate",date);
  }
  return query.getResultList();
}
