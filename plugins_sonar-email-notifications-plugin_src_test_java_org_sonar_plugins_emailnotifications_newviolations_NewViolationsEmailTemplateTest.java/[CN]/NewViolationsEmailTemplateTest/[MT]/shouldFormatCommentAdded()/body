{
  Notification notification=new Notification("new-violations").setFieldValue("count","32").setFieldValue("projectName","Foo").setFieldValue("projectKey","org.sonar.foo:foo").setFieldValue("projectId","45").setFieldValue("fromDate","2012-01-02").setFieldValue("toDate","2012-01-15");
  EmailMessage message=template.format(notification);
  assertThat(message.getMessageId(),is("new-violations/45"));
  assertThat(message.getSubject(),is("New violations for project Foo"));
  assertThat(message.getMessage(),is("" + "Project: Foo\n" + "32 new violations on last analysis (introduced between 2012-01-02 and 2012-01-15)\n"+ "\n"+ "See it in Sonar: http://nemo.sonarsource.org/drilldown/measures/org.sonar.foo:foo?metric=new_violations&period=1\n"));
}
