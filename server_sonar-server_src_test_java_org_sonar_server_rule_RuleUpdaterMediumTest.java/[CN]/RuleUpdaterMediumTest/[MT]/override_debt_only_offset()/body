{
  ruleDao.insert(dbSession,RuleTesting.newDto(RULE_KEY).setDefaultRemediationFunction(DebtRemediationFunction.Type.LINEAR.name()).setDefaultRemediationCoefficient("1d").setDefaultRemediationOffset(null).setRemediationFunction(null).setRemediationCoefficient(null).setRemediationOffset(null));
  dbSession.commit();
  RuleUpdate update=RuleUpdate.createForPluginRule(RULE_KEY).setDebtRemediationFunction(new DefaultDebtRemediationFunction(DebtRemediationFunction.Type.LINEAR,"2d",null));
  underTest.update(update,userSessionRule);
  dbSession.clearCache();
  RuleDto rule=ruleDao.selectOrFailByKey(dbSession,RULE_KEY);
  assertThat(rule.getRemediationFunction()).isEqualTo(DebtRemediationFunction.Type.LINEAR.name());
  assertThat(rule.getRemediationCoefficient()).isEqualTo("2d");
  assertThat(rule.getRemediationOffset()).isNull();
  assertThat(rule.getDefaultRemediationFunction()).isEqualTo(DebtRemediationFunction.Type.LINEAR.name());
  assertThat(rule.getDefaultRemediationCoefficient()).isEqualTo("1d");
  assertThat(rule.getDefaultRemediationOffset()).isNull();
}
