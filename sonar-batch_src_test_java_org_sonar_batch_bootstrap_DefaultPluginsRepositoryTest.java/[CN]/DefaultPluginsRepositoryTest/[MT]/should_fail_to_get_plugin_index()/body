{
  thrown.expect(IllegalStateException.class);
  ServerClient server=mock(ServerClient.class);
  doThrow(new IllegalStateException()).when(server).request("/deploy/plugins/index.txt");
  new DefaultPluginsRepository(mock(FileCache.class),server).pluginList();
}
