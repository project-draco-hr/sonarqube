{
  RuleDto rule=newRule();
  ComponentDto project=newProject();
  ComponentDto file=newFile(project);
  userSessionRule.logon("john").addProjectPermissions(UserRole.USER,project.key());
  try {
    service.createManualIssue(file.key(),rule.getKey(),null,"Fix it",null,2d);
    fail();
  }
 catch (  Exception e) {
    assertThat(e).isInstanceOf(IllegalArgumentException.class).hasMessage("Issues can be created only on rules marked as 'manual': xoo:x1");
  }
}
