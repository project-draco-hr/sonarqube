{
  IssueDto issue=newIssue().setStatus(Issue.STATUS_OPEN);
  tester.get(IssueDao.class).insert(session,issue);
  session.commit();
  index();
  assertThat(db.issueDao().selectByKey(session,issue.getKey())).isNotNull();
  IssueTesting.assertIsEquivalent(issue,(IssueDoc)indexClient.get(IssueIndex.class).getByKey(issue.getKey()));
  assertThat(indexClient.get(IssueIndex.class).getByKey(issue.getKey()).status()).isEqualTo(Issue.STATUS_OPEN);
  service.doTransition(issue.getKey(),DefaultTransitions.CONFIRM);
  assertThat(indexClient.get(IssueIndex.class).getByKey(issue.getKey()).status()).isEqualTo(Issue.STATUS_CONFIRMED);
}
