{
  IssueDto issue=getIssue();
  tester.get(IssueDao.class).insert(session,issue);
  session.commit();
  assertThat(db.issueDao().getByKey(session,issue.getKey())).isNotNull();
  IssueTesting.assertIsEquivalent(issue,indexClient.get(IssueIndex.class).getByKey(issue.getKey()));
  service.doTransition(issue.getKey(),DefaultTransitions.CONFIRM,userSession);
  Issue issueDoc=indexClient.get(IssueIndex.class).getByKey(issue.getKey());
  assertThat(issueDoc.status()).isEqualTo(Issue.STATUS_CONFIRMED);
}
