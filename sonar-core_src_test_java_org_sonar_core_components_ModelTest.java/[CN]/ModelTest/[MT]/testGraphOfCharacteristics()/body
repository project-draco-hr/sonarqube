{
  setupData("testGraphOfCharacteristics");
  Model model=Model.createByName("fake");
  Characteristic level1a=model.createCharacteristicByName("level1a");
  Characteristic level1b=model.createCharacteristicByName("level1b");
  Characteristic level2a=model.createCharacteristicByName("level2a");
  Characteristic level2b=model.createCharacteristicByName("level2b");
  level1a.addChildren(level2a,level2b);
  level1b.addChildren(level2a,level2b);
  getSession().save(model);
  getSession().commit();
  Model persistedModel=getSession().getSingleResult(Model.class,"name","fake");
  assertThat(persistedModel.getCharacteristics().size(),is(4));
  assertThat(persistedModel.getRootCharacteristics().size(),is(2));
  assertThat(persistedModel.getCharacteristicByName("level1a").getChildren().size(),is(2));
  assertThat(persistedModel.getCharacteristicByName("level1b").getChildren().size(),is(2));
  assertThat(persistedModel.getCharacteristicByName("level2a").getParents().size(),is(2));
  assertThat(persistedModel.getCharacteristicByName("level2b").getParents().size(),is(2));
}
