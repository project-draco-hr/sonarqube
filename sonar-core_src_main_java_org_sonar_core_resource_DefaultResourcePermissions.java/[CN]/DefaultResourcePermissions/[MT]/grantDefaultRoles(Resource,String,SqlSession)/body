{
  PermissionTemplateDto applicablePermissionTemplate=getPermissionTemplate(resource.getQualifier());
  List<Long> groupIds=getEligibleGroups(role,applicablePermissionTemplate);
  for (  Long groupId : groupIds) {
    Long resourceId=Long.valueOf(resource.getId());
    permissionFacade.insertGroupPermission(resourceId,groupId,role,session);
  }
  List<Long> userIds=getEligibleUsers(role,applicablePermissionTemplate);
  for (  Long userId : userIds) {
    Long resourceId=Long.valueOf(resource.getId());
    permissionFacade.insertUserPermission(resourceId,userId,role,session);
  }
}
