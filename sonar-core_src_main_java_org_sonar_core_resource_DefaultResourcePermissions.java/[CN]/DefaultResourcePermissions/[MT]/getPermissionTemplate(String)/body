{
  String qualifierTemplateId=settings.getString("sonar.permission.template." + qualifier + ".default");
  if (!StringUtils.isBlank(qualifierTemplateId)) {
    return getTemplateWithPermissions(qualifierTemplateId);
  }
  String defaultTemplateId=settings.getString("sonar.permission.template.default");
  if (StringUtils.isBlank(defaultTemplateId)) {
    throw new IllegalStateException("At least one default permission template should be defined");
  }
  return getTemplateWithPermissions(defaultTemplateId);
}
