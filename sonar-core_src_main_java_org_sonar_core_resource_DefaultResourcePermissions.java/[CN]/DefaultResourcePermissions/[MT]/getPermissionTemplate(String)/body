{
  String qualifierTemplateId=settings.getString("sonar.permission.template." + qualifier + ".default");
  if (!StringUtils.isBlank(qualifierTemplateId)) {
    Long templateId=Long.parseLong(qualifierTemplateId);
    return permissionFacade.getPermissionTemplate(templateId);
  }
  String defaultTemplateId=settings.getString("sonar.permission.template.default");
  if (StringUtils.isBlank(defaultTemplateId)) {
    throw new IllegalStateException("At least one default permission template should be defined");
  }
  Long templateId=Long.parseLong(defaultTemplateId);
  return permissionFacade.getPermissionTemplate(templateId);
}
