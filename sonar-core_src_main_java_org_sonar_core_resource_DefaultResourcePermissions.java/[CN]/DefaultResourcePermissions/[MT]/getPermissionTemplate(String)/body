{
  String qualifierTemplateKey=settings.getString("sonar.permission.template." + qualifier + ".default");
  if (!StringUtils.isBlank(qualifierTemplateKey)) {
    return permissionFacade.getPermissionTemplate(qualifierTemplateKey);
  }
  String defaultTemplateKey=settings.getString("sonar.permission.template.default");
  if (StringUtils.isBlank(defaultTemplateKey)) {
    throw new IllegalStateException("At least one default permission template should be defined");
  }
  return permissionFacade.getPermissionTemplate(defaultTemplateKey);
}
