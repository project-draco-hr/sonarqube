{
  if (resource.getId() != null) {
    SqlSession session=myBatis.openSession();
    try {
      GroupRoleDto groupRole=new GroupRoleDto().setRole(role).setResourceId(Long.valueOf(resource.getId()));
      RoleMapper roleMapper=session.getMapper(RoleMapper.class);
      if (DefaultGroups.isAnyone(groupName)) {
        roleMapper.deleteGroupRole(groupRole);
        roleMapper.insertGroupRole(groupRole);
        session.commit();
      }
 else {
        GroupDto group=session.getMapper(UserMapper.class).selectGroupByName(groupName);
        if (group != null) {
          groupRole.setGroupId(group.getId());
          roleMapper.deleteGroupRole(groupRole);
          roleMapper.insertGroupRole(groupRole);
          session.commit();
        }
      }
    }
  finally {
      MyBatis.closeQuietly(session);
    }
  }
}
