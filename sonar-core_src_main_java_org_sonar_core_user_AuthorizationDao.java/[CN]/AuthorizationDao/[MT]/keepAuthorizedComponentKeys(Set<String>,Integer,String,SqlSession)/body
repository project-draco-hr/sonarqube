{
  if (componentKeys.isEmpty()) {
    return Collections.emptySet();
  }
  String sql;
  Map<String,Object> params;
  if (userId == null) {
    sql="keepAuthorizedComponentKeysForAnonymous";
    params=ImmutableMap.of("role",role,"componentKeys",componentKeys);
  }
 else {
    sql="keepAuthorizedComponentKeysForUser";
    params=ImmutableMap.of("userId",userId,"role",role,"componentKeys",componentKeys);
  }
  return Sets.newHashSet(session.<String>selectList(sql,params));
}
