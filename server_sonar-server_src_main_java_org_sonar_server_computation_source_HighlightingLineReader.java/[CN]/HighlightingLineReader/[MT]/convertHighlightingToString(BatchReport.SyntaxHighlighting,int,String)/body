{
  BatchReport.Range range=syntaxHighlighting.getRange();
  validateStartAndEndOffset(range,line);
  StringBuilder symbolLine=new StringBuilder();
  if (range.getStartLine() == line) {
    validateStartOffsetNotGreaterThanLineLength(range,sourceLine,line);
    symbolLine.append(range.getStartOffset()).append(OFFSET_SEPARATOR);
  }
 else   if (range.getStartLine() < line) {
    symbolLine.append(0).append(OFFSET_SEPARATOR);
  }
  if (range.getEndLine() == line) {
    validateEndOffsetNotGreaterThanLineLength(range,sourceLine,line);
    symbolLine.append(range.getEndOffset()).append(OFFSET_SEPARATOR);
  }
 else   if (range.getEndLine() > line) {
    symbolLine.append(sourceLine.length() - 1).append(OFFSET_SEPARATOR);
  }
  symbolLine.append(getCssClass(syntaxHighlighting.getType()));
  return symbolLine.toString();
}
