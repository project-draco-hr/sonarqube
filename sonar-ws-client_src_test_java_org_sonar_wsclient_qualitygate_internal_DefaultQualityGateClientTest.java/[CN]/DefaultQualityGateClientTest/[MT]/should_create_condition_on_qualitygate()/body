{
  HttpRequestFactory requestFactory=new HttpRequestFactory(httpServer.url());
  httpServer.stubResponseBody("{\"id\":42,\"metric\":\"new_coverage\",\"op\":\"LT\",\"warning\":\"90\",\"error\":\"80\",\"period\":3}");
  QualityGateClient client=new DefaultQualityGateClient(requestFactory);
  QualityGateCondition result=client.createCondition(NewCondition.create(12345L).metricKey("new_coverage").operator("LT").warningThreshold("90").errorThreshold("80").period(3));
  assertThat(httpServer.requestedPath()).isEqualTo("/api/qualitygates/create_condition");
  assertThat(httpServer.requestParams()).includes(entry("gateId","12345"),entry("metric","new_coverage"),entry("op","LT"),entry("warning","90"),entry("error","80"),entry("period","3"));
  assertThat(result).isNotNull();
  assertThat(result.id()).isEqualTo(42L);
}
