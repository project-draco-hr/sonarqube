{
  MockUserSession.set().setGlobalPermissions(GlobalPermissions.QUALITY_PROFILE_ADMIN).setLogin("me");
  RuleDto ruleDto=ruleDao.insert(session,RuleTesting.newDto(RuleKey.of("java","S001")).setName("Rule S001").setDescription("Rule S001 <b>description</b>").setSeverity(Severity.MINOR).setStatus(RuleStatus.BETA).setConfigKey("InternalKeyS001").setLanguage("xoo").setRemediationFunction("LINEAR_OFFSET").setRemediationCoefficient("5d").setRemediationOffset("10h").setTags(newHashSet("tag1","tag2")).setSystemTags(newHashSet("systag1","systag2")));
  RuleParamDto param=RuleParamDto.createFor(ruleDto).setName("regex").setType("STRING").setDescription("Reg ex").setDefaultValue(".*");
  ruleDao.addRuleParam(session,ruleDto,param);
  session.commit();
  session.clearCache();
  WsTester.TestRequest request=wsTester.newGetRequest("api/rules","show").setParam("key",ruleDto.getKey().toString());
  request.execute().assertJson(getClass(),"show_rule.json",false);
}
