{
  String resourceKey;
  if (issue.inputPath() != null) {
    resourceKey=ComponentKeys.createEffectiveKey(def.getKey(),issue.inputPath());
  }
 else {
    resourceKey=def.getKey();
  }
  RuleKey ruleKey=issue.ruleKey();
  DefaultActiveRule activeRule=(DefaultActiveRule)activeRules.find(ruleKey);
  if (activeRule == null) {
    return false;
  }
  if (Strings.isNullOrEmpty(activeRule.name()) && Strings.isNullOrEmpty(issue.message())) {
    throw MessageException.of(String.format("The rule '%s' has no name and the related issue has no message.",ruleKey));
  }
  updateIssue((DefaultIssue)issue,activeRule);
  if (issueFilters.accept(SensorContextAdapter.toDefaultIssue(def.getKey(),resourceKey,issue),null)) {
    issueCache.put(def.getKey(),resourceKey,(DefaultIssue)issue);
    return true;
  }
  return false;
}
