{
  SearchResponse.Builder responseBuilder=SearchResponse.newBuilder();
  writeStatistics(responseBuilder,result,context);
  doContextResponse(request,result,responseBuilder);
  if (context.isFacet()) {
    writeFacets(responseBuilder,request,context,result);
  }
  return responseBuilder.build();
}
