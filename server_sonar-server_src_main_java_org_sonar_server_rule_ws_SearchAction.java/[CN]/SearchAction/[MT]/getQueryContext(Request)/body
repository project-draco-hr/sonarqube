{
  QueryContext context=loadCommonContext(request);
  QueryContext searchQueryContext=mapping.newQueryOptions(SearchOptions.create(request)).setLimit(context.getLimit()).setOffset(context.getOffset()).setScroll(context.isScroll());
  if (context.facets().contains(RuleIndex.FACET_OLD_DEFAULT)) {
    searchQueryContext.addFacets(DEFAULT_FACETS);
  }
 else {
    searchQueryContext.addFacets(context.facets());
  }
  return searchQueryContext;
}
