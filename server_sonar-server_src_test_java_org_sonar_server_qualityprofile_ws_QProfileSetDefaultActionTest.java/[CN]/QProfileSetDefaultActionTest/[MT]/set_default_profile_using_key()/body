{
  MockUserSession.set().setLogin("obiwan").setGlobalPermissions(GlobalPermissions.QUALITY_PROFILE_ADMIN);
  checkDefaultProfile("xoo1","sonar-way-xoo1-12345");
  checkDefaultProfile("xoo2","my-sonar-way-xoo2-34567");
  tester.newPostRequest("api/qualityprofiles","set_default").setParam("profileKey","sonar-way-xoo2-23456").execute().assertNoContent();
  checkDefaultProfile("xoo1","sonar-way-xoo1-12345");
  checkDefaultProfile("xoo2","sonar-way-xoo2-23456");
  assertThat(dbClient.qualityProfileDao().getByKey(session,"sonar-way-xoo2-23456").isDefault()).isTrue();
  assertThat(dbClient.qualityProfileDao().getByKey(session,"my-sonar-way-xoo2-34567").isDefault()).isFalse();
  tester.newPostRequest("api/qualityprofiles","set_default").setParam("profileKey","sonar-way-xoo2-23456").execute().assertNoContent();
  checkDefaultProfile("xoo1","sonar-way-xoo1-12345");
  checkDefaultProfile("xoo2","sonar-way-xoo2-23456");
}
