{
  ComponentContainer container=platform.getContainer();
  ThreadLocalUserSession threadLocalUserSession=container.getComponentByType(ThreadLocalUserSession.class);
  UserSession session=new ServerUserSession(container.getComponentByType(AuthorizationDao.class),container.getComponentByType(ResourceDao.class)).setLogin(login).setName(name).setUserId(userId).setUserGroups(userGroups != null ? userGroups.toArray(new String[userGroups.size()]) : null).setLocale(JRubyI18n.toLocale(localeRubyKey));
  threadLocalUserSession.set(session);
}
