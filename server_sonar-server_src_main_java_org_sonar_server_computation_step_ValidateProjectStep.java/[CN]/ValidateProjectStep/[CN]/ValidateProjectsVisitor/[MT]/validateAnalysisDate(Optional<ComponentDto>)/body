{
  if (baseProject.isPresent()) {
    java.util.Optional<SnapshotDto> snapshotDto=dbClient.snapshotDao().selectLastSnapshotByRootComponentUuid(session,baseProject.get().uuid());
    long currentAnalysisDate=analysisMetadataHolder.getAnalysisDate();
    Long lastAnalysisDate=snapshotDto.isPresent() ? snapshotDto.get().getCreatedAt() : null;
    if (lastAnalysisDate != null && currentAnalysisDate <= lastAnalysisDate) {
      validationMessages.add(format("Date of analysis cannot be older than the date of the last known analysis on this project. Value: \"%s\". " + "Latest analysis: \"%s\". It's only possible to rebuild the past in a chronological order.",formatDateTime(new Date(currentAnalysisDate)),formatDateTime(new Date(lastAnalysisDate))));
    }
  }
}
