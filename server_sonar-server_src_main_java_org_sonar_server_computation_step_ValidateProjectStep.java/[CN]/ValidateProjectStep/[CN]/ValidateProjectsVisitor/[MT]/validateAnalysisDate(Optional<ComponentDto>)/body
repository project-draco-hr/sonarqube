{
  if (baseProject.isPresent()) {
    SnapshotDto snapshotDto=dbClient.snapshotDao().selectLastSnapshotByComponentId(session,baseProject.get().getId());
    long currentAnalysisDate=analysisMetadataHolder.getAnalysisDate().getTime();
    Long lastAnalysisDate=snapshotDto != null ? snapshotDto.getCreatedAt() : null;
    if (lastAnalysisDate != null && currentAnalysisDate <= snapshotDto.getCreatedAt()) {
      validationMessages.add(String.format("Date of analysis cannot be older than the date of the last known analysis on this project. Value: \"%s\". " + "Latest analysis: \"%s\". It's only possible to rebuild the past in a chronological order.",formatDateTime(new Date(currentAnalysisDate)),formatDateTime(new Date(lastAnalysisDate))));
    }
  }
}
