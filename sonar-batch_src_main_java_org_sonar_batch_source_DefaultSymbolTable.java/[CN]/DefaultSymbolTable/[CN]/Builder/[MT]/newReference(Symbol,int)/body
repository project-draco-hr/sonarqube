{
  if (!referencesBySymbol.containsKey(symbol)) {
    throw new UnsupportedOperationException("Cannot add reference to a symbol in another file");
  }
  TextRange referenceRange=inputFile.newRange(fromOffset,fromOffset + ((DefaultSymbol)symbol).getLength());
  if (referenceRange.overlap(((DefaultSymbol)symbol).range())) {
    throw new UnsupportedOperationException("Cannot add reference (" + fromOffset + ") overlapping "+ symbol+ " in "+ inputFile.key());
  }
  referencesBySymbol.get(symbol).add(referenceRange);
}
