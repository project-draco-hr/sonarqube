{
  session.select("selectAllKeysAfterTimestamp",new Timestamp(date.getTime()),new ResultHandler(){
    @Override public void handleResult(    ResultContext context){
      Map<String,Object> fields=(Map<String,Object>)context.getResultObject();
      ActiveRuleKey key=ActiveRuleKey.of(QualityProfileKey.of((String)fields.get("profile"),(String)fields.get("language")),RuleKey.of((String)fields.get("repository"),(String)fields.get("rulefield")));
      session.enqueue(new KeyIndexAction<ActiveRuleKey>(getIndexType(),IndexAction.Method.UPSERT,key));
    }
  }
);
  session.commit();
}
