{
  Map<String,String> allProperties=new HashMap<>();
  allProperties.putAll(parentProperties);
  Map<String,String> currentModuleProperties=new HashMap<>();
  String prefix=!currentModuleId.isEmpty() ? currentModuleId + "." : "";
  for (  Map.Entry<String,String> entry : allProperties.entrySet()) {
    String key=(String)entry.getKey();
    int prefixLength=prefix.length();
    if (key.startsWith(prefix)) {
      currentModuleProperties.put(key.substring(prefixLength),entry.getValue());
      parentProperties.remove(key);
    }
  }
  List<String> moduleIds=new ArrayList<>(Arrays.asList(getListFromProperty(currentModuleProperties,PROPERTY_MODULES)));
  Collections.sort(moduleIds);
  Collections.reverse(moduleIds);
  Map<String,Map<String,String>> result=new HashMap<>();
  for (  String moduleId : moduleIds) {
    result.putAll(extractPropertiesByModule(moduleId,currentModuleProperties));
  }
  result.put(currentModuleId,currentModuleProperties);
  return result;
}
