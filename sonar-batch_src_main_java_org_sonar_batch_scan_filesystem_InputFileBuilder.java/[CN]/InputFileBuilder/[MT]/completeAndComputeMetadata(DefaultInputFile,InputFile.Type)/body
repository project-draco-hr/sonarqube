{
  inputFile.setType(type);
  inputFile.setModuleBaseDir(fs.baseDir().toPath());
  inputFile.setCharset(fs.encoding());
  String lang=langDetection.language(inputFile);
  if (lang == null && !settings.getBoolean(CoreProperties.IMPORT_UNKNOWN_FILES_KEY)) {
    return null;
  }
  inputFile.setLanguage(lang);
  inputFile.initMetadata(fileMetadata.readMetadata(inputFile.file(),fs.encoding()));
  inputFile.setStatus(statusDetection.status(inputFile.moduleKey(),inputFile.relativePath(),inputFile.hash()));
  if (analysisMode.isIncremental() && inputFile.status() == InputFile.Status.SAME) {
    return null;
  }
  return inputFile;
}
