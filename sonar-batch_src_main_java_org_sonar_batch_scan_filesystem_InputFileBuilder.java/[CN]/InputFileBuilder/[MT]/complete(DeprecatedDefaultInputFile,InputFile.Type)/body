{
  inputFile.setType(type);
  inputFile.setBasedir(fs.baseDir());
  inputFile.setEncoding(fs.encoding().name());
  String lang=langDetection.language(inputFile);
  if (lang == null && !settings.getBoolean(CoreProperties.INDEX_ALL_FILES_KEY)) {
    return null;
  }
  inputFile.setLanguage(lang);
  FileMetadata.Metadata metadata=new FileMetadata().read(inputFile.file(),fs.encoding());
  inputFile.setLines(metadata.lines);
  inputFile.setHash(metadata.hash);
  inputFile.setOriginalLineOffsets(metadata.originalLineOffsets);
  inputFile.setLineHashes(metadata.lineHashes);
  inputFile.setEmpty(metadata.empty);
  inputFile.setStatus(statusDetection.status(inputFile.moduleKey(),inputFile.relativePath(),metadata.hash));
  if (analysisMode.isIncremental() && inputFile.status() == InputFile.Status.SAME) {
    return null;
  }
  fillDeprecatedData(inputFile);
  return inputFile;
}
