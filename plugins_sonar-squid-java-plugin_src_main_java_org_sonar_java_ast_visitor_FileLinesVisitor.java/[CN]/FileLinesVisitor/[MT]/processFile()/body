{
  SourceFile file=(SourceFile)peekSourceCode();
  JavaFile javaFile=SquidUtils.convertJavaFileKeyFromSquidFormat(file.getKey());
  FileLinesContext measures=sonarAccessor.getSensorContext().createFileLinesContext(javaFile);
  Source source=getSource();
  for (int line=1; line <= source.getNumberOfLines(); line++) {
    int lineOfCode=source.getMeasure(Metric.LINES_OF_CODE,line,line);
    measures.setIntValue(CoreMetrics.NCLOC_DATA_KEY,line,lineOfCode);
    int comment=source.getMeasure(Metric.COMMENT_LINES,line,line);
    measures.setIntValue(CoreMetrics.COMMENT_LINES_DATA_KEY,line,comment);
  }
  measures.save();
}
