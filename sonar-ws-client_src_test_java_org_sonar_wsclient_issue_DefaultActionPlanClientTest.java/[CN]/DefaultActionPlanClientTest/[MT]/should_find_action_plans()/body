{
  HttpRequestFactory requestFactory=new HttpRequestFactory(httpServer.url());
  httpServer.doReturnBody("{\"actionPlans\": [{\"key\": \"382f6f2e-ad9d-424a-b973-9b065e04348a\",\n" + "\"name\": \"Long term\",\n" + "\"status\": \"CLOSED\",\n"+ "\"project\": \"com.sonarsource.it.samples:simple-sample\",\n"+ "\"userLogin\": \"admin\",\n"+ "\"deadLine\": \"2013-05-30T00:00:00+0200\",\n"+ "\"totalIssues\": 3,\n"+ "\"unresolvedIssues\": 2,\n"+ "\"createdAt\": \"2013-05-13T12:50:29+0200\",\n"+ "\"updatedAt\": \"2013-05-13T12:50:44+0200\"}]}");
  ActionPlanClient client=new DefaultActionPlanClient(requestFactory);
  List<ActionPlan> actionPlans=client.find("com.sonarsource.it.samples:simple-sample");
  assertThat(httpServer.requestedPath()).isEqualTo("/api/action_plans/search?project=com.sonarsource.it.samples:simple-sample");
  assertThat(actionPlans).hasSize(1);
  ActionPlan actionPlan=actionPlans.get(0);
  assertThat(actionPlan.key()).isEqualTo("382f6f2e-ad9d-424a-b973-9b065e04348a");
  assertThat(actionPlan.name()).isEqualTo("Long term");
  assertThat(actionPlan.project()).isEqualTo("com.sonarsource.it.samples:simple-sample");
  assertThat(actionPlan.status()).isEqualTo("CLOSED");
  assertThat(actionPlan.userLogin()).isEqualTo("admin");
  assertThat(actionPlan.deadLine()).isNotNull();
  assertThat(actionPlan.totalIssues()).isEqualTo(3);
  assertThat(actionPlan.unresolvedIssues()).isEqualTo(2);
  assertThat(actionPlan.createdAt()).isNotNull();
  assertThat(actionPlan.updatedAt()).isNotNull();
}
