{
  List<ScannerReport.SyntaxHighlighting> syntaxHighlightingList=new ArrayList<>();
  for (  Map.Entry<TextRange,Constants.HighlightingType> entry : textRangeByType.entrySet()) {
    syntaxHighlightingList.add(ScannerReport.SyntaxHighlighting.newBuilder().setRange(entry.getKey()).setType(entry.getValue()).build());
  }
  return new HighlightingLineReader(FILE,syntaxHighlightingList.iterator(),rangeOffsetConverter);
}
