{
  Resource resource=violationQuery.getResource();
  if (resource == null) {
    throw new IllegalArgumentException("A resource must be set on the ViolationQuery in order to search for violations.");
  }
  Bucket bucket=buckets.get(resource);
  if (bucket == null) {
    return Collections.emptyList();
  }
  List<Violation> filteredViolations=Lists.newArrayList();
  boolean isSwitchedOff=violationQuery.isSwitchedOff();
  for (  Violation violation : bucket.getViolations()) {
    if (violation.isSwitchedOff() == isSwitchedOff) {
      filteredViolations.add(violation);
    }
  }
  return filteredViolations;
}
