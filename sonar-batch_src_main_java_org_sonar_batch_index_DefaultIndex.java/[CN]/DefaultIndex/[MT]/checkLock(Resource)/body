{
  if (lock.isLocked() && !ResourceUtils.isLibrary(resource)) {
    if (lock.isFailWhenLocked()) {
      throw new SonarException("Index is locked, resource can not be indexed: " + resource);
    }
    LOG.warn("Resource will be ignored in next Sonar versions, index is locked: " + resource);
  }
}
