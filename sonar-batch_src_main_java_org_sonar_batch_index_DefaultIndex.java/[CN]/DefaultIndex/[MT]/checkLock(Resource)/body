{
  if (lock.isLocked() && !ResourceUtils.isLibrary(resource)) {
    if (lock.isFailWhenLocked()) {
      throw new SonarException("Index is locked, resource can not be indexed: " + resource);
    }
  }
}
