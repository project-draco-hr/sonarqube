{
  this.name=props.of(NAME_PROPERTY,null);
  this.port=props.intOf(PORT_PROPERTY);
  validateSonarHome(props);
  if (StringUtils.isEmpty(this.name)) {
    throw new IllegalStateException(MISSING_NAME_ARGUMENT);
  }
  MBeanServer mbeanServer=ManagementFactory.getPlatformMBeanServer();
  try {
    mbeanServer.registerMBean(this,this.getObjectName());
  }
 catch (  InstanceAlreadyExistsException e) {
    throw new IllegalStateException("Process already exists in current JVM",e);
  }
catch (  MBeanRegistrationException e) {
    throw new IllegalStateException("Could not register process as MBean",e);
  }
catch (  NotCompliantMBeanException e) {
    throw new IllegalStateException("Process is not a compliant MBean",e);
  }
  shutdownHook=new Thread(new Runnable(){
    @Override public void run(){
      LOGGER.trace("Process[{}]::ShutdownHook::run() START",name);
      Process.this.onTerminate();
      if (Process.this.pingTask != null) {
        Process.this.pingTask.cancel(true);
      }
      Process.this.monitor.shutdownNow();
      LOGGER.trace("Process[{}]::ShutdownHook::run() END",name);
    }
  }
);
  Runtime.getRuntime().addShutdownHook(shutdownHook);
}
