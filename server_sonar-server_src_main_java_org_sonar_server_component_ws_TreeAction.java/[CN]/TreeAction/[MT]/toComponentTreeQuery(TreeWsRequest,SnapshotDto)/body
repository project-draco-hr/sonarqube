{
  List<String> childrenQualifiers=childrenQualifiers(request,baseSnapshot.getQualifier());
  ComponentTreeQuery.Builder query=ComponentTreeQuery.builder().setBaseSnapshot(baseSnapshot).setPage(request.getPage()).setPageSize(request.getPageSize()).setSortFields(request.getSort()).setAsc(request.getAsc());
  if (request.getQuery() != null) {
    query.setNameOrKeyQuery(request.getQuery());
  }
  if (childrenQualifiers != null) {
    query.setQualifiers(childrenQualifiers);
  }
  return query.build();
}
