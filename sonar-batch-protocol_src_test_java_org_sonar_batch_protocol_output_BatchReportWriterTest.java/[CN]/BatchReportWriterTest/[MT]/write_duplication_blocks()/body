{
  assertThat(underTest.hasComponentData(FileStructure.Domain.DUPLICATION_BLOCKS,1)).isFalse();
  BatchReport.DuplicationBlock duplicationBlock=BatchReport.DuplicationBlock.newBuilder().addAllHash(asList(1,2,3,5,7)).setStartLine(1).setEndLine(2).setStartTokenIndex(10).setEndTokenIndex(15).build();
  underTest.writeDuplicationBlocks(1,asList(duplicationBlock));
  assertThat(underTest.hasComponentData(FileStructure.Domain.DUPLICATION_BLOCKS,1)).isTrue();
  File file=underTest.getFileStructure().fileFor(FileStructure.Domain.DUPLICATION_BLOCKS,1);
  assertThat(file).exists().isFile();
  try (CloseableIterator<BatchReport.DuplicationBlock> duplicationBlocks=Protobuf.readStream(file,BatchReport.DuplicationBlock.parser())){
    BatchReport.DuplicationBlock duplicationBlockResult=duplicationBlocks.next();
    assertThat(duplicationBlockResult.getHashList()).containsOnly(1,2,3,5,7);
    assertThat(duplicationBlockResult.getStartLine()).isEqualTo(1);
    assertThat(duplicationBlockResult.getEndLine()).isEqualTo(2);
    assertThat(duplicationBlockResult.getStartTokenIndex()).isEqualTo(10);
    assertThat(duplicationBlockResult.getEndTokenIndex()).isEqualTo(15);
  }
 }
