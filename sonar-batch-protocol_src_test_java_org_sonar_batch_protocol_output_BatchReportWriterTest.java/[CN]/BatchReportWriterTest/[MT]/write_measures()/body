{
  File dir=temp.newFolder();
  BatchReportWriter writer=new BatchReportWriter(dir);
  assertThat(writer.hasComponentData(FileStructure.Domain.MEASURES,1)).isFalse();
  BatchReport.Measure measure=BatchReport.Measure.newBuilder().setStringValue("text-value").setDoubleValue(2.5d).setValueType(Constants.MeasureValueType.DOUBLE).setDescription("description").build();
  writer.writeComponentMeasures(1,Arrays.asList(measure));
  assertThat(writer.hasComponentData(FileStructure.Domain.MEASURES,1)).isTrue();
  File file=writer.getFileStructure().fileFor(FileStructure.Domain.MEASURES,1);
  assertThat(file).exists().isFile();
  BatchReport.Measures measures=ProtobufUtil.readFile(file,BatchReport.Measures.PARSER);
  assertThat(measures.getComponentRef()).isEqualTo(1);
  assertThat(measures.getMeasureCount()).isEqualTo(1);
  assertThat(measures.getMeasure(0).getStringValue()).isEqualTo("text-value");
  assertThat(measures.getMeasure(0).getDoubleValue()).isEqualTo(2.5d);
  assertThat(measures.getMeasure(0).getValueType()).isEqualTo(Constants.MeasureValueType.DOUBLE);
  assertThat(measures.getMeasure(0).getDescription()).isEqualTo("description");
}
