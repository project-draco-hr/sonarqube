{
  IssuesBySeverity newIssues=new IssuesBySeverity();
  IssueChangeContext context=IssueChangeContext.createScan(project.getAnalysisDate());
  Map<DefaultIssue,Rule> changedIssuesRuleMap=new LinkedHashMap<>();
  for (  DefaultIssue issue : issueCache.all()) {
    if (isNew(issue)) {
      newIssues.add(issue);
    }
 else     if (hasChangedAndNeedNotification(issue)) {
      addIssueToMap(issue,changedIssuesRuleMap);
    }
  }
  sendChangedIssues(project,context,changedIssuesRuleMap);
  sendNewIssues(project,newIssues);
}
