{
  if (!SystemUtils.IS_OS_WINDOWS) {
    orchestrator=Orchestrator.builderEnv().setOrchestratorProperty("orchestrator.keepWorkspace","true").build();
    orchestrator.start();
    try {
      newWsClient(orchestrator).system().restart();
      fail();
    }
 catch (    Exception e) {
      assertThat(e.getMessage()).contains("403");
    }
    newAdminWsClient(orchestrator).system().restart();
    WsResponse wsResponse=newAdminWsClient(orchestrator).wsConnector().call(new GetRequest("/api/system/status")).failIfNotSuccessful();
    assertThat(wsResponse.content()).contains("RESTARTING");
    Thread.sleep(5000);
    assertThat(FileUtils.readFileToString(orchestrator.getServer().getLogs())).contains("SonarQube restart requested by admin");
  }
}
