{
  BatchReportWriter writer=initBasicReport(1);
  writer.writeComponentDuplications(FILE_REF,newArrayList(BatchReport.Duplication.newBuilder().setOriginPosition(BatchReport.Range.newBuilder().setStartLine(1).setEndLine(2).build()).addDuplicate(BatchReport.Duplicate.newBuilder().setRange(BatchReport.Range.newBuilder().setStartLine(3).setEndLine(4).build()).build()).build()));
  sut.execute(new ComputationContext(new BatchReportReader(reportDir),ComponentTesting.newProjectDto(PROJECT_UUID)));
  assertThat(dbTester.countRowsOfTable("file_sources")).isEqualTo(1);
  FileSourceDto fileSourceDto=dbClient.fileSourceDao().selectSource(FILE_UUID);
  FileSourceDb.Data data=FileSourceDto.decodeSourceData(fileSourceDto.getBinaryData());
  assertThat(data.getLinesList()).hasSize(1);
  assertThat(data.getLines(0).getDuplicationList()).hasSize(1);
}
