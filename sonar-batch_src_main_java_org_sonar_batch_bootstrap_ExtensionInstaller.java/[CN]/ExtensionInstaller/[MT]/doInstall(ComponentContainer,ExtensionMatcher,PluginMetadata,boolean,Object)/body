{
  if (ExtensionUtils.supportsEnvironment(extension,env) && (!dryRun || ExtensionUtils.supportsDryRun(extension)) && matcher.accept(extension)) {
    container.addExtension(metadata,extension);
  }
 else {
    container.declareExtension(metadata,extension);
  }
}
