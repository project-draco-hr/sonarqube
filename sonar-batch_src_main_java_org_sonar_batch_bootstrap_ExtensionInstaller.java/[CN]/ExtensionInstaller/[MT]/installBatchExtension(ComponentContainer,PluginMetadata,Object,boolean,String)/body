{
  boolean installed;
  if (ExtensionUtils.isBatchExtension(extension) && ExtensionUtils.supportsEnvironment(extension,environment) && (!dryRun || ExtensionUtils.supportsDryRun(extension))&& ExtensionUtils.isInstantiationStrategy(extension,instantiationStrategy)&& !isMavenExtensionOnEmulatedMavenProject(extension,instantiationStrategy,container)) {
    if (plugin != null) {
      LOG.debug("Installing batch extension {} from plugin {}",extension.toString(),plugin.getKey());
    }
 else {
      LOG.debug("Installing batch extension {}",extension.toString());
    }
    container.addExtension(plugin,extension);
    installed=true;
  }
 else {
    container.declareExtension(plugin,extension);
    installed=false;
  }
  return installed;
}
