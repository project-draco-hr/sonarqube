{
  DbSession dbSession=db.openSession(false);
  try {
    QualityProfileDto fromProfile=db.qualityProfileDao().getByKey(dbSession,from);
    if (fromProfile == null) {
      throw new IllegalArgumentException("Quality profile does not exist: " + from);
    }
    QualityProfileDto toProfile=db.qualityProfileDao().getByKey(dbSession,to);
    if (toProfile == null) {
      toProfile=QualityProfileDto.createFor(to).setParent(fromProfile.getParent());
      db.qualityProfileDao().insert(dbSession,toProfile);
    }
    dbSession.commit();
  }
  finally {
    dbSession.close();
  }
}
