{
  List<JpaPlugin> extensions=Lists.newArrayList();
  for (  JpaPlugin pluginMetadata : pluginsMetadata) {
    String pluginKey=pluginMetadata.getKey();
    String basePluginKey=pluginMetadata.getBasePlugin();
    if (StringUtils.isNotEmpty(basePluginKey)) {
      if (classLoaders.get(basePluginKey) != null) {
        LOG.debug("Plugin {} extends {}",pluginKey,basePluginKey);
        List<URL> urls=download(pluginMetadata);
        classLoaders.extend(basePluginKey,pluginKey,urls);
        extensions.add(pluginMetadata);
      }
 else {
        LOG.warn("Plugin {} extends nonexistent plugin {}",pluginKey,basePluginKey);
      }
    }
  }
  return extensions;
}
