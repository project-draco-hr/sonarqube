{
  Snapshot previousLastSnapshot=resourcePersister.getLastSnapshot(snapshot,false);
  boolean isLast=(previousLastSnapshot == null || previousLastSnapshot.getCreatedAt().before(snapshot.getCreatedAt()));
  setFlags(snapshot,isLast,Snapshot.STATUS_PROCESSED);
  logSuccess(LoggerFactory.getLogger(getClass()));
}
