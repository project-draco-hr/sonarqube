{
  Preconditions.checkNotNull(componentKey,"Component key must be set");
  Preconditions.checkNotNull(ruleKey,"Rule key must be set");
  DefaultIssue issue=new DefaultIssue();
  String key=UUID.randomUUID().toString();
  Preconditions.checkState(!Strings.isNullOrEmpty(key),"Fail to generate issue key");
  issue.setKey(key);
  Date now=new Date();
  Date date=Objects.firstNonNull(createdDate,now);
  issue.setCreationDate(date);
  issue.setUpdateDate(date);
  issue.setComponentKey(componentKey);
  issue.setRuleKey(ruleKey);
  issue.setMessage(message);
  issue.setSeverity(Objects.firstNonNull(severity,Severity.MAJOR));
  issue.setEffortToFix(effortToFix);
  issue.setLine(line);
  issue.setManualSeverity(false);
  issue.setReporter(reporter);
  issue.setAttributes(attributes);
  issue.setResolution(null);
  issue.setStatus(Issue.STATUS_OPEN);
  return issue;
}
