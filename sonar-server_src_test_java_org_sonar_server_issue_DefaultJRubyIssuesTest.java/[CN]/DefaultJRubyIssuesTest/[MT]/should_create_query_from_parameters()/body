{
  Map<String,Object> map=newHashMap();
  map.put("keys",newArrayList("ABCDE1234"));
  map.put("severities",newArrayList("MAJOR","MINOR"));
  map.put("statuses",newArrayList("CLOSED"));
  map.put("resolutions",newArrayList("FALSE-POSITIVE"));
  map.put("components",newArrayList("org.apache"));
  map.put("componentRoots",newArrayList("org.sonar"));
  map.put("userLogins",newArrayList("marilyn"));
  map.put("assignees",newArrayList("joanna"));
  map.put("createdAfter","2013-04-16T09:08:24+0200");
  map.put("createdBefore","2013-04-17T09:08:24+0200");
  map.put("rules","squid:AvoidCycle,findbugs:NullReference");
  map.put("pageSize",10l);
  map.put("pageIndex",50);
  IssueQuery query=new DefaultJRubyIssues(finder,changes).toQuery(map);
  assertThat(query.keys()).containsOnly("ABCDE1234");
  assertThat(query.severities()).containsOnly("MAJOR","MINOR");
  assertThat(query.statuses()).containsOnly("CLOSED");
  assertThat(query.resolutions()).containsOnly("FALSE-POSITIVE");
  assertThat(query.components()).containsOnly("org.apache");
  assertThat(query.componentRoots()).containsOnly("org.sonar");
  assertThat(query.userLogins()).containsOnly("marilyn");
  assertThat(query.assignees()).containsOnly("joanna");
  assertThat(query.rules()).hasSize(2);
  assertThat(query.createdAfter()).isEqualTo(DateUtils.parseDateTime("2013-04-16T09:08:24+0200"));
  assertThat(query.createdBefore()).isEqualTo(DateUtils.parseDateTime("2013-04-17T09:08:24+0200"));
  assertThat(query.pageSize()).isEqualTo(10);
  assertThat(query.pageIndex()).isEqualTo(50);
}
