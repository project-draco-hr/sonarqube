{
  setupData("empty");
  RuleDto rule1=new RuleDto().setId(1).setRepositoryKey("foo").setRuleKey("R1").setName("ROne").setCreatedAt(DateUtils.parseDate("2013-12-16")).setUpdatedAt(DateUtils.parseDate("2013-12-16"));
  RuleDto rule2=new RuleDto().setId(2).setRepositoryKey("foo").setRuleKey("R2").setName("RTwo").setCreatedAt(DateUtils.parseDate("2014-01-28")).setUpdatedAt(DateUtils.parseDate("2014-05-19"));
  dao.insert(Arrays.asList(rule1,rule2));
  assertThat(dao.keysOfRowsUpdatedAfter(DateUtils.parseDate("2014-06-01").getTime())).isEmpty();
  assertThat(dao.keysOfRowsUpdatedAfter(DateUtils.parseDate("2012-01-01").getTime())).hasSize(2);
  Iterable<RuleKey> keys=dao.keysOfRowsUpdatedAfter(DateUtils.parseDate("2014-05-17").getTime());
  assertThat(keys).hasSize(1);
  assertThat(Iterables.getFirst(keys,null).rule()).isEqualTo("R2");
}
