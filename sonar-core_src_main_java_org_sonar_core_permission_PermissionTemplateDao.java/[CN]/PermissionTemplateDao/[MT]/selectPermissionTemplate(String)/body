{
  PermissionTemplateDto permissionTemplate=null;
  SqlSession session=myBatis.openSession();
  try {
    PermissionTemplateMapper mapper=session.getMapper(PermissionTemplateMapper.class);
    permissionTemplate=mapper.selectByKey(templateKey);
    PermissionTemplateDto templateUsersPermissions=mapper.selectTemplateUsersPermissions(templateKey);
    if (templateUsersPermissions != null) {
      permissionTemplate.setUsersPermissions(templateUsersPermissions.getUsersPermissions());
    }
    PermissionTemplateDto templateGroupsPermissions=mapper.selectTemplateGroupsPermissions(templateKey);
    if (templateGroupsPermissions != null) {
      permissionTemplate.setGroupsByPermission(templateGroupsPermissions.getGroupsPermissions());
    }
  }
  finally {
    MyBatis.closeQuietly(session);
  }
  return permissionTemplate;
}
