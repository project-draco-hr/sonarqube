{
  validateManualRule(newRule);
  RuleKey customRuleKey=RuleKey.of(RuleDoc.MANUAL_REPOSITORY,newRule.ruleKey());
  Optional<RuleDto> existingRule=loadRule(customRuleKey,dbSession);
  if (existingRule.isPresent()) {
    updateExistingRule(existingRule.get(),newRule,dbSession);
  }
 else {
    createManualRule(customRuleKey,newRule,dbSession);
  }
  dbSession.commit();
  ruleIndexer.setEnabled(true).index();
  return customRuleKey;
}
