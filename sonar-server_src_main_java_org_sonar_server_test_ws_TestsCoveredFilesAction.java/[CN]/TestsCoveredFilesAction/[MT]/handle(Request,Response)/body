{
  String fileKey=request.mandatoryParam(KEY);
  UserSession.get().checkComponentPermission(UserRole.CODEVIEWER,fileKey);
  String test=request.mandatoryParam(TEST);
  MutableTestPlan testPlan=snapshotPerspectives.as(MutableTestPlan.class,fileKey);
  JsonWriter json=response.newJsonWriter().beginObject();
  if (testPlan != null) {
    writeTests(testPlan,test,json);
  }
  json.endObject().close();
}
