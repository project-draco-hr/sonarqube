{
  dbClient=new DbClient(db.database(),db.myBatis(),new CustomMeasureDao(),new ComponentDao(),new MetricDao());
  dbSession=dbClient.openSession(false);
  db.truncateTables();
  system=mock(System2.class);
  CustomMeasureValidator validator=new CustomMeasureValidator(newFullTypeValidations());
  ws=new WsTester(new CustomMeasuresWs(new UpdateAction(dbClient,userSessionRule,system,validator,new CustomMeasureJsonWriter(new UserJsonWriter(userSessionRule)),new UserIndex(es.client()))));
  userSessionRule.login("login").setGlobalPermissions(GlobalPermissions.SYSTEM_ADMIN);
}
