{
  ActiveRuleDto activeRule=new ActiveRuleDto().setId(5).setProfileId(1).setRuleId(10).setSeverity(1);
  ActiveRuleParamDto activeRuleParam=new ActiveRuleParamDto().setId(100).setActiveRuleId(5).setKey("max").setValue("20");
  when(profilesManager.ruleParamChanged(eq(1),eq(5),eq("max"),eq("20"),eq("30"),eq("nicolas"))).thenReturn(new RuleInheritanceActions());
  operations.updateActiveRuleParam(activeRule,activeRuleParam,"30",MockUserSession.create().setName("nicolas").setGlobalPermissions(GlobalPermissions.QUALITY_PROFILE_ADMIN));
  ArgumentCaptor<ActiveRuleParamDto> argumentCaptor=ArgumentCaptor.forClass(ActiveRuleParamDto.class);
  verify(activeRuleDao).update(argumentCaptor.capture(),eq(session));
  assertThat(argumentCaptor.getValue().getId()).isEqualTo(100);
  assertThat(argumentCaptor.getValue().getValue()).isEqualTo("30");
  verify(profilesManager).ruleParamChanged(eq(1),eq(5),eq("max"),eq("20"),eq("30"),eq("nicolas"));
}
