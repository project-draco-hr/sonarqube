{
  RuleDto rule=new RuleDto().setId(10).setNoteCreatedAt(null).setNoteData(null);
  long now=System.currentTimeMillis();
  doReturn(now).when(system).now();
  operations.updateRuleNote(rule,"My note",MockUserSession.create().setLogin("nicolas").setName("Nicolas").setGlobalPermissions(GlobalPermissions.QUALITY_PROFILE_ADMIN));
  ArgumentCaptor<RuleDto> argumentCaptor=ArgumentCaptor.forClass(RuleDto.class);
  verify(ruleDao).update(argumentCaptor.capture());
  assertThat(argumentCaptor.getValue().getNoteData()).isEqualTo("My note");
  assertThat(argumentCaptor.getValue().getNoteUserLogin()).isEqualTo("nicolas");
  assertThat(argumentCaptor.getValue().getNoteCreatedAt().getTime()).isEqualTo(now);
  assertThat(argumentCaptor.getValue().getNoteUpdatedAt().getTime()).isEqualTo(now);
}
