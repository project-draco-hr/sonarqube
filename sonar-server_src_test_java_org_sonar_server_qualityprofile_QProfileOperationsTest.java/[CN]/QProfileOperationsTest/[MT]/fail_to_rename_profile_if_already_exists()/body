{
  try {
    when(dao.selectById(1)).thenReturn(new QualityProfileDto().setId(1).setName("Default").setLanguage("java"));
    when(dao.selectByNameAndLanguage(eq("New Default"),anyString())).thenReturn(new QualityProfileDto().setName("New Default").setLanguage("java"));
    operations.renameProfile(1,"New Default",MockUserSession.create().setGlobalPermissions(GlobalPermissions.QUALITY_PROFILE_ADMIN));
    fail();
  }
 catch (  Exception e) {
    assertThat(e).isInstanceOf(BadRequestException.class);
  }
  verify(session,never()).commit();
}
