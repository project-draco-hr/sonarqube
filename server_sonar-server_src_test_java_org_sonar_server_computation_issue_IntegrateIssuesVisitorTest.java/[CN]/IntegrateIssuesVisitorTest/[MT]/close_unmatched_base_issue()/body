{
  componentsWithUnprocessedIssues.setUuids(newHashSet(FILE_UUID));
  RuleKey ruleKey=RuleTesting.XOO_X1;
  addBaseIssue(ruleKey);
  underTest.visitAny(FILE);
  verify(issueLifecycle).doAutomaticTransition(defaultIssueCaptor.capture());
  assertThat(defaultIssueCaptor.getValue().isBeingClosed()).isTrue();
  List<DefaultIssue> issues=newArrayList(issueCache.traverse());
  assertThat(issues).hasSize(1);
  assertThat(componentsWithUnprocessedIssues.getUuids()).isEmpty();
}
