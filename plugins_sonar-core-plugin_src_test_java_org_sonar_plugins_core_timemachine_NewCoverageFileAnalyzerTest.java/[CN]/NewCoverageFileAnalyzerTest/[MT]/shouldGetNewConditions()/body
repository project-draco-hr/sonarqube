{
  when(context.getMeasure(CoreMetrics.COVERAGE_LINE_HITS_DATA)).thenReturn(new Measure(CoreMetrics.COVERAGE_LINE_HITS_DATA,"10=2;11=3"));
  when(context.getMeasure(CoreMetrics.CONDITIONS_BY_LINE)).thenReturn(new Measure(CoreMetrics.CONDITIONS_BY_LINE,"11=4"));
  when(context.getMeasure(CoreMetrics.COVERED_CONDITIONS_BY_LINE)).thenReturn(new Measure(CoreMetrics.COVERED_CONDITIONS_BY_LINE,"11=1"));
  writer.writeComponentChangesets(BatchReport.Changesets.newBuilder().setComponentRef(1).addChangeset(Changeset.newBuilder().build()).addChangeset(Changeset.newBuilder().setDate(DateUtils.parseDateTime("2007-01-15T00:00:00+0000").getTime()).build()).addChangeset(Changeset.newBuilder().setDate(DateUtils.parseDateTime("2011-01-01T00:00:00+0000").getTime()).build()).addChangesetIndexByLine(0).addChangesetIndexByLine(0).addChangesetIndexByLine(0).addChangesetIndexByLine(0).addChangesetIndexByLine(0).addChangesetIndexByLine(0).addChangesetIndexByLine(0).addChangesetIndexByLine(0).addChangesetIndexByLine(0).addChangesetIndexByLine(1).addChangesetIndexByLine(2).build());
  decorator.doDecorate(context);
  verify(context).saveMeasure(argThat(new VariationMatcher(CoreMetrics.NEW_CONDITIONS_TO_COVER,1,4.0)));
  verify(context).saveMeasure(argThat(new VariationMatcher(CoreMetrics.NEW_UNCOVERED_CONDITIONS,1,3.0)));
  verify(context).saveMeasure(argThat(new VariationMatcher(CoreMetrics.NEW_CONDITIONS_TO_COVER,3,null)));
  verify(context).saveMeasure(argThat(new VariationMatcher(CoreMetrics.NEW_UNCOVERED_CONDITIONS,3,null)));
  verify(context).saveMeasure(argThat(new VariationMatcher(CoreMetrics.NEW_CONDITIONS_TO_COVER,2,null)));
  verify(context).saveMeasure(argThat(new VariationMatcher(CoreMetrics.NEW_CONDITIONS_TO_COVER,4,null)));
  verify(context).saveMeasure(argThat(new VariationMatcher(CoreMetrics.NEW_CONDITIONS_TO_COVER,5,null)));
  verify(context).saveMeasure(argThat(new VariationMatcher(CoreMetrics.NEW_UNCOVERED_CONDITIONS,2,null)));
  verify(context).saveMeasure(argThat(new VariationMatcher(CoreMetrics.NEW_UNCOVERED_CONDITIONS,4,null)));
  verify(context).saveMeasure(argThat(new VariationMatcher(CoreMetrics.NEW_UNCOVERED_CONDITIONS,5,null)));
}
