{
  String htmlSource=codeColorizers.toHtml(source,language);
  List<String> splitSource=newArrayList(Splitter.onPattern("\r?\n|\r").split(htmlSource));
  List<String> result=newArrayList();
  for (int i=0; i < splitSource.size(); i++) {
    int currentLine=i + 1;
    if (to != null && to < currentLine) {
      break;
    }
 else     if (from == null || currentLine >= from) {
      result.add(splitSource.get(currentLine - 1));
    }
  }
  return result;
}
