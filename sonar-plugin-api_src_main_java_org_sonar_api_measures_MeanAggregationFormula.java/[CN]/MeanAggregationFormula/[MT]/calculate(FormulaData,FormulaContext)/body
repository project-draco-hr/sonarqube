{
  double sum=0.0;
  int count=0;
  boolean hasValue=false;
  Collection<Measure> measures=data.getChildrenMeasures(context.getTargetMetric());
  for (  Measure measure : measures) {
    if (MeasureUtils.hasValue(measure)) {
      sum+=measure.getValue();
      count++;
      hasValue=true;
    }
  }
  if (!hasValue && !forceZeroIfMissingData) {
    return null;
  }
  return new Measure(context.getTargetMetric(),count == 0 ? 0.0 : sum / count);
}
