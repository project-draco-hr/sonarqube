{
  Connection connection=database.getDataSource().getConnection();
  Statement stmt=null;
  ResultSet rs=null;
  try {
    connection.setAutoCommit(false);
    stmt=connection.createStatement();
    stmt.setFetchSize(10000);
    rs=stmt.executeQuery(query);
    ConcurrentLinkedQueue<long[]> queue=new ConcurrentLinkedQueue<long[]>();
    totalIssues=0;
    long[] block=new long[GROUP_SIZE];
    int cursor=0;
    while (rs.next()) {
      block[cursor]=rs.getLong(1);
      cursor++;
      totalIssues++;
      if (cursor == GROUP_SIZE) {
        queue.add(block);
        block=new long[GROUP_SIZE];
        cursor=0;
      }
    }
    if (cursor > 0) {
      queue.add(block);
    }
    return queue;
  }
  finally {
    DbUtils.closeQuietly(connection,stmt,rs);
  }
}
