{
  Profiler regularProfiler=startProfiler(task);
  ceLogging.initForTask(task);
  Profiler ceProfiler=startProfiler(task);
  CeActivityDto.Status status=CeActivityDto.Status.FAILED;
  try {
    reportTaskProcessor.process(task);
    status=CeActivityDto.Status.SUCCESS;
    queue.remove(task,status);
  }
 catch (  Throwable e) {
    LOG.error(format("Failed to execute task %s",task.getUuid()),e);
    queue.remove(task,status);
  }
 finally {
    stopProfiler(ceProfiler,task,status);
    ceLogging.clearForTask();
    stopProfiler(regularProfiler,task,status);
  }
}
