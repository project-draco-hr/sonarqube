{
  String templateUuid=getApplicablePermissionTemplateKey(dbSession,projectKey,qualifier);
  PermissionTemplateDto template=dbClient.permissionTemplateDao().selectByUuid(dbSession,templateUuid);
  if (template == null) {
    return false;
  }
  List<String> potentialPermissions=dbClient.permissionTemplateDao().selectPotentialPermissionsByUserIdAndTemplateId(dbSession,currentUserId,template.getId());
  return potentialPermissions.contains(permission);
}
