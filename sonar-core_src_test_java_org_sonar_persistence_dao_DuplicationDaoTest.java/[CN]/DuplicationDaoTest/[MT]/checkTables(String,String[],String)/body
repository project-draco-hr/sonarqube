{
  IDatabaseConnection connection=null;
  try {
    connection=databaseTester.getConnection();
    IDataSet dataSet=connection.createDataSet();
    IDataSet expectedDataSet=getExpectedData(testName);
    for (    String table : tables) {
      ITable filteredTable=DefaultColumnFilter.excludedColumnsTable(dataSet.getTable(table),excludedColumnNames);
      Assertion.assertEquals(expectedDataSet.getTable(table),filteredTable);
    }
  }
 catch (  DataSetException e) {
    throw translateException("Error while checking results",e);
  }
catch (  DatabaseUnitException e) {
    fail(e.getMessage());
  }
catch (  Exception e) {
    throw translateException("Error while checking results",e);
  }
 finally {
    if (connection != null) {
      try {
        connection.close();
      }
 catch (      SQLException e) {
        throw translateException("Error while checking results",e);
      }
    }
  }
}
