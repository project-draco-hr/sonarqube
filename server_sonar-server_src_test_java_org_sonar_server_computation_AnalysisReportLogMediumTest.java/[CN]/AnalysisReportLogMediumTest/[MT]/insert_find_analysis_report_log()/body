{
  AnalysisReportDto report=AnalysisReportDto.newForTests(1L).setProjectKey("projectKey").setProjectName("projectName").setStatus(FAILED);
  report.setCreatedAt(DateUtils.parseDate("2014-10-15")).setUpdatedAt(DateUtils.parseDate("2014-10-16"));
  service.write(dbSession,ANALYSIS_REPORT,new AnalysisReportLog(report));
  dbSession.commit();
  assertThat(index.findAll().getHits()).hasSize(1);
  Activity activity=Iterables.getFirst(index.findAll().getHits(),null);
  assertThat(activity).isNotNull();
  Map<String,String> details=activity.details();
  assertThat(details.get("id")).isEqualTo(String.valueOf(report.getId()));
  assertThat(details.get("projectKey")).isEqualTo(report.getProjectKey());
  assertThat(details.get("projectName")).isEqualTo(report.getProjectName());
  assertThat(details.get("status")).isEqualTo("FAILED");
  assertThat(details.get("createdAt")).isEqualTo("2014-10-15T00:00:00+0200");
  assertThat(details.get("updatedAt")).isEqualTo("2014-10-16T00:00:00+0200");
}
