{
  for (  RulePriority priority : RulePriority.values()) {
    Metric metric=getMetricForSeverity(priority);
    Measure measure=new Measure(metric);
    for (    PastSnapshot pastSnapshot : timeMachineConfiguration.getProjectPastSnapshots()) {
      int variationIndex=pastSnapshot.getIndex();
      int count=countViolations(violationsBySeverity.get(priority),pastSnapshot.getTargetDate());
      Collection<Measure> children=context.getChildrenMeasures(MeasuresFilters.metric(metric));
      double sum=sumChildren(variationIndex,children) + count;
      measure.setVariation(variationIndex,sum);
    }
    context.saveMeasure(measure);
  }
}
