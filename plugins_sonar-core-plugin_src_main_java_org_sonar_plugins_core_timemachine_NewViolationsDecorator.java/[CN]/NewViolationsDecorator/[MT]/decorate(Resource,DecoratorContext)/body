{
  Measure measure=new Measure(CoreMetrics.NEW_VIOLATIONS);
  for (  PastSnapshot variationSnapshot : timeMachineConfiguration.getVariationSnapshots()) {
    Date date=variationSnapshot.getDate();
    double value=countViolationsAfterDate(context.getViolations(),date) + sumChildren(context,variationSnapshot.getIndex());
    measure.setVariation(variationSnapshot.getIndex(),value);
  }
  context.saveMeasure(measure);
}
