{
  if (shouldDecorateResource(resource,context)) {
    prepareCurrentResourceViolations(context);
    saveNewViolations(context);
    saveNewViolationsBySeverity(context);
    saveNewViolationsByRule(context);
    clearCache();
  }
}
