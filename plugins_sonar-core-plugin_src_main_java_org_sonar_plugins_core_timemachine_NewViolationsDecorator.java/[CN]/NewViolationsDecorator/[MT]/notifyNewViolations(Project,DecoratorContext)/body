{
  Integer lastAnalysisPeriodIndex=timeMachineConfiguration.getLastAnalysisPeriodIndex();
  if (lastAnalysisPeriodIndex != null) {
    Double newViolationsCount=context.getMeasure(CoreMetrics.NEW_VIOLATIONS).getVariation(lastAnalysisPeriodIndex);
    if (newViolationsCount != null && newViolationsCount > 0) {
      Notification notification=new Notification("new-violations").setFieldValue("count",String.valueOf(newViolationsCount.intValue())).setFieldValue("projectName",project.getLongName()).setFieldValue("projectKey",project.getKey()).setFieldValue("projectId",String.valueOf(project.getId())).setFieldValue("period",lastAnalysisPeriodIndex.toString());
      notificationManager.scheduleForSending(notification);
    }
  }
}
