{
  I18n i18n=mock(I18n.class);
  when(i18n.message(any(Locale.class),eq("global_permissions.admin"),any(String.class))).thenReturn("admin");
  when(i18n.message(any(Locale.class),eq("global_permissions.admin.desc"),any(String.class))).thenReturn("admin-description");
  when(i18n.message(any(Locale.class),eq("global_permissions.profileadmin"),any(String.class))).thenReturn("profileadmin");
  when(i18n.message(any(Locale.class),eq("global_permissions.profileadmin.desc"),any(String.class))).thenReturn("profileadmine-description");
  when(i18n.message(any(Locale.class),eq("global_permissions.shareDashboard"),any(String.class))).thenReturn("shareDashboard");
  when(i18n.message(any(Locale.class),eq("global_permissions.shareDashboard.desc"),any(String.class))).thenReturn("shareDashboard-description");
  when(i18n.message(any(Locale.class),eq("global_permissions.scan"),any(String.class))).thenReturn("scan");
  when(i18n.message(any(Locale.class),eq("global_permissions.scan.desc"),any(String.class))).thenReturn("scan-description");
  when(i18n.message(any(Locale.class),eq("global_permissions.dryRunScan"),any(String.class))).thenReturn("dryRunScan");
  when(i18n.message(any(Locale.class),eq("global_permissions.dryRunScan.desc"),any(String.class))).thenReturn("dryRunScan-description");
  when(i18n.message(any(Locale.class),eq("global_permissions.provisioning"),any(String.class))).thenReturn("provisioning");
  when(i18n.message(any(Locale.class),eq("global_permissions.provisioning.desc"),any(String.class))).thenReturn("provisioning-description");
  ws=new WsActionTester(new SearchGlobalPermissionsAction(db.getDbClient(),userSession,i18n));
  userSession.login("login").setGlobalPermissions(SYSTEM_ADMIN);
}
