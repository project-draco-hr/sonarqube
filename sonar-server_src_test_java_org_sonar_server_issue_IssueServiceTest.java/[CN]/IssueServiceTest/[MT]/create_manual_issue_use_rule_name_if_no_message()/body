{
  RuleKey ruleKey=RuleKey.of("manual","manualRuleKey");
  DefaultIssue manualIssue=new DefaultIssue().setKey("GHIJ").setRuleKey(RuleKey.of("manual","manualRuleKey")).setComponentKey("org.sonar.Sample").setMessage("");
  when(ruleFinder.findByKey(ruleKey)).thenReturn(Rule.create("manual","manualRuleKey").setName("Manual Rule"));
  when(resourceDao.getResource(any(ResourceQuery.class))).thenReturn(mock(ResourceDto.class));
  Issue result=issueService.createManualIssue(manualIssue,userSession);
  assertThat(result).isNotNull();
  assertThat(result.message()).isEqualTo("Manual Rule");
  assertThat(result.creationDate()).isNotNull();
  assertThat(result.updateDate()).isNotNull();
  verify(issueStorage).save(manualIssue);
  verify(authorizationDao).isAuthorizedComponentKey(anyString(),anyInt(),eq(UserRole.USER));
}
