{
  lock=mock(Lock.class);
  databaseSemaphore=mock(DatabaseSemaphore.class);
  when(databaseSemaphore.acquire(anyString())).thenReturn(lock);
  when(databaseSemaphore.acquire(anyString(),anyInt())).thenReturn(lock);
  projectTree=mock(ProjectTree.class);
  settings=new Settings();
  setDryRunMode(false);
  setForceMode(false);
  project=new Project("key","branch","name");
  when(projectTree.getRootProject()).thenReturn(project);
  checkSemaphore=new CheckSemaphore(databaseSemaphore,projectTree,settings);
}
