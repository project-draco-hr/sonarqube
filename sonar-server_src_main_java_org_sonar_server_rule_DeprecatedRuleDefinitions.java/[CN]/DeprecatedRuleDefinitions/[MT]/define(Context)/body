{
  for (  RuleRepository repository : repositories) {
    NewRepository newRepository;
    if (context.repository(repository.getKey()) == null) {
      newRepository=context.newRepository(repository.getKey(),repository.getLanguage());
      newRepository.setName(repository.getName());
    }
 else {
      newRepository=(NewRepository)context.extendRepository(repository.getKey(),repository.getLanguage());
    }
    for (    org.sonar.api.rules.Rule rule : repository.createRules()) {
      NewRule newRule=newRepository.newRule(rule.getKey());
      newRule.setName(ruleName(repository.getKey(),rule));
      newRule.setHtmlDescription(ruleDescription(repository.getKey(),rule));
      newRule.setMetadata(rule.getConfigKey());
      newRule.setTemplate(Cardinality.MULTIPLE.equals(rule.getCardinality()));
      newRule.setDefaultSeverity(rule.getSeverity().toString());
      for (      RuleParam param : rule.getParams()) {
        NewParam newParam=newRule.newParam(param.getKey());
        newParam.setDefaultValue(param.getDefaultValue());
        newParam.setDescription(paramDescription(repository.getKey(),rule.getKey(),param));
        newParam.setType(paramType(param.getType()));
      }
    }
    newRepository.done();
  }
}
