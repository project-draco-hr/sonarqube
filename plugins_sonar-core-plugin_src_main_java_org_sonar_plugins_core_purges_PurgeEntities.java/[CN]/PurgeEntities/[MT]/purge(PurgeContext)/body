{
  int minimumPeriodInHours=PurgeUtils.getMinimumPeriodInHours(configuration);
  final Date beforeDate=DateUtils.addHours(new Date(),-minimumPeriodInHours);
  Logs.INFO.info("Deleting files data before " + beforeDate);
  Query query=getSession().createQuery("SELECT s.id FROM " + Snapshot.class.getSimpleName() + " s WHERE s.last=false AND scope=:scope AND s.createdAt<:date");
  query.setParameter("scope",Resource.SCOPE_ENTITY);
  query.setParameter("date",beforeDate);
  List<Integer> snapshotIds=selectIds(query);
  deleteSnapshotData(snapshotIds);
}
