{
  final Date beforeDate=DateUtils.addHours(new Date(),MINIMUM_AGE_IN_HOURS);
  Query query=getSession().createQuery("SELECT s.id FROM " + Snapshot.class.getSimpleName() + " s WHERE s.last=false AND scope=:scope AND s.createdAt<:date");
  query.setParameter("scope",Resource.SCOPE_ENTITY);
  query.setParameter("date",beforeDate);
  List<Integer> snapshotIds=query.getResultList();
  deleteSnapshotData(snapshotIds);
}
