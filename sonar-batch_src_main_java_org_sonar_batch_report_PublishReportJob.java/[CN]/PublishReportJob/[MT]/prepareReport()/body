{
  try {
    long startTime=System.currentTimeMillis();
    File reportDir=temp.newDir("batch-report");
    ReportHelper reportHelper=ReportHelper.create(reportDir);
    for (    ReportPublisher publisher : publishers) {
      publisher.export(reportHelper);
    }
    long stopTime=System.currentTimeMillis();
    LOG.debug("Analysis reports generated in " + (stopTime - startTime) + "ms");
    startTime=System.currentTimeMillis();
    File reportZip=temp.newFile("batch-report",".zip");
    ZipUtils.zipDir(reportDir,reportZip);
    FileUtils.deleteDirectory(reportDir);
    stopTime=System.currentTimeMillis();
    LOG.debug("Analysis reports compressed in " + (stopTime - startTime) + "ms, zip size="+ FileUtils.byteCountToDisplaySize(FileUtils.sizeOf(reportZip)));
    return reportZip;
  }
 catch (  IOException e) {
    throw new IllegalStateException("Unable to prepare batch report",e);
  }
}
