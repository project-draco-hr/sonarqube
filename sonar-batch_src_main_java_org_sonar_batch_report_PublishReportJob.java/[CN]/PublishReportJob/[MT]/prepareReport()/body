{
  try {
    File reportDir=temp.newDir("batch-report");
    ReportHelper reportHelper=ReportHelper.create(reportDir);
    for (    ReportPublisher publisher : publishers) {
      publisher.export(reportHelper);
    }
    File reportZip=temp.newFile("batch-report",".zip");
    ZipUtils.zipDir(reportDir,reportZip);
    FileUtils.deleteDirectory(reportDir);
    return reportZip;
  }
 catch (  IOException e) {
    throw new IllegalStateException("Unable to prepare batch report",e);
  }
}
