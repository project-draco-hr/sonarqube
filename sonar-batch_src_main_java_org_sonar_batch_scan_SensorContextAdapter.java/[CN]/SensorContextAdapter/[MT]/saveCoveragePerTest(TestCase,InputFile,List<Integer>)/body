{
  Preconditions.checkArgument(coveredFile.type() == Type.MAIN,"Should be a main file: " + coveredFile);
  File testRes=getTestResource(((DefaultTestCase)testCase).testFile());
  File mainRes=getMainResource(coveredFile);
  Testable testAbleFile=perspectives.as(MutableTestable.class,mainRes);
  if (testAbleFile != null) {
    MutableTestPlan testPlan=perspectives.as(MutableTestPlan.class,testRes);
    if (testPlan != null) {
      for (      MutableTestCase mutableTestCase : testPlan.testCasesByName(testCase.name())) {
        mutableTestCase.setCoverageBlock(testAbleFile,coveredLines);
      }
    }
 else {
      throw new IllegalStateException("Unable to get MutableTestPlan perspective from " + testRes);
    }
  }
 else {
    throw new IllegalStateException("Unable to get MutableTestable perspective from " + mainRes);
  }
}
