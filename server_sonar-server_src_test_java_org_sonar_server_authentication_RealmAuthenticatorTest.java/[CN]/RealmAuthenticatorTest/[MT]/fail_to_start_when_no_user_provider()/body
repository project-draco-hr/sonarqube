{
  when(realm.doGetAuthenticator()).thenReturn(authenticator);
  when(realm.getUsersProvider()).thenReturn(null);
  when(securityRealmFactory.getRealm()).thenReturn(realm);
  expectedException.expect(NullPointerException.class);
  expectedException.expectMessage("No users provider available");
  underTest.start();
}
