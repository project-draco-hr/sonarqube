{
  int max=QueryOptions.DEFAULT_LIMIT + 3;
  final String testValue="hello world";
  for (int i=0; i < max; i++) {
    service.write(dbSession,Activity.Type.QPROFILE,testValue + "_" + i);
  }
  dbSession.commit();
  assertThat(dao.findAll(dbSession)).hasSize(max);
  SearchResponse result=index.search(service.newActivityQuery(),new QueryOptions().setScroll(true));
  assertThat(result.getHits().getTotalHits()).isEqualTo(max);
  Result<Activity> activityResult=new Result<Activity>(index,result);
  assertThat(activityResult.getTotal()).isEqualTo(max);
  assertThat(activityResult.getHits()).hasSize(0);
  int count=0;
  Iterator<Activity> logIterator=activityResult.scroll();
  while (logIterator.hasNext()) {
    count++;
    logIterator.next();
  }
  assertThat(count).isEqualTo(max);
}
