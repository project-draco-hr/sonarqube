{
  BatchPluginRepository pluginRepository=mock(BatchPluginRepository.class);
  Map<String,Plugin> pluginsMap=Maps.newHashMap();
  pluginsMap.put("fooPlugin",new SonarPlugin(){
    public List<Class<? extends Extension>> getExtensions(){
      return ImmutableList.of(BatchService.class,ProjectService.class,ServerService.class);
    }
  }
);
  when(pluginRepository.getPluginsByKey()).thenReturn(pluginsMap);
  Module module=new FakeModule().init();
  ProjectExtensionInstaller installer=new ProjectExtensionInstaller(pluginRepository,new EnvironmentInformation("ant","1.7"),new DryRun(false),new Project("foo"),null);
  installer.install(module);
  assertThat(module.getComponentByType(BatchService.class),nullValue());
  assertThat(module.getComponentByType(ProjectService.class),not(nullValue()));
  assertThat(module.getComponentByType(ServerService.class),nullValue());
}
