{
  new DepthTraversalTypeAwareCrawler(Component.Type.FILE,ComponentVisitor.Order.PRE_ORDER){
    @Override public void visitAny(    Component component){
      checkState(!componentsByRef.containsKey(component.getReportAttributes().getRef()),"Tree contains more than one component with ref " + component.getReportAttributes().getRef());
      componentsByRef.put(component.getReportAttributes().getRef(),component);
    }
  }
.visit(root);
}
