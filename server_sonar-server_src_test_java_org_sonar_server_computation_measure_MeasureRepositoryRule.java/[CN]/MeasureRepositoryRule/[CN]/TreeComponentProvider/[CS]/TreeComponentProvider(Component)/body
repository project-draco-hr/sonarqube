{
  new DepthTraversalTypeAwareCrawler(Component.Type.FILE,ComponentVisitor.Order.PRE_ORDER){
    @Override public void visitAny(    Component component){
      checkState(!componentsByRef.containsKey(component.getRef()),"Tree contains more than one component with ref " + component.getRef());
      componentsByRef.put(component.getRef(),component);
    }
  }
.visit(root);
}
