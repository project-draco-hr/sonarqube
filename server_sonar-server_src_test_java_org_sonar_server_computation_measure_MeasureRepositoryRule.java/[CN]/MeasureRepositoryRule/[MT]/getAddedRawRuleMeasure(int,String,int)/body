{
  checkAndInitProvidersState();
  Set<Measure> measures=from(getAddedRawMeasures(componentProvider.getByRef(componentRef)).get(metricKey)).filter(new MatchRuleId(ruleId)).toSet();
  if (measures.isEmpty()) {
    return Optional.absent();
  }
  checkArgument(measures.size() == 1,String.format("There is more than one measure on metric '%s' for rule '%s' for component '%s'",metricKey,ruleId,componentRef));
  return Optional.of(measures.iterator().next());
}
