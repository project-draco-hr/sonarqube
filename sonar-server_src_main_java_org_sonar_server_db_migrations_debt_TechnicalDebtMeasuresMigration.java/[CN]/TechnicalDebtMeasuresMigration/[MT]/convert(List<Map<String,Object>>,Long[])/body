{
  Connection readConnection=null;
  Connection writeConnection=null;
  try {
    readConnection=db.getDataSource().getConnection();
    writeConnection=db.getDataSource().getConnection();
    writeConnection.setAutoCommit(false);
    List<Object[]> allParams=Lists.newArrayList();
    QueryRunner runner=new QueryRunner();
    for (    Map<String,Object> row : rows) {
      Object[] params=new Object[7];
      params[0]=convertDebtForDays((Double)row.get(VALUE));
      params[1]=convertDebtForDays((Double)row.get(VAR1));
      params[2]=convertDebtForDays((Double)row.get(VAR2));
      params[3]=convertDebtForDays((Double)row.get(VAR3));
      params[4]=convertDebtForDays((Double)row.get(VAR4));
      params[5]=convertDebtForDays((Double)row.get(VAR5));
      params[6]=row.get(ID);
      allParams.add(params);
    }
    runner.batch(writeConnection,SQL_UPDATE,allParams.toArray(new Object[allParams.size()][]));
    writeConnection.commit();
  }
  finally {
    DbUtils.closeQuietly(readConnection);
    DbUtils.closeQuietly(writeConnection);
  }
}
