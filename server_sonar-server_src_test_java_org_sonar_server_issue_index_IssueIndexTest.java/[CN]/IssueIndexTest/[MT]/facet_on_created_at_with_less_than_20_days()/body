{
  SearchOptions options=fixtureForCreatedAtFacet();
  IssueQuery query=IssueQuery.builder(userSessionRule).createdAfter(parseDateTime("2014-09-01T00:00:00+0100")).createdBefore(parseDateTime("2014-09-08T00:00:00+0100")).checkAuthorization(false).build();
  SearchResult<IssueDoc> result=index.search(query,options);
  Map<String,Long> buckets=result.getFacets().get("createdAt");
  assertThat(buckets).containsOnly(entry("2014-08-31T00:00:00+0000",0L),entry("2014-09-01T00:00:00+0000",2L),entry("2014-09-02T00:00:00+0000",1L),entry("2014-09-03T00:00:00+0000",0L),entry("2014-09-04T00:00:00+0000",0L),entry("2014-09-05T00:00:00+0000",1L),entry("2014-09-06T00:00:00+0000",0L),entry("2014-09-07T00:00:00+0000",0L));
}
