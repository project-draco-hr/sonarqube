{
  ComponentDto project=ComponentTesting.newProjectDto().setId(10L).setKey("org.sample.Sample");
  when(componentDao.getAuthorizedComponentByKey("org.sample.Sample",session)).thenReturn(project);
  params=buildPermissionChangeParams("user",null,"org.sample.Sample","codeviewer");
  setUpComponentUserPermissions("user",10L,"codeviewer");
  MockUserSession.set().setLogin("admin").addProjectPermissions(UserRole.ADMIN,"org.sample.Sample");
  service.addPermission(params);
  verify(permissionFacade,never()).insertUserPermission(anyLong(),anyLong(),anyString(),eq(session));
  verifyZeroInteractions(issueAuthorizationDao);
}
