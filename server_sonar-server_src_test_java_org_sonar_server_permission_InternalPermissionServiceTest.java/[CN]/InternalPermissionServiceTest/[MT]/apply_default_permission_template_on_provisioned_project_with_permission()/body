{
  MockUserSession.set().setLogin("provisioning").setGlobalPermissions(GlobalPermissions.PROVISIONING);
  final String componentKey="component";
  final long componentId=1234l;
  final String qualifier=Qualifiers.PROJECT;
  ComponentDto mockComponent=mock(ComponentDto.class);
  when(mockComponent.getId()).thenReturn(componentId);
  when(mockComponent.qualifier()).thenReturn(qualifier);
  when(componentDao.getByKey(session,componentKey)).thenReturn(mockComponent);
  when(resourceDao.selectProvisionedProject(session,componentKey)).thenReturn(mock(ResourceDto.class));
  service.applyDefaultPermissionTemplate(componentKey);
  verify(issueAuthorizationDao).synchronizeAfter(eq(session),any(Date.class));
}
