{
  String value=properties.get(key);
  if (value == null) {
    value=getDefaultValue(key);
  }
 else   if (encryption.isEncrypted(value)) {
    try {
      value=encryption.decrypt(value);
    }
 catch (    Exception e) {
      throw new IllegalStateException("Fail to decrypt the property " + key + ". Please check your secret key.");
    }
  }
  return value;
}
