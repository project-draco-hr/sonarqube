{
  String projectKey=null;
  try {
    projectKey=settings.getString(CoreProperties.PROJECT_KEY_PROPERTY);
    String branch=settings.getString(CoreProperties.PROJECT_BRANCH_PROPERTY);
    if (StringUtils.isNotBlank(branch)) {
      projectKey=String.format("%s:%s",projectKey,branch);
    }
    if (StringUtils.isBlank(projectKey)) {
      server.download("/batch_bootstrap/db",toFile);
    }
 else {
      server.download("/batch_bootstrap/db?project=" + projectKey,toFile);
    }
    LOG.debug("Dry Run database size: {}",FileUtils.byteCountToDisplaySize(FileUtils.sizeOf(toFile)));
  }
 catch (  SonarException e) {
    Throwable rootCause=Throwables.getRootCause(e);
    if (projectKey != null && (rootCause instanceof HttpException) && (((HttpException)rootCause).getResponseCode() == 401)) {
      throw new SonarException(String.format("You don't have access rights to project [%s]",projectKey),e);
    }
    throw e;
  }
}
