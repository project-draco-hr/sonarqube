{
  Map<String,Object> params=newHashMap();
  params.put("date",date);
  params.put("permission",UserRole.USER);
  params.put("anyone",DefaultGroups.ANYONE);
  Map<String,IssueAuthorizationDto> authorizationDtoMap=newHashMap();
  List<Map<String,Object>> rows=session.selectList("org.sonar.core.issue.db.IssueAuthorizationMapper.selectAfterDate",params);
  for (  Map<String,Object> row : rows) {
    String project=(String)row.get("project");
    String user=(String)row.get("permissionUser");
    String group=(String)row.get("permissionGroup");
    Date updatedAt=(Date)row.get("updatedAt");
    IssueAuthorizationDto issueAuthorizationDto=authorizationDtoMap.get(project);
    if (issueAuthorizationDto == null) {
      issueAuthorizationDto=new IssueAuthorizationDto().setProject(project).setPermission(UserRole.USER);
      issueAuthorizationDto.setUpdatedAt(updatedAt);
    }
    if (group != null) {
      issueAuthorizationDto.addGroup(group);
    }
    if (user != null) {
      issueAuthorizationDto.addUser(user);
    }
    authorizationDtoMap.put(project,issueAuthorizationDto);
  }
  return ImmutableList.<IssueAuthorizationDto>copyOf(authorizationDtoMap.values());
}
