{
  LOGGER.info("Persist file sources");
  DbClient dbClient=dbTester.getDbClient();
  long start=System.currentTimeMillis();
  BatchReportDirectoryHolderImpl batchReportDirectoryHolder=new BatchReportDirectoryHolderImpl();
  batchReportDirectoryHolder.setDirectory(reportDir);
  org.sonar.server.computation.batch.BatchReportReader batchReportReader=new BatchReportReaderImpl(batchReportDirectoryHolder);
  PersistFileSourcesStep step=new PersistFileSourcesStep(dbClient,System2.INSTANCE,treeRootHolder,batchReportReader,new SourceLinesRepositoryImpl(batchReportReader));
  step.execute();
  long end=System.currentTimeMillis();
  long duration=end - start;
  assertThat(dbTester.countRowsOfTable("file_sources")).isEqualTo(NUMBER_OF_FILES);
  LOGGER.info(String.format("File sources has been persisted in %d ms",duration));
  benchmark.expectAround("Duration to persist FILE_SOURCES",duration,125000,Benchmark.DEFAULT_ERROR_MARGIN_PERCENTS);
}
