{
  if (!"issue-changes".equals(notif.getType())) {
    return null;
  }
  String issueKey=notif.getFieldValue("key");
  String author=notif.getFieldValue("changeAuthor");
  StringBuilder sb=new StringBuilder();
  String projectName=notif.getFieldValue("projectName");
  appendField(sb,"Project",null,projectName);
  appendField(sb,"Component",null,StringUtils.defaultString(notif.getFieldValue("componentName"),notif.getFieldValue("componentKey")));
  appendField(sb,"Rule",null,notif.getFieldValue("ruleName"));
  appendField(sb,"Message",null,notif.getFieldValue("message"));
  appendField(sb,"Comment",null,notif.getFieldValue("comment"));
  sb.append('\n');
  appendField(sb,"Assignee",notif.getFieldValue("old.assignee"),notif.getFieldValue("new.assignee"));
  appendField(sb,"Severity",notif.getFieldValue("old.severity"),notif.getFieldValue("new.severity"));
  appendField(sb,"Resolution",notif.getFieldValue("old.resolution"),notif.getFieldValue("new.resolution"));
  appendField(sb,"Status",notif.getFieldValue("old.status"),notif.getFieldValue("new.status"));
  appendField(sb,"Message",notif.getFieldValue("old.message"),notif.getFieldValue("new.message"));
  appendFooter(sb,notif);
  EmailMessage message=new EmailMessage().setMessageId("issue-changes/" + issueKey).setSubject("Project " + projectName + ", change on issue #"+ issueKey).setMessage(sb.toString());
  if (author != null) {
    message.setFrom(getUserFullName(author));
  }
  return message;
}
