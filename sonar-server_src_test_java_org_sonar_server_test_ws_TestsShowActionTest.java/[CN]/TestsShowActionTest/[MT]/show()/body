{
  MockUserSession.set().addComponentPermission(UserRole.CODEVIEWER,"SonarQube",TEST_PLAN_KEY);
  MutableTestCase testCase1=testCase("test1",TestCase.Status.OK,10L,32);
  MutableTestCase testCase2=testCase("test2",TestCase.Status.ERROR,97L,21);
  when(testPlan.testCases()).thenReturn(newArrayList(testCase1,testCase2));
  WsTester.TestRequest request=tester.newGetRequest("api/tests","show").setParam("key",TEST_PLAN_KEY);
  request.execute().assertJson("{\n" + "  \"tests\": [\n" + "    {\n"+ "      \"name\": \"test1\",\n"+ "      \"status\": \"OK\",\n"+ "      \"durationInMs\": 10,\n"+ "      \"coveredLines\": 32\n"+ "    },\n"+ "    {\n"+ "      \"name\": \"test2\",\n"+ "      \"status\": \"ERROR\",\n"+ "      \"durationInMs\": 97,\n"+ "      \"coveredLines\": 21\n"+ "    }\n"+ "  ],\n"+ "}\n");
}
