{
  File file=new File("test-resources/org/sonar/duplications/cpd/CPDTest/CPDFile3.java");
  addToIndex(file);
  List<CloneGroup> duplications=detect(file);
  assertThat(duplications.size(),is(1));
  CloneGroup duplication=duplications.get(0);
  assertThat(duplication.getOriginPart().getResourceId(),is(file.getAbsolutePath()));
  assertThat(duplication.getCloneParts().size(),is(2));
  assertThat("length in tokens",duplication.getLengthInUnits(),is(157));
  ClonePart part=duplication.getCloneParts().get(0);
  assertThat(part.getResourceId(),is(file.getAbsolutePath()));
  assertThat(part.getStartLine(),is(30));
  assertThat(part.getEndLine(),is(44));
}
