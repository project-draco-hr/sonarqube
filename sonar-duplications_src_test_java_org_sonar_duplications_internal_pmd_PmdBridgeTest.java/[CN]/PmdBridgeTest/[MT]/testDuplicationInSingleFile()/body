{
  File file=new File("test-resources/org/sonar/duplications/cpd/CPDTest/CPDFile3.java");
  addToIndex(file);
  List<CloneGroup> duplications=detect(file);
  assertThat(duplications.size()).isEqualTo(1);
  CloneGroup duplication=duplications.get(0);
  assertThat(duplication.getOriginPart().getResourceId()).isEqualTo(file.getAbsolutePath());
  assertThat(duplication.getCloneParts().size()).isEqualTo(2);
  assertThat(duplication.getLengthInUnits()).as("length in tokens").isEqualTo(157);
  ClonePart part=duplication.getCloneParts().get(0);
  assertThat(part.getResourceId()).isEqualTo(file.getAbsolutePath());
  assertThat(part.getStartLine()).isEqualTo(30);
  assertThat(part.getEndLine()).isEqualTo(44);
}
