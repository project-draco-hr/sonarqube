{
  Metric m=new Metric("foo",Metric.ValueType.DATA);
  when(context.getTargetMetric()).thenReturn(m);
  List<Measure> list=Lists.newArrayList(new Measure(m,"1=0;2=2;5=0;10=10;20=2"),new Measure(m,"1=3;2=2;5=3;10=12;20=0"));
  when(data.getChildrenMeasures(new Metric("foo"))).thenReturn(list);
  assertThat(formula.calculate(data,context).getData(),is("1=3;2=4;5=3;10=22;20=2"));
}
