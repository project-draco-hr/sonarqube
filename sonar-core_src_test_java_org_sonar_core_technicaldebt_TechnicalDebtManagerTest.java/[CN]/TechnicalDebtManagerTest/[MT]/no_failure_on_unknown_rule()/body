{
  setupData("empty");
  addPluginModel("java","fake-java-model.xml");
  TechnicalDebtRuleCache technicalDebtRuleCache=mock(TechnicalDebtRuleCache.class);
  Rule rule1=Rule.create("checkstyle","import","Regular expression");
  rule1.setId(1);
  when(technicalDebtRuleCache.getRule("checkstyle","import")).thenReturn(rule1);
  Rule rule2=Rule.create("checkstyle","export","Regular expression");
  rule2.setId(2);
  when(technicalDebtRuleCache.getRule("checkstyle","export")).thenReturn(rule2);
  ValidationMessages messages=ValidationMessages.create();
  manager.initAndMergePlugins(messages,technicalDebtRuleCache);
  getSession().commit();
  assertThat(messages.getWarnings()).hasSize(1);
  assertThat(messages.getWarnings().get(0)).isEqualTo("Rule not found: [repository=checkstyle, key=ConstantNameCheck]");
}
