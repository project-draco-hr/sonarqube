{
  try {
    JsonWriter json=JsonWriter.of(writer);
    json.beginObject();
    json.prop("version",server.getVersion());
    Set<RuleKey> ruleKeys=new LinkedHashSet<>();
    Set<String> userLogins=new LinkedHashSet<>();
    writeJsonIssues(json,ruleKeys,userLogins);
    writeJsonComponents(json);
    writeJsonRules(json,ruleKeys);
    writeUsers(json,userLogins);
    json.endObject().close();
  }
 catch (  IOException e) {
    throw new IllegalStateException("Unable to write JSON report",e);
  }
}
