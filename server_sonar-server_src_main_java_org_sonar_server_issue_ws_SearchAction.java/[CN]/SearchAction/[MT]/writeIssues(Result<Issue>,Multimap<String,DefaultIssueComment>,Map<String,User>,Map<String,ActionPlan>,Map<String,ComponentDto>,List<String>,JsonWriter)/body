{
  json.name("issues").beginArray();
  for (  Issue issue : result.getHits()) {
    json.beginObject();
    String actionPlanKey=issue.actionPlanKey();
    ComponentDto componentDto=componentsByKey.get(issue.componentKey());
    Duration debt=issue.debt();
    Date updateDate=issue.updateDate();
    json.prop("key",issue.key()).prop("component",issue.componentKey()).prop("componentId",componentDto != null ? componentDto.getId() : null).prop("project",issue.projectKey()).prop("rule",issue.ruleKey().toString()).prop("status",issue.status()).prop("resolution",issue.resolution()).prop("severity",issue.severity()).prop("message",issue.message()).prop("line",issue.line()).prop("debt",debt != null ? durations.encode(debt) : null).prop("reporter",issue.reporter()).prop("assignee",issue.assignee()).prop("author",issue.authorLogin()).prop("actionPlan",actionPlanKey).prop("creationDate",isoDate(issue.creationDate())).prop("updateDate",isoDate(updateDate)).prop("fUpdateAge",formatAgeDate(updateDate)).prop("closeDate",isoDate(issue.closeDate()));
    if (issue.line() != null) {
      writeIssueSnippet(issue,json);
    }
    writeIssueComments(commentsByIssues.get(issue.key()),usersByLogin,json);
    writeIssueAttributes(issue,json);
    writeIssueExtraFields(issue,usersByLogin,actionPlanByKeys,extraFields,json);
    json.endObject();
  }
  json.endArray();
}
