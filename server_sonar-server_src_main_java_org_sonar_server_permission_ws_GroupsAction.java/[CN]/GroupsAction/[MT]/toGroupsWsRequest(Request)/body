{
  String permission=request.mandatoryParam(PARAM_PERMISSION);
  String projectUuid=request.param(PARAM_PROJECT_ID);
  String projectKey=request.param(PARAM_PROJECT_KEY);
  if (newOptionalWsProjectRef(projectUuid,projectKey).isPresent()) {
    validateProjectPermission(permission);
  }
 else {
    validateGlobalPermission(permission);
  }
  return new GroupsWsRequest().setPermission(permission).setProjectId(projectUuid).setProjectKey(projectKey).setPage(request.mandatoryParamAsInt(Param.PAGE)).setPageSize(request.mandatoryParamAsInt(Param.PAGE_SIZE)).setQuery(request.param(Param.TEXT_QUERY)).setSelected(request.mandatoryParam(Param.SELECTED));
}
