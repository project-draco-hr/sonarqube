{
  String planKey="ABCD";
  Map<String,Object> properties=newHashMap();
  properties.put("plan",planKey);
  DefaultIssue issue=mock(DefaultIssue.class);
  Action.Context context=mock(Action.Context.class);
  when(context.issue()).thenReturn(issue);
  ActionPlan actionPlan=new DefaultActionPlan();
  when(actionPlanService.findByKey(eq(planKey),any(UserSession.class))).thenReturn(actionPlan);
  action.execute(properties,context);
  verify(issueUpdater).plan(eq(issue),eq(actionPlan),any(IssueChangeContext.class));
}
