{
  List<String> result=Lists.newArrayList();
  final int scrollTime=100;
  SearchRequestBuilder builder=searchQuery.toBuilder(client);
  LOG.debug("findDocumentIds" + builder.internalBuilder().toString());
  TimeProfiler profiler=newDebugProfiler();
  profiler.start("findDocumentIds");
  SearchResponse scrollResp=builder.addField("_id").setSearchType(SearchType.SCAN).setScroll(new TimeValue(scrollTime)).setSize(searchQuery.scrollSize()).execute().actionGet();
  while (true) {
    scrollResp=client.prepareSearchScroll(scrollResp.getScrollId()).setScroll(new TimeValue(scrollTime)).execute().actionGet();
    for (    SearchHit hit : scrollResp.getHits()) {
      result.add(hit.getId());
    }
    if (scrollResp.getHits().getHits().length == 0) {
      break;
    }
  }
  profiler.stop();
  return result;
}
