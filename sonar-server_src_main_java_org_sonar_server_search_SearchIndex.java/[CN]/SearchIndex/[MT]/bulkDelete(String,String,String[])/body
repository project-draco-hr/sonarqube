{
  BulkRequestBuilder builder=new BulkRequestBuilder(client);
  for (int i=0; i < ids.length; i++) {
    builder.add(client.prepareDelete(index,type,ids[i]));
  }
  StopWatch watch=createWatch();
  try {
    BulkResponse bulkResponse=client.bulk(builder.setRefresh(true).request()).get();
    if (bulkResponse.hasFailures()) {
      for (      BulkItemResponse bulkItemResponse : bulkResponse.getItems()) {
        if (bulkItemResponse.isFailed()) {
          int itemId=bulkItemResponse.getItemId();
          client.prepareDelete(index,type,ids[itemId]).execute().actionGet();
        }
      }
    }
  }
 catch (  InterruptedException e) {
    LOG.error(BULK_INTERRUPTED,e);
  }
catch (  ExecutionException e) {
    LOG.error(BULK_EXECUTE_FAILED,e);
  }
 finally {
    watch.stop("bulk delete of %d documents with type '%s' from index '%s'",ids.length,type,index);
  }
}
