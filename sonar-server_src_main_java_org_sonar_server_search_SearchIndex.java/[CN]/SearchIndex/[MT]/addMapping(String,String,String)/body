{
  IndicesAdminClient indices=client.admin().indices();
  try {
    if (!indices.exists(new IndicesExistsRequest(index)).get().isExists()) {
      indices.prepareCreate(index).get();
    }
  }
 catch (  Exception e) {
    LOG.error("While checking for index existence",e);
  }
  indices.preparePutMapping(index).setType(type).setSource(mapping).execute();
}
