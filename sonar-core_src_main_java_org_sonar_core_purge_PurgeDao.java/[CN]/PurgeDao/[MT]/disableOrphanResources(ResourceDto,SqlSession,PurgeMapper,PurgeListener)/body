{
  final List<IdUuidPair> componentIdUuids=new ArrayList<IdUuidPair>();
  session.select("org.sonar.core.purge.PurgeMapper.selectComponentIdUuidsToDisable",project.getId(),new ResultHandler(){
    @Override public void handleResult(    ResultContext resultContext){
      IdUuidPair componentIdUuid=(IdUuidPair)resultContext.getResultObject();
      if (componentIdUuid.getId() != null) {
        componentIdUuids.add(componentIdUuid);
      }
    }
  }
);
  for (  IdUuidPair componentIdUuid : componentIdUuids) {
    disableResource(componentIdUuid,purgeMapper);
    purgeListener.onComponentDisabling(componentIdUuid.getUuid());
  }
  session.commit();
}
