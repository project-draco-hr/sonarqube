{
  PurgeMapper mapper=session.getMapper(PurgeMapper.class);
  List<PurgeableSnapshotDto> result=Lists.newArrayList();
  result.addAll(mapper.selectPurgeableSnapshotsWithEvents(resourceId));
  result.addAll(mapper.selectPurgeableSnapshotsWithoutEvents(resourceId));
  Collections.sort(result);
  return result;
}
