{
  when(context.newMeasure()).then(new Answer<Measure>(){
    @Override public Measure answer(    InvocationOnMock invocation) throws Throwable {
      return new DefaultMeasure(storage);
    }
  }
);
  inputFile=new DeprecatedDefaultInputFile("foo","src/main/java/Foo.java");
  duplicationBuilder=spy(new DefaultDuplicationBuilder(inputFile));
  when(context.duplicationBuilder(any(InputFile.class))).thenReturn(duplicationBuilder);
  inputFile.setFile(temp.newFile("Foo.java"));
}
