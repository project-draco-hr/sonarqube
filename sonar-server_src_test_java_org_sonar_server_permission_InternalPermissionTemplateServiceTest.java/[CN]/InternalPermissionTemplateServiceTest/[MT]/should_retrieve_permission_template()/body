{
  List<PermissionTemplateUserDto> usersPermissions=Lists.newArrayList(buildUserPermission("user_scan",Permission.SCAN_EXECUTION.key()),buildUserPermission("user_dry_run",Permission.DRY_RUN_EXECUTION.key()),buildUserPermission("user_scan_and_dry_run",Permission.SCAN_EXECUTION.key()),buildUserPermission("user_scan_and_dry_run",Permission.DRY_RUN_EXECUTION.key()));
  List<PermissionTemplateGroupDto> groupsPermissions=Lists.newArrayList(buildGroupPermission("admin_group",Permission.SYSTEM_ADMIN.key()),buildGroupPermission("scan_group",Permission.SCAN_EXECUTION.key()),buildGroupPermission(null,Permission.DRY_RUN_EXECUTION.key()));
  PermissionTemplateDto permissionTemplateDto=new PermissionTemplateDto().setId(1L).setName("my template").setDescription("my description").setUsersPermissions(usersPermissions).setGroupsByPermission(groupsPermissions);
  when(permissionDao.selectPermissionTemplate("my template")).thenReturn(permissionTemplateDto);
  PermissionTemplate permissionTemplate=permissionTemplateService.selectPermissionTemplate("my template");
  assertThat(permissionTemplate.getUsersForPermission(Permission.DASHBOARD_SHARING.key())).isEmpty();
  assertThat(permissionTemplate.getUsersForPermission(Permission.SCAN_EXECUTION.key())).onProperty("userName").containsOnly("user_scan","user_scan_and_dry_run");
  assertThat(permissionTemplate.getUsersForPermission(Permission.DRY_RUN_EXECUTION.key())).onProperty("userName").containsOnly("user_dry_run","user_scan_and_dry_run");
  assertThat(permissionTemplate.getGroupsForPermission(Permission.DASHBOARD_SHARING.key())).isEmpty();
  assertThat(permissionTemplate.getGroupsForPermission(Permission.SCAN_EXECUTION.key())).onProperty("groupName").containsOnly("scan_group");
  assertThat(permissionTemplate.getGroupsForPermission(Permission.SYSTEM_ADMIN.key())).onProperty("groupName").containsOnly("admin_group");
}
