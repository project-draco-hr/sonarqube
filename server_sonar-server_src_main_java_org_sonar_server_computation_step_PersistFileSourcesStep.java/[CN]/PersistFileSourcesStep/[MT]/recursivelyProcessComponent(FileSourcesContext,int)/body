{
  BatchReportReader reportReader=fileSourcesContext.context.getReportReader();
  BatchReport.Component component=reportReader.readComponent(componentRef);
  if (component.getType().equals(Constants.ComponentType.FILE)) {
    LineIterator linesIterator=sourceLinesIterator(reportReader.readFileSource(componentRef));
    LineReaders lineReaders=new LineReaders(reportReader,componentRef);
    try {
      ComputeFileSourceData computeFileSourceData=new ComputeFileSourceData(linesIterator,lineReaders.readers(),component.getLines());
      ComputeFileSourceData.Data fileSourceData=computeFileSourceData.compute();
      persistSource(fileSourcesContext,fileSourceData,component);
    }
 catch (    Exception e) {
      throw new IllegalStateException(String.format("Cannot persist sources of %s",component.getPath()),e);
    }
 finally {
      linesIterator.close();
      lineReaders.close();
    }
  }
  for (  Integer childRef : component.getChildRefList()) {
    recursivelyProcessComponent(fileSourcesContext,childRef);
  }
}
