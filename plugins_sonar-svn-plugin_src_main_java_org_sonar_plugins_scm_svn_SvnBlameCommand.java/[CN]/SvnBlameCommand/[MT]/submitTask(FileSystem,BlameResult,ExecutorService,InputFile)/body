{
  return executorService.submit(new Callable<Void>(){
    public Void call(){
      String filename=inputFile.relativePath();
      Command cl=createCommandLine(fs.baseDir(),filename);
      SvnBlameConsumer consumer=new SvnBlameConsumer(filename);
      StringStreamConsumer stderr=new StringStreamConsumer();
      int exitCode=execute(cl,consumer,stderr);
      if (exitCode != 0) {
        throw new IllegalStateException("The svn blame command [" + cl.toString() + "] failed: "+ stderr.getOutput());
      }
      result.add(inputFile,consumer.getLines());
      return null;
    }
  }
);
}
