{
  if (startTime == 0L) {
    throw new IllegalStateException("Profiler must be started before being stopped");
  }
  long duration=System2.INSTANCE.now() - startTime;
  if (shouldLog(logger,level)) {
    StringBuilder sb=new StringBuilder();
    if (!StringUtils.isEmpty(message)) {
      sb.append(message);
      sb.append(messageSuffix);
    }
    if (logTimeLast) {
      appendContext(sb);
      appendTime(sb,duration);
    }
 else {
      appendTime(sb,duration);
      appendContext(sb);
    }
    log(level,sb.toString(),args);
  }
  reset();
  return duration;
}
