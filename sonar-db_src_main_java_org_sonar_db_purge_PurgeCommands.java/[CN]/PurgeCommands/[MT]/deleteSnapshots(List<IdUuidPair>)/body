{
  List<List<Long>> snapshotIdsPartition=Lists.partition(IdUuidPairs.ids(snapshotIds),MAX_SNAPSHOTS_PER_QUERY);
  List<List<String>> snapshotUuidsPartition=Lists.partition(IdUuidPairs.uuids(snapshotIds),MAX_SNAPSHOTS_PER_QUERY);
  deleteSnapshotDuplications(snapshotUuidsPartition);
  profiler.start("deleteSnapshotEvents (events)");
  for (  List<String> partSnapshotUuids : snapshotUuidsPartition) {
    purgeMapper.deleteSnapshotEvents(partSnapshotUuids);
  }
  session.commit();
  profiler.stop();
  profiler.start("deleteSnapshotMeasures (project_measures)");
  for (  List<Long> partSnapshotIds : snapshotIdsPartition) {
    purgeMapper.deleteSnapshotMeasures(partSnapshotIds);
  }
  session.commit();
  profiler.stop();
  profiler.start("deleteSnapshot (snapshots)");
  for (  List<Long> partSnapshotIds : snapshotIdsPartition) {
    purgeMapper.deleteSnapshot(partSnapshotIds);
  }
  session.commit();
  profiler.stop();
}
