{
  List<List<Long>> snapshotIdsPartitions=Lists.partition(IdUuidPairs.ids(analysisIdUuids),MAX_SNAPSHOTS_PER_QUERY);
  List<List<String>> snapshotUuidsPartitions=Lists.partition(IdUuidPairs.uuids(analysisIdUuids),MAX_SNAPSHOTS_PER_QUERY);
  deleteSnapshotDuplications(snapshotUuidsPartitions);
  profiler.start("deleteAnalyses (events)");
  for (  List<String> snapshotUuidsPartition : snapshotUuidsPartitions) {
    purgeMapper.deleteSnapshotEvents(snapshotUuidsPartition);
  }
  session.commit();
  profiler.stop();
  profiler.start("deleteAnalyses (project_measures)");
  for (  List<Long> snapshotIdsPartition : snapshotIdsPartitions) {
    purgeMapper.deleteSnapshotMeasures(snapshotIdsPartition);
  }
  session.commit();
  profiler.stop();
  profiler.start("deleteAnalyses (snapshots)");
  for (  List<String> snapshotUuidsPartition : snapshotUuidsPartitions) {
    purgeMapper.deleteAnalyses(snapshotUuidsPartition);
  }
  for (  List<Long> snapshotIdsPartition : snapshotIdsPartitions) {
    purgeMapper.deleteDescendantSnapshots(snapshotIdsPartition);
  }
  session.commit();
  profiler.stop();
}
