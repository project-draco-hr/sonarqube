{
  RuleKey ruleKey=RuleKey.of("javascript","S001");
  dao.insert(newRuleDto(ruleKey));
  RuleDto persistedDto=dao.selectByKey(ruleKey);
  assertThat(persistedDto).isNotNull();
  assertThat(persistedDto.getId()).isGreaterThanOrEqualTo(0);
  assertThat(persistedDto.getRuleKey()).isEqualTo(ruleKey.rule());
  assertThat(persistedDto.getLanguage()).isEqualTo("js");
  index.refresh();
  Rule hit=index.getByKey(ruleKey);
  assertThat(hit).isNotNull();
  assertThat(hit.key().repository()).isEqualTo(ruleKey.repository());
  assertThat(hit.key().rule()).isEqualTo(ruleKey.rule());
  assertThat(hit.language()).isEqualTo("js");
  assertThat(hit.name()).isEqualTo("Rule S001");
  assertThat(hit.htmlDescription()).isEqualTo("Description S001");
  assertThat(hit.status()).isEqualTo(RuleStatus.READY);
  assertThat(hit.internalKey()).isEqualTo("InternalKeyS001");
  assertThat(hit.severity()).isEqualTo("INFO");
  assertThat(hit.template()).isFalse();
}
