{
  db.prepareDbUnit(getClass(),"associate_default_groups_when_updating_user.xml");
  createDefaultGroup();
  userUpdater.update(UpdateUser.create("marius").setName("Marius2").setEmail("marius2@mail.com").setPassword("password2").setPasswordConfirmation("password2").setScmAccounts(newArrayList("ma2")));
  session.commit();
  GroupMembershipFinder.Membership membership=groupMembershipFinder.find(GroupMembershipQuery.builder().login("marius").groupSearch("sonar-users").build());
  assertThat(membership.groups()).hasSize(1);
  assertThat(membership.groups().get(0).name()).isEqualTo("sonar-users");
  assertThat(membership.groups().get(0).isMember()).isFalse();
}
