{
  when(serverUpgradeStatus.isFreshInstall()).thenReturn(true);
  jarsInstaller.install();
  assertThat(jarsInstaller.getMetadata()).hasSize(2);
  PluginMetadata plugin=jarsInstaller.getMetadata("bar");
  assertThat(plugin.getName()).isEqualTo("Bar");
  assertThat(plugin.getDeployedFiles()).hasSize(1);
  assertThat(plugin.isCore()).isFalse();
  assertThat(plugin.isUseChildFirstClassLoader()).isFalse();
  File deployedJar=new File(deployDir,"plugins/bar/bar-plugin.jar");
  assertThat(deployedJar).exists();
  assertThat(deployedJar).isFile();
}
