{
  when(serverUpgradeStatus.isFreshInstall()).thenReturn(false);
  jarsInstaller.install();
  assertThat(jarsInstaller.getMetadata()).hasSize(1);
  PluginMetadata plugin=jarsInstaller.getMetadata("foo");
  assertThat(plugin.getName()).isEqualTo("Foo");
  assertThat(plugin.getDeployedFiles()).hasSize(1);
  assertThat(plugin.isCore()).isFalse();
  assertThat(plugin.isUseChildFirstClassLoader()).isFalse();
  File deployedJar=new File(deployDir,"plugins/foo/foo-plugin.jar");
  assertThat(deployedJar).exists();
  assertThat(deployedJar).isFile();
}
