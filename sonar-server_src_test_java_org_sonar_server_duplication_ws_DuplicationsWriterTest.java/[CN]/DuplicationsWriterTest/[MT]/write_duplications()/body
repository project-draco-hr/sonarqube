{
  String key1="org.codehaus.sonar:sonar-ws-client:src/main/java/org/sonar/wsclient/services/PropertyDeleteQuery.java";
  ComponentDto file1=new ComponentDto().setId(10L).setQualifier("FIL").setKey(key1).setLongName("PropertyDeleteQuery").setProjectId(1L);
  String key2="org.codehaus.sonar:sonar-ws-client:src/main/java/org/sonar/wsclient/services/PropertyUpdateQuery.java";
  ComponentDto file2=new ComponentDto().setId(11L).setQualifier("FIL").setKey(key2).setLongName("PropertyUpdateQuery").setProjectId(1L);
  when(componentDao.getByKey(key1,session)).thenReturn(file1);
  when(componentDao.getByKey(key2,session)).thenReturn(file2);
  when(componentDao.getById(1L,session)).thenReturn(new ComponentDto().setId(1L).setLongName("SonarQube"));
  test("<duplications>\n" + "<g>\n" + "<b s=\"57\" l=\"12\" r=\"org.codehaus.sonar:sonar-ws-client:src/main/java/org/sonar/wsclient/services/PropertyDeleteQuery.java\"/>\n"+ "<b s=\"73\" l=\"12\" r=\"org.codehaus.sonar:sonar-ws-client:src/main/java/org/sonar/wsclient/services/PropertyUpdateQuery.java\"/>\n"+ "</g>\n"+ "</duplications>","{\n" + "  \"duplications\": [\n" + "    {\n"+ "      \"blocks\": [\n"+ "        {\n"+ "          \"from\": 57, \"size\": 12, \"_ref\": \"1\"\n"+ "        },\n"+ "        {\n"+ "          \"from\": 73, \"size\": 12, \"_ref\": \"2\"\n"+ "        }\n"+ "      ]\n"+ "    },"+ "  ],\n"+ "  \"files\": {\n"+ "    \"1\": {\n"+ "      \"key\": \"org.codehaus.sonar:sonar-ws-client:src/main/java/org/sonar/wsclient/services/PropertyDeleteQuery.java\",\n"+ "      \"name\": \"PropertyDeleteQuery\",\n"+ "      \"projectName\": \"SonarQube\"\n"+ "    },\n"+ "    \"2\": {\n"+ "      \"key\": \"org.codehaus.sonar:sonar-ws-client:src/main/java/org/sonar/wsclient/services/PropertyUpdateQuery.java\",\n"+ "      \"name\": \"PropertyUpdateQuery\",\n"+ "      \"projectName\": \"SonarQube\"\n"+ "    }\n"+ "  }"+ "}");
  verify(componentDao,times(2)).getByKey(anyString(),eq(session));
  verify(componentDao,times(1)).getById(anyLong(),eq(session));
}
