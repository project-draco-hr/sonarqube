{
  File basedir=temp.newFolder();
  File srcFile=new File(basedir,"src/main/java/foo/Bar.java");
  FileUtils.touch(srcFile);
  FileUtils.write(srcFile,"single line");
  when(fs.baseDir()).thenReturn(basedir);
  when(fs.sourceCharset()).thenReturn(Charsets.UTF_8);
  File sourceDir=new File(basedir,"src/main/java");
  when(fs.sourceDirs()).thenReturn(Arrays.asList(sourceDir));
  when(langDetection.language(any(InputFile.class))).thenReturn("java");
  when(statusDetection.status("src/main/java/foo/Bar.java","6c1d64c0b3555892fe7273e954f6fb5a")).thenReturn(InputFile.STATUS_ADDED);
  InputFileBuilder builder=new InputFileBuilder("struts",new PathResolver(),langDetection,statusDetection,fs);
  DefaultInputFile inputFile=builder.create(srcFile,InputFile.TYPE_MAIN);
  assertThat(inputFile.attribute(DefaultInputFile.ATTRIBUTE_SOURCE_RELATIVE_PATH)).isEqualTo("foo/Bar.java");
  assertThat(inputFile.attribute(DefaultInputFile.ATTRIBUTE_SOURCEDIR_PATH)).isEqualTo(PathUtils.sanitize(sourceDir.getAbsolutePath()));
  assertThat(inputFile.attribute(DefaultInputFile.ATTRIBUTE_COMPONENT_DEPRECATED_KEY)).isEqualTo("struts:foo.Bar");
}
