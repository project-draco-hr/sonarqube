{
  File basedir=temp.newFolder();
  File srcFile=new File(basedir,"src/main/java/foo/Bar.java");
  FileUtils.touch(srcFile);
  FileUtils.write(srcFile,"single line");
  when(fs.baseDir()).thenReturn(basedir);
  when(fs.sourceCharset()).thenReturn(Charsets.UTF_8);
  when(langDetection.language(any(InputFile.class))).thenReturn("java");
  when(statusDetection.status("src/main/java/foo/Bar.java","6c1d64c0b3555892fe7273e954f6fb5a")).thenReturn(InputFile.STATUS_ADDED);
  InputFileBuilder builder=new InputFileBuilder("struts",new PathResolver(),langDetection,statusDetection,fs);
  DefaultInputFile inputFile=builder.create(srcFile,InputFile.TYPE_MAIN);
  assertThat(inputFile.name()).isEqualTo("Bar.java");
  assertThat(inputFile.file()).isEqualTo(srcFile.getAbsoluteFile());
  assertThat(inputFile.absolutePath()).isEqualTo(PathUtils.sanitize(srcFile.getAbsolutePath()));
  assertThat(inputFile.language()).isEqualTo("java");
  assertThat(inputFile.attribute(DefaultInputFile.ATTRIBUTE_COMPONENT_KEY)).isEqualTo("struts:src/main/java/foo/Bar.java");
  assertThat(inputFile.path()).isEqualTo("src/main/java/foo/Bar.java");
  assertThat(inputFile.attribute(InputFile.ATTRIBUTE_LINE_COUNT)).isEqualTo("1");
  assertThat(inputFile.attribute(DefaultInputFile.ATTRIBUTE_SOURCE_RELATIVE_PATH)).isNull();
  assertThat(inputFile.attribute(DefaultInputFile.ATTRIBUTE_SOURCEDIR_PATH)).isNull();
  assertThat(inputFile.attribute(DefaultInputFile.ATTRIBUTE_COMPONENT_DEPRECATED_KEY)).isNull();
}
