{
  Settings settings=new Settings();
  settings.setProperty(CoreProperties.CORE_RULE_WEIGHTS_PROPERTY,"BLOCKER=10;CRITICAL=5;MAJOR=2;MINOR=1;INFO=0");
  WeightedViolationsDecorator decorator=new WeightedViolationsDecorator(settings);
  DecoratorContext context=mock(DecoratorContext.class);
  when(context.getMeasure(CoreMetrics.INFO_VIOLATIONS)).thenReturn(new Measure(CoreMetrics.INFO_VIOLATIONS,50.0));
  when(context.getMeasure(CoreMetrics.CRITICAL_VIOLATIONS)).thenReturn(new Measure(CoreMetrics.CRITICAL_VIOLATIONS,80.0));
  when(context.getMeasure(CoreMetrics.BLOCKER_VIOLATIONS)).thenReturn(new Measure(CoreMetrics.BLOCKER_VIOLATIONS,100.0));
  decorator.start();
  decorator.decorate(context);
  verify(context).saveMeasure(argThat(new IsMeasure(CoreMetrics.WEIGHTED_VIOLATIONS,(double)(100 * 10 + 80 * 5 + 50 * 0))));
  verify(context).saveMeasure(argThat(new IsMeasure(CoreMetrics.WEIGHTED_VIOLATIONS,"INFO=50;CRITICAL=80;BLOCKER=100")));
}
