{
  if (StringUtils.equals(mode,CoreProperties.TIMEMACHINE_MODE_VERSION)) {
    String label=String.format("Compare to version %s",modeParameter);
    if (targetDate != null) {
      label+=String.format(" (%s)",DateUtils.formatDate(getDate()));
    }
    return label;
  }
  if (StringUtils.equals(mode,CoreProperties.TIMEMACHINE_MODE_DAYS)) {
    String label=String.format("Compare over %s days (%s",modeParameter,DateUtils.formatDate(targetDate));
    if (isRelatedToSnapshot()) {
      label+=", analysis of " + getDate();
    }
    label+=")";
    return label;
  }
  if (StringUtils.equals(mode,CoreProperties.TIMEMACHINE_MODE_PREVIOUS_ANALYSIS)) {
    String label="Compare to previous analysis";
    if (isRelatedToSnapshot()) {
      label+=String.format(" (%s)",DateUtils.formatDate(getDate()));
    }
    return label;
  }
  if (StringUtils.equals(mode,CoreProperties.TIMEMACHINE_MODE_PREVIOUS_VERSION)) {
    String label="Compare to previous version";
    if (isRelatedToSnapshot()) {
      label+=String.format(" (%s)",DateUtils.formatDate(getDate()));
    }
    return label;
  }
  if (StringUtils.equals(mode,CoreProperties.TIMEMACHINE_MODE_DATE)) {
    String label="Compare to date " + DateUtils.formatDate(targetDate);
    if (isRelatedToSnapshot()) {
      label+=String.format(" (analysis of %s)",DateUtils.formatDate(getDate()));
    }
    return label;
  }
  return ReflectionToStringBuilder.toString(this);
}
