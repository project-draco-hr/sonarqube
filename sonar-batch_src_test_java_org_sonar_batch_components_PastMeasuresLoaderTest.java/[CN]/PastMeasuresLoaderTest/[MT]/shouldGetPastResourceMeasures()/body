{
  setupData("shared");
  List<Metric> metrics=selectMetrics();
  Snapshot projectSnapshot=getSession().getSingleResult(Snapshot.class,"id",PROJECT_SNAPSHOT_ID);
  PastMeasuresLoader loader=new PastMeasuresLoader(getSession(),metrics);
  List<Object[]> measures=loader.getPastMeasures(FILE_KEY,projectSnapshot);
  assertThat(measures.size(),is(2));
  Object[] pastMeasure=measures.get(0);
  assertThat(PastMeasuresLoader.getMetricId(pastMeasure),is(1));
  assertThat(PastMeasuresLoader.getCharacteristicId(pastMeasure),nullValue());
  assertThat(PastMeasuresLoader.getPersonId(pastMeasure),nullValue());
  assertThat(PastMeasuresLoader.getValue(pastMeasure),is(5.0));
  pastMeasure=measures.get(1);
  assertThat(PastMeasuresLoader.getMetricId(pastMeasure),is(2));
  assertThat(PastMeasuresLoader.getCharacteristicId(pastMeasure),nullValue());
  assertThat(PastMeasuresLoader.getPersonId(pastMeasure),nullValue());
  assertThat(PastMeasuresLoader.getValue(pastMeasure),is(60.0));
}
