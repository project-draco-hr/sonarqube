{
  RuleDto manualRule=RuleTesting.newManualRule("Manual_Rule");
  dao.insert(dbSession,manualRule);
  dbSession.commit();
  deleter.delete(manualRule.getKey());
  RuleDto result=dao.selectOrFailByKey(dbSession,manualRule.getKey());
  assertThat(result).isNotNull();
  assertThat(result.getStatus()).isEqualTo(RuleStatus.REMOVED);
  assertThat(index.search(new RuleQuery(),new SearchOptions()).getIds()).isEmpty();
}
