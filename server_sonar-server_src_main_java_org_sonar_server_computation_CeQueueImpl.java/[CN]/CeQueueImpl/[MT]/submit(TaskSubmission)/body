{
  checkArgument(!Strings.isNullOrEmpty(submission.getUuid()));
  checkArgument(!Strings.isNullOrEmpty(submission.getType()));
  checkArgument(submission instanceof TaskSubmissionImpl);
  checkState(!submitPaused.get(),"Compute Engine does not currently accept new tasks");
  CeTask task=new CeTask(submission);
  DbSession dbSession=dbClient.openSession(false);
  try {
    CeQueueDto dto=createQueueDtoForSubmit(task);
    dbClient.ceQueueDao().insert(dbSession,dto);
    dbSession.commit();
    queueStatus.addReceived();
    return task;
  }
  finally {
    dbClient.closeSession(dbSession);
  }
}
