{
  String uuid="1234";
  when(componentService.getByUuid(uuid)).thenReturn(new ComponentDto().setKey(FILE_KEY));
  MockUserSession.set().addComponentPermission(UserRole.CODEVIEWER,"SonarQube",FILE_KEY);
  String key1="org.foo.BarTest.java";
  String name1="src/test/java/org/foo/BarTest.java";
  String uuid1="ABCD";
  TestCase testCase1=testCase("test1",TestCase.Status.OK,10L,key1);
  ComponentDto component1=new ComponentDto().setKey(key1).setLongName(name1).setUuid(uuid1);
  String key2="org.foo.FileTest.java";
  String name2="src/test/java/org/foo/FileTest.java";
  String uuid2="BCDE";
  TestCase testCase2=testCase("test2",TestCase.Status.ERROR,97L,key2);
  ComponentDto component2=new ComponentDto().setKey(key2).setLongName(name2).setUuid(uuid2);
  when(testable.testCasesOfLine(10)).thenReturn(newArrayList(testCase1,testCase2));
  when(componentDao.getByKeys(Matchers.isA(DbSession.class),Matchers.anyCollectionOf(String.class))).thenReturn(newArrayList(component1,component2));
  WsTester.TestRequest request=tester.newGetRequest("api/tests","test_cases").setParam("uuid",uuid).setParam("line","10");
  request.execute().assertJson(EXPECTED_JSON);
}
