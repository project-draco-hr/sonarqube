{
  long now=system2.now();
  Set<String> localUsers=new HashSet<>(asList(settings.getStringArray(LOCAL_USERS_PROPERTY)));
  boolean isRealmExist=settings.getString(CORE_AUTHENTICATOR_REALM) != null;
  for (  UserDto user : dbClient.userDao().selectUsers(session,UserQuery.ALL_ACTIVES)) {
    if (user.getExternalIdentityProvider().equals(UserUpdater.SQ_AUTHORITY)) {
      user.setLocal(!isRealmExist || localUsers.contains(user.getLogin()));
    }
 else {
      user.setLocal(false);
    }
    user.setUpdatedAt(now);
    dbClient.userDao().update(session,user);
  }
}
