{
  pluginDownloader.start();
  assertThat(pluginDownloader.getDownloadedPluginFilenames()).hasSize(0);
  copyFileToDirectory(new File(resource("foo-plugin-1.0.jar")),downloadDir);
  assertThat(pluginDownloader.getDownloadedPlugins()).hasSize(1);
  DefaultPluginMetadata metadata=pluginDownloader.getDownloadedPlugins().iterator().next();
  assertThat(metadata.getKey()).isEqualTo("foo");
  assertThat(metadata.getName()).isEqualTo("Foo");
  assertThat(metadata.getVersion()).isEqualTo("1.0");
  assertThat(metadata.getOrganization()).isEqualTo("SonarSource");
  assertThat(metadata.getOrganizationUrl()).isEqualTo("http://www.sonarsource.org");
  assertThat(metadata.getLicense()).isEqualTo("LGPL 3");
  assertThat(metadata.getMainClass()).isEqualTo("foo.Main");
}
