{
  RuleDto ruleDto=new RuleDto().setCardinality(ruleDef.template() ? Cardinality.MULTIPLE : Cardinality.SINGLE).setConfigKey(ruleDef.engineKey()).setDescription(ruleDef.htmlDescription()).setLanguage(ruleDef.repository().language()).setName(ruleDef.name()).setRepositoryKey(ruleDef.repository().key()).setRuleKey(ruleDef.key()).setSeverity(RulePriority.valueOf(ruleDef.severity()).name()).setCreatedAt(buffer.now()).setUpdatedAt(buffer.now()).setStatus(ruleDef.status().name());
  ruleDao.insert(ruleDto,sqlSession);
  buffer.add(ruleDto);
  for (  RuleDefinitions.Param param : ruleDef.params()) {
    RuleParamDto paramDto=new RuleParamDto().setRuleId(ruleDto.getId()).setDefaultValue(param.defaultValue()).setDescription(param.description()).setName(param.name()).setType(param.type().toString());
    ruleDao.insert(paramDto,sqlSession);
    buffer.add(paramDto);
  }
  mergeTags(buffer,sqlSession,ruleDef,ruleDto);
  return ruleDto;
}
