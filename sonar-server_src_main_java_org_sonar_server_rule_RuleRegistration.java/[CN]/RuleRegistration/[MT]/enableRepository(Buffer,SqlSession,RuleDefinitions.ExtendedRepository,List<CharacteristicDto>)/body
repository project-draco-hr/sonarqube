{
  int count=0;
  for (  RuleDefinitions.Rule ruleDef : repoDef.rules()) {
    RuleDto dto=buffer.rule(RuleKey.of(ruleDef.repository().key(),ruleDef.key()));
    if (dto == null) {
      dto=enableAndInsert(buffer,sqlSession,ruleDef,characteristicDtos);
    }
 else {
      enableAndUpdate(buffer,sqlSession,ruleDef,dto,characteristicDtos);
    }
    buffer.markProcessed(dto);
    count++;
    if (count % 100 == 0) {
      sqlSession.commit();
    }
  }
  sqlSession.commit();
}
