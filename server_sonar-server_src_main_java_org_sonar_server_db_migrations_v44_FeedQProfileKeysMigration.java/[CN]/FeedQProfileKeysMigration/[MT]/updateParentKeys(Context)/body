{
  MassUpdate massUpdate=context.prepareMassUpdate();
  massUpdate.select("SELECT child.id,parent.kee FROM rules_profiles child, rules_profiles parent WHERE child.parent_name=parent.name " + "and child.language=parent.language AND child.parent_name IS NOT NULL");
  massUpdate.update("UPDATE rules_profiles SET parent_kee=? WHERE id=?");
  massUpdate.execute(new MassUpdate.Handler(){
    @Override public boolean handle(    Select.Row row,    SqlStatement update) throws SQLException {
      Long id=row.getNullableLong(1);
      String parentKey=row.getNullableString(2);
      update.setString(1,parentKey);
      update.setLong(2,id);
      return true;
    }
  }
);
}
