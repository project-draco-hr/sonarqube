{
  RuleKey ruleKey=RuleKey.of("repo","key");
  when(ruleDao.selectParametersByRuleId(eq(10),eq(session))).thenReturn(newArrayList(new RuleParamDto().setId(20).setName("max").setDefaultValue("10")));
  operations.createActiveRule(1,10,Severity.CRITICAL,session);
  ArgumentCaptor<ActiveRuleDto> activeRuleArgument=ArgumentCaptor.forClass(ActiveRuleDto.class);
  verify(activeRuleDao).insert(activeRuleArgument.capture(),eq(session));
  assertThat(activeRuleArgument.getValue().getRulId()).isEqualTo(10);
  assertThat(activeRuleArgument.getValue().getSeverityString()).isEqualTo(Severity.CRITICAL);
  ArgumentCaptor<ActiveRuleParamDto> activeRuleParamArgument=ArgumentCaptor.forClass(ActiveRuleParamDto.class);
  verify(activeRuleDao).insert(activeRuleParamArgument.capture(),eq(session));
  assertThat(activeRuleParamArgument.getValue().getKey()).isEqualTo("max");
  assertThat(activeRuleParamArgument.getValue().getValue()).isEqualTo("10");
  verifyZeroInteractions(session);
  verifyZeroInteractions(profilesManager);
  verifyZeroInteractions(esActiveRule);
}
