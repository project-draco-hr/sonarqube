{
  RuleDebt ruleDebt=new RuleDebt().setRuleKey(RuleKey.of(rule.getRepositoryKey(),rule.getRuleKey()));
  Integer effectiveSubCharacteristicId=rule.getSubCharacteristicId() != null ? rule.getSubCharacteristicId() : rule.getDefaultSubCharacteristicId();
  DebtCharacteristic subCharacteristic=(effectiveSubCharacteristicId != null && !RuleDto.DISABLED_CHARACTERISTIC_ID.equals(effectiveSubCharacteristicId)) ? debtModel.characteristicById(effectiveSubCharacteristicId) : null;
  if (subCharacteristic != null) {
    ruleDebt.setSubCharacteristicKey(subCharacteristic.key());
    String overriddenFunction=rule.getRemediationFunction();
    String defaultFunction=rule.getDefaultRemediationFunction();
    if (overriddenFunction != null) {
      ruleDebt.setFunction(overriddenFunction);
      ruleDebt.setCoefficient(rule.getRemediationCoefficient());
      ruleDebt.setOffset(rule.getRemediationOffset());
      return ruleDebt;
    }
 else     if (defaultFunction != null) {
      ruleDebt.setFunction(defaultFunction);
      ruleDebt.setCoefficient(rule.getDefaultRemediationCoefficient());
      ruleDebt.setOffset(rule.getDefaultRemediationOffset());
      return ruleDebt;
    }
  }
  return null;
}
