{
  CharacteristicDto sourceCharacteristic=characteristicByKey(targetCharacteristic.key(),sourceCharacteristics,false);
  if (sourceCharacteristic == null) {
    CharacteristicDto newCharacteristic=toDto(targetCharacteristic,parentId).setCreatedAt(updateDate);
    dao.insert(newCharacteristic,session);
    return newCharacteristic;
  }
 else {
    if (ObjectUtils.notEqual(sourceCharacteristic.getName(),targetCharacteristic.name()) || ObjectUtils.notEqual(sourceCharacteristic.getOrder(),targetCharacteristic.order()) || ObjectUtils.notEqual(sourceCharacteristic.getParentId(),parentId)) {
      sourceCharacteristic.setName(targetCharacteristic.name());
      sourceCharacteristic.setOrder(targetCharacteristic.order());
      sourceCharacteristic.setParentId(parentId);
      sourceCharacteristic.setUpdatedAt(updateDate);
      dao.update(sourceCharacteristic,session);
    }
    return sourceCharacteristic;
  }
}
