{
  List<CharacteristicDto> sourceCharacteristics=dao.selectEnabledCharacteristics(session);
  List<CharacteristicDto> result=newArrayList();
  for (  DebtCharacteristic characteristic : targetModel.rootCharacteristics()) {
    CharacteristicDto rootCharacteristicDto=restoreCharacteristic(characteristic,null,sourceCharacteristics,updateDate,session);
    result.add(rootCharacteristicDto);
    for (    DebtCharacteristic subCharacteristic : targetModel.subCharacteristics(characteristic.key())) {
      result.add(restoreCharacteristic(subCharacteristic,rootCharacteristicDto.getId(),sourceCharacteristics,updateDate,session));
    }
  }
  if (disableNoMoreExistingCharacteristics) {
    for (    CharacteristicDto sourceCharacteristic : sourceCharacteristics) {
      if (targetModel.characteristicByKey(sourceCharacteristic.getKey()) == null) {
        debtModelOperations.delete(sourceCharacteristic,updateDate,session);
      }
    }
  }
  return result;
}
