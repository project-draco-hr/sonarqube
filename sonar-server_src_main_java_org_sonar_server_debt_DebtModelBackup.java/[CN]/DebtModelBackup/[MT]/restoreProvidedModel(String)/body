{
  checkPermission();
  Date updateDate=new Date(system2.now());
  SqlSession session=mybatis.openSession();
  try {
    restoreCharacteristics(loadModelFromPlugin(DebtModelPluginRepository.DEFAULT_MODEL),languageKey == null,updateDate,session);
    List<RuleDto> ruleDtos=rules(languageKey,session);
    for (    RuleDto rule : ruleDtos) {
      rule.setSubCharacteristicId(null);
      rule.setRemediationFunction(null);
      rule.setRemediationCoefficient(null);
      rule.setRemediationOffset(null);
      rule.setUpdatedAt(updateDate);
      ruleDao.update(rule,session);
    }
    ruleRegistry.reindex(ruleDtos,session);
    session.commit();
  }
  finally {
    MyBatis.closeQuietly(session);
  }
}
