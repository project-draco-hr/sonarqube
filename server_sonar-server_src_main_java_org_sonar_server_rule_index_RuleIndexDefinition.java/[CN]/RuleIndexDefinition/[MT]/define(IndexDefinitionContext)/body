{
  NewIndex index=context.create(INDEX);
  index.refreshHandledByIndexer();
  index.configureShards(settings,1);
  NewIndex.NewIndexType activeRuleMapping=index.createType(RuleIndexDefinition.TYPE_ACTIVE_RULE);
  activeRuleMapping.setEnableSource(false);
  activeRuleMapping.setAttribute("_parent",ImmutableMap.of("type",RuleIndexDefinition.TYPE_RULE));
  activeRuleMapping.stringFieldBuilder(RuleIndexDefinition.FIELD_ACTIVE_RULE_KEY).enableSorting().build();
  activeRuleMapping.stringFieldBuilder(RuleIndexDefinition.FIELD_ACTIVE_RULE_RULE_KEY).enableSorting().build();
  activeRuleMapping.stringFieldBuilder(RuleIndexDefinition.FIELD_ACTIVE_RULE_REPOSITORY).build();
  activeRuleMapping.stringFieldBuilder(RuleIndexDefinition.FIELD_ACTIVE_RULE_PROFILE_KEY).disableNorms().build();
  activeRuleMapping.stringFieldBuilder(RuleIndexDefinition.FIELD_ACTIVE_RULE_INHERITANCE).disableNorms().build();
  activeRuleMapping.stringFieldBuilder(RuleIndexDefinition.FIELD_ACTIVE_RULE_SEVERITY).disableNorms().build();
  activeRuleMapping.createLongField(RuleIndexDefinition.FIELD_ACTIVE_RULE_CREATED_AT);
  activeRuleMapping.createLongField(RuleIndexDefinition.FIELD_ACTIVE_RULE_UPDATED_AT);
  NewIndex.NewIndexType ruleMapping=index.createType(TYPE_RULE);
  ruleMapping.setEnableSource(false);
  ruleMapping.stringFieldBuilder(FIELD_RULE_KEY).enableSorting().build();
  ruleMapping.stringFieldBuilder(FIELD_RULE_RULE_KEY).enableSorting().build();
  ruleMapping.stringFieldBuilder(FIELD_RULE_REPOSITORY).build();
  ruleMapping.stringFieldBuilder(FIELD_RULE_INTERNAL_KEY).disableNorms().disableSearch().build();
  ruleMapping.stringFieldBuilder(FIELD_RULE_NAME).enableSorting().enableWordSearch().build();
  ruleMapping.setProperty(FIELD_RULE_HTML_DESCRIPTION,ImmutableSortedMap.of("type","string","index","analyzed","analyzer","html_analyzer","search_analyzer","html_analyzer"));
  ruleMapping.stringFieldBuilder(FIELD_RULE_SEVERITY).disableNorms().build();
  ruleMapping.stringFieldBuilder(FIELD_RULE_STATUS).disableNorms().build();
  ruleMapping.stringFieldBuilder(FIELD_RULE_LANGUAGE).disableNorms().build();
  ruleMapping.createBooleanField(FIELD_RULE_IS_TEMPLATE);
  ruleMapping.stringFieldBuilder(FIELD_RULE_TEMPLATE_KEY).disableNorms().build();
  ruleMapping.stringFieldBuilder(FIELD_RULE_ALL_TAGS).enableGramSearch().build();
  ruleMapping.stringFieldBuilder(FIELD_RULE_TYPE).disableNorms().build();
  ruleMapping.createLongField(FIELD_RULE_CREATED_AT);
  ruleMapping.createLongField(FIELD_RULE_UPDATED_AT);
}
