{
  NewIndex index=context.create(INDEX);
  index.refreshHandledByIndexer();
  index.setShards(settings);
  NewIndex.NewIndexType ruleMapping=index.createType(TYPE_RULE);
  ruleMapping.setAttribute("_id",ImmutableMap.of("path",FIELD_RULE_KEY));
  ruleMapping.setAttribute("_routing",ImmutableMap.of("required",true,"path",RuleIndexDefinition.FIELD_RULE_REPOSITORY));
  ruleMapping.setEnableSource(false);
  ruleMapping.stringFieldBuilder(FIELD_RULE_KEY).enableSorting().enableGramSearch().build();
  ruleMapping.stringFieldBuilder(FIELD_RULE_KEY_AS_LIST).enableGramSearch().build();
  ruleMapping.stringFieldBuilder(FIELD_RULE_RULE_KEY).disableSearch().docValues().build();
  ruleMapping.stringFieldBuilder(FIELD_RULE_REPOSITORY).docValues().build();
  ruleMapping.stringFieldBuilder(FIELD_RULE_INTERNAL_KEY).disableSearch().docValues().build();
  ruleMapping.stringFieldBuilder(FIELD_RULE_NAME).enableSorting().enableWordSearch().build();
  ruleMapping.stringFieldBuilder(FIELD_RULE_HTML_DESCRIPTION).enableWordSearch().build();
  ruleMapping.stringFieldBuilder(FIELD_RULE_SEVERITY).docValues().build();
  ruleMapping.stringFieldBuilder(FIELD_RULE_STATUS).docValues().build();
  ruleMapping.stringFieldBuilder(FIELD_RULE_LANGUAGE).enableGramSearch().build();
  ruleMapping.createBooleanField(FIELD_RULE_IS_TEMPLATE);
  ruleMapping.stringFieldBuilder(FIELD_RULE_TEMPLATE_KEY).docValues().build();
  ruleMapping.stringFieldBuilder(FIELD_RULE_ALL_TAGS).enableGramSearch().build();
  ruleMapping.createLongField(FIELD_RULE_CREATED_AT);
  ruleMapping.createLongField(FIELD_RULE_UPDATED_AT);
}
