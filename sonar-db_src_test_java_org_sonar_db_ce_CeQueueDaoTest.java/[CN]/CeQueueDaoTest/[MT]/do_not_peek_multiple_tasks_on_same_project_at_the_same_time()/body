{
  insert("TASK_1","PROJECT_1",CeQueueDto.Status.PENDING);
  insert("TASK_2","PROJECT_1",CeQueueDto.Status.PENDING);
  Optional<CeQueueDto> peek=underTest.peek(db.getSession());
  assertThat(peek.isPresent()).isTrue();
  assertThat(peek.get().getUuid()).isEqualTo("TASK_1");
  assertThat(underTest.countAll(db.getSession())).isEqualTo(2);
  assertThat(underTest.countByStatus(db.getSession(),CeQueueDto.Status.PENDING)).isEqualTo(1);
  assertThat(underTest.countByStatus(db.getSession(),CeQueueDto.Status.IN_PROGRESS)).isEqualTo(1);
  peek=underTest.peek(db.getSession());
  assertThat(peek.isPresent()).isFalse();
  underTest.deleteByUuid(db.getSession(),"TASK_1");
  peek=underTest.peek(db.getSession());
  assertThat(peek.get().getUuid()).isEqualTo("TASK_2");
}
