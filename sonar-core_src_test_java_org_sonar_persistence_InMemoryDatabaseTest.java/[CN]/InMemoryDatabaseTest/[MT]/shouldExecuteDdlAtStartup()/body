{
  int tables=0;
  InMemoryDatabase db=new InMemoryDatabase();
  try {
    db.start();
    assertNotNull(db.getDataSource());
    Connection connection=db.getDataSource().getConnection();
    assertNotNull(connection);
    ResultSet resultSet=connection.getMetaData().getTables("",null,null,new String[]{"TABLE"});
    while (resultSet.next()) {
      tables++;
    }
  }
  finally {
    db.stop();
  }
  assertThat(tables,greaterThan(30));
}
