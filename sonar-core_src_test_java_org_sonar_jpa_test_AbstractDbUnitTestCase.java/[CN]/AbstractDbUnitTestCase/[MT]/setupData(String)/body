{
  InputStream[] streams=new InputStream[testNames.length];
  try {
    for (int i=0; i < testNames.length; i++) {
      String className=getClass().getName();
      className=String.format("/%s/%s.xml",className.replace(".","/"),testNames[i]);
      streams[i]=getClass().getResourceAsStream(className);
      if (streams[i] == null) {
        throw new RuntimeException("Test not found :" + className);
      }
    }
    setupData(streams);
    databaseCommands.resetPrimaryKeys(database.getDataSource());
  }
 catch (  SQLException e) {
    throw translateException("Could not setup DBUnit data",e);
  }
 finally {
    for (    InputStream stream : streams) {
      IOUtils.closeQuietly(stream);
    }
  }
}
