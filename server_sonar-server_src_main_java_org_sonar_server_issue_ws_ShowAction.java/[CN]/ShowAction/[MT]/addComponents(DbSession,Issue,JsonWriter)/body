{
  ComponentDto component=dbClient.componentDao().selectByUuid(session,issue.componentUuid());
  Long parentProjectId=component.parentProjectId();
  ComponentDto parentProject=parentProjectId != null ? dbClient.componentDao().selectNullableById(parentProjectId,session) : null;
  ComponentDto project=dbClient.componentDao().selectByUuid(session,component.projectUuid());
  String projectName=project.longName() != null ? project.longName() : project.name();
  boolean displayParentProjectLongName=parentProject != null && !parentProject.getId().equals(project.getId());
  String parentProjectKey=displayParentProjectLongName ? parentProject.key() : null;
  String parentProjectName=displayParentProjectLongName ? parentProject.longName() != null ? parentProject.longName() : parentProject.name() : null;
  json.prop("component",component.key()).prop("componentLongName",component.longName()).prop("componentQualifier",component.qualifier()).prop("componentEnabled",component.isEnabled()).prop("project",project.key()).prop("projectName",projectName).prop("subProject",parentProjectKey).prop("subProjectName",parentProjectName);
}
