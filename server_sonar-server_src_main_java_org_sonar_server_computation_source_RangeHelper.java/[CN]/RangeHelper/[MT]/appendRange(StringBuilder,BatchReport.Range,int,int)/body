{
  validateOffsetOrder(range,lineIndex);
  if (element.length() > 0) {
    element.append(SYMBOLS_SEPARATOR);
  }
  if (range.getStartLine() == lineIndex) {
    validateStartOffsetNotGreaterThanLineLength(range,lineLength,lineIndex);
    element.append(range.getStartOffset()).append(OFFSET_SEPARATOR);
  }
 else   if (range.getStartLine() < lineIndex) {
    element.append(0).append(OFFSET_SEPARATOR);
  }
  if (range.getEndLine() == lineIndex) {
    validateEndOffsetNotGreaterThanLineLength(range,lineLength,lineIndex);
    element.append(range.getEndOffset()).append(OFFSET_SEPARATOR);
  }
 else   if (range.getEndLine() > lineIndex) {
    element.append(lineLength - 1).append(OFFSET_SEPARATOR);
  }
}
