{
  logAsSysAdminUser();
  GroupDto group1=insertGroup(new GroupDto().setName("group-1-name").setDescription("group-1-description"));
  GroupDto group2=insertGroup(new GroupDto().setName("group-2-name").setDescription("group-2-description"));
  GroupDto group3=insertGroup(new GroupDto().setName("group-3-name").setDescription("group-3-description"));
  PermissionTemplateDto template=dbClient.permissionTemplateDao().insert(dbSession,newPermissionTemplateDto().setUuid("template-uuid-1"));
  addGroupToTemplate(newPermissionTemplateGroup(USER,template.getId(),group1.getId()));
  addGroupToTemplate(newPermissionTemplateGroup(ADMIN,template.getId(),group2.getId()));
  addGroupToTemplate(newPermissionTemplateGroup(USER,template.getId(),null));
  PermissionTemplateDto anotherTemplate=dbClient.permissionTemplateDao().insert(dbSession,newPermissionTemplateDto().setUuid("template-uuid-2"));
  addGroupToTemplate(newPermissionTemplateGroup(USER,anotherTemplate.getId(),group1.getId()));
  commit();
  InputStream responseStream=ws.newRequest().setMediaType(PROTOBUF).setParam(PARAM_TEMPLATE_NAME,template.getName()).execute().getInputStream();
  WsGroupsResponse response=WsGroupsResponse.parseFrom(responseStream);
  assertThat(response.getGroupsList()).extracting("name").containsExactly("Anyone","group-1-name","group-2-name");
}
