{
  logAsSysAdminUser();
  GroupDto adminGroup=insertGroup(newGroupDto().setName("sonar-administrators").setDescription("System administrators"));
  GroupDto userGroup=insertGroup(newGroupDto().setName("sonar-users").setDescription("Any new users created will automatically join this group"));
  PermissionTemplateDto template=dbClient.permissionTemplateDao().insert(dbSession,newPermissionTemplateDto().setUuid("template-uuid-1"));
  addGroupToTemplate(newPermissionTemplateGroup(ISSUE_ADMIN,template.getId(),adminGroup.getId()));
  addGroupToTemplate(newPermissionTemplateGroup(ISSUE_ADMIN,template.getId(),userGroup.getId()));
  addGroupToTemplate(newPermissionTemplateGroup(USER,template.getId(),null));
  addGroupToTemplate(newPermissionTemplateGroup(ISSUE_ADMIN,template.getId(),null));
  commit();
  String response=ws.newRequest().setParam(PARAM_PERMISSION,ISSUE_ADMIN).setParam(PARAM_TEMPLATE_ID,template.getUuid()).execute().getInput();
  assertJson(response).ignoreFields("id").withStrictArrayOrder().isSimilarTo(getClass().getResource("template_groups-example.json"));
}
