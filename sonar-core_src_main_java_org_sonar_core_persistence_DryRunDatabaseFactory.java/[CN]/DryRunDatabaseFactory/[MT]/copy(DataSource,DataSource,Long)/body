{
  DbTemplate template=new DbTemplate();
  template.copyTable(source,dest,"active_rules").copyTable(source,dest,"active_rule_parameters").copyTable(source,dest,"characteristics").copyTable(source,dest,"characteristic_edges").copyTable(source,dest,"characteristic_properties").copyTable(source,dest,"metrics").copyTable(source,dest,"quality_models").copyTable(source,dest,"rules").copyTable(source,dest,"rules_parameters").copyTable(source,dest,"rules_profiles").copyTable(source,dest,"alerts");
  if (projectId != null) {
    String snapshotCondition="islast=" + database.getDialect().getTrueSqlValue() + " and (project_id="+ projectId+ " or root_project_id="+ projectId+ ")";
    template.copyTable(source,dest,"projects","id in (select project_id from snapshots where " + snapshotCondition + ") or (id="+ projectId+ " or root_id="+ projectId+ ")");
    template.copyTable(source,dest,"snapshots",snapshotCondition);
    String forRootModule="(root_component_id in (select id from projects where id=" + projectId + " and qualifier='TRK'))";
    String forSubModule="(component_id in (select id from projects where id=" + projectId + " or root_id="+ projectId+ "))";
    template.copyTable(source,dest,"issues","(" + forRootModule + ") or( "+ forSubModule+ ")","status<>'" + Issue.STATUS_CLOSED + "'");
  }
}
