{
  DbSession session=db.openSession(false);
  try {
    Date now=new Date(system.now());
    int i=0;
    QualityProfileMapper profileMapper=session.getMapper(QualityProfileMapper.class);
    Migration44Mapper migrationMapper=session.getMapper(Migration44Mapper.class);
    for (    QualityProfileDto profile : profileMapper.selectAll()) {
      Date createdAt=(Date)ObjectUtils.defaultIfNull(migrationMapper.selectProfileCreatedAt(profile.getId()),now);
      Date updatedAt=(Date)ObjectUtils.defaultIfNull(migrationMapper.selectProfileUpdatedAt(profile.getId()),now);
      migrationMapper.updateProfileDates(profile.getId(),createdAt,updatedAt,UtcDateUtils.formatDateTime(updatedAt));
      if (i % 100 == 0) {
        session.commit();
        i++;
      }
    }
    session.commit();
  }
  finally {
    session.close();
  }
}
