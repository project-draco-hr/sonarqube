{
  List<String> componentUuids=query.getComponentUuids();
  if (componentUuids != null && componentUuids.size() == 1) {
    if (!userSession.hasGlobalPermission(GlobalPermissions.SYSTEM_ADMIN) && !userSession.hasComponentUuidPermission(UserRole.ADMIN,componentUuids.get(0))) {
      throw new ForbiddenException("Requires administration permission");
    }
  }
 else {
    userSession.checkGlobalPermission(UserRole.ADMIN);
  }
}
