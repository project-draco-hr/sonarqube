{
  DbClient dbClient=mock(DbClient.class);
  when(dbClient.openSession(false)).thenReturn(session);
  when(dbClient.componentDao()).thenReturn(componentDao);
  when(dbClient.propertiesDao()).thenReturn(propertiesDao);
  when(dbClient.measureDao()).thenReturn(measureDao);
  when(measureDao.findByComponentKeyAndMetricKeys(eq(session),anyString(),anyListOf(String.class))).thenReturn(measures);
  tester=new WsTester(new ComponentsWs(new AppAction(dbClient,durations,i18n,userSessionRule,new ComponentFinder(dbClient)),mock(SearchAction.class)));
}
