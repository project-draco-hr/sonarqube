{
  StringWriter out=new StringWriter();
  PreviousIssueHelper helper=PreviousIssueHelper.create(out);
  PreviousIssue issue1=new PreviousIssue();
  issue1.setKey("key1");
  issue1.setComponentKey("key");
  issue1.setRuleKey("repokey","rulekey");
  issue1.setLine(2);
  issue1.setMessage("message");
  issue1.setSeverity("severity");
  issue1.setManualSeverity(true);
  issue1.setResolution("resolution");
  issue1.setStatus("status");
  issue1.setChecksum("checksum");
  issue1.setAssigneeLogin("login");
  PreviousIssue issue2=new PreviousIssue();
  issue2.setKey("key2");
  PreviousIssueFunction previousIssueFunction=new PreviousIssueFunction();
  helper.addIssue(issue1,previousIssueFunction);
  helper.addIssue(issue2,previousIssueFunction);
  helper.close();
  JSONAssert.assertEquals("[{\"key\": \"key1\", \"componentKey\": \"key\", \"ruleKey\": \"rulekey\", \"ruleRepo\": \"repokey\", \"line\": 2,\"message\": \"message\", " + "\"severity\": \"severity\", \"manualSeverity\": true, \"resolution\": \"resolution\", \"status\": \"status\", \"checksum\": \"checksum\",\"assigneeLogin\": \"login\"}," + "{\"key\": \"key2\", \"manualSeverity\": false}]",out.getBuffer().toString(),true);
}
