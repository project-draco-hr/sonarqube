{
  TempDirectories tempDirs=mock(TempDirectories.class);
  ServerClient server=mock(ServerClient.class);
  when(server.request("/deploy/plugins/index.txt")).thenReturn("checkstyle,true\nsqale,false");
  PluginDownloader downloader=new PluginDownloader(tempDirs,server);
  List<RemotePlugin> plugins=downloader.downloadPluginIndex();
  assertThat(plugins).hasSize(2);
  assertThat(plugins.get(0).getKey()).isEqualTo("checkstyle");
  assertThat(plugins.get(0).isCore()).isTrue();
  assertThat(plugins.get(1).getKey()).isEqualTo("sqale");
  assertThat(plugins.get(1).isCore()).isFalse();
}
