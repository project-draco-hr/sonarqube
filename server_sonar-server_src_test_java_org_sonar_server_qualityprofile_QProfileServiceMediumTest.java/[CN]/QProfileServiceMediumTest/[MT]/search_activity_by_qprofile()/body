{
  tester.get(ActivityService.class).write(dbSession,Activity.Type.QPROFILE,ActiveRuleChange.createFor(ActiveRuleChange.Type.ACTIVATED,ActiveRuleKey.of(XOO_P1_KEY,RuleTesting.XOO_X1)));
  tester.get(ActivityService.class).write(dbSession,Activity.Type.QPROFILE,ActiveRuleChange.createFor(ActiveRuleChange.Type.ACTIVATED,ActiveRuleKey.of(XOO_P2_KEY,RuleTesting.XOO_X1)));
  dbSession.commit();
  assertThat(service.searchActivities(new QProfileActivityQuery(),new QueryContext()).getHits()).hasSize(2);
  List<QProfileActivity> result=service.searchActivities(new QProfileActivityQuery().setQprofileKeys(ImmutableSet.of(XOO_P1_KEY)),new QueryContext()).getHits();
  assertThat(result).hasSize(1);
  assertThat(service.searchActivities(new QProfileActivityQuery().setQprofileKeys(ImmutableSet.of(XOO_P1_KEY,XOO_P2_KEY)),new QueryContext()).getHits()).hasSize(2);
}
