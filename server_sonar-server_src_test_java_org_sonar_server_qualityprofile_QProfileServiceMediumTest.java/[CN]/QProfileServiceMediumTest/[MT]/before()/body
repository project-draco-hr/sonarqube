{
  tester.clearDbAndIndexes();
  db=tester.get(DbClient.class);
  dbSession=db.openSession(false);
  service=tester.get(QProfileService.class);
  loader=tester.get(QProfileLoader.class);
  activator=tester.get(RuleActivator.class);
  ruleIndexer=tester.get(RuleIndexer.class);
  activeRuleIndexer=tester.get(ActiveRuleIndexer.class);
  RuleDto xooRule1=RuleTesting.newXooX1().setSeverity("MINOR");
  db.ruleDao().insert(dbSession,xooRule1);
  db.qualityProfileDao().insert(dbSession,QProfileTesting.newXooP1(),QProfileTesting.newXooP2());
  dbSession.commit();
  dbSession.clearCache();
  ruleIndexer.index();
}
