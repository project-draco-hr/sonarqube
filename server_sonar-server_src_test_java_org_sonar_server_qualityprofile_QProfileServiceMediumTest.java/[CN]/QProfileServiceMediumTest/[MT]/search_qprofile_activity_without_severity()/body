{
  MockUserSession.set().setGlobalPermissions(GlobalPermissions.QUALITY_PROFILE_ADMIN).setLogin("me");
  RuleKey ruleKey=RuleKey.of("xoo","deleted_rule");
  tester.get(ActivityService.class).write(dbSession,Activity.Type.QPROFILE,ActiveRuleChange.createFor(ActiveRuleChange.Type.UPDATED,ActiveRuleKey.of(XOO_P1_KEY,ruleKey)).setParameter("max","10"));
  dbSession.commit();
  Result<QProfileActivity> activities=service.searchActivities(new QProfileActivityQuery(),new QueryOptions());
  assertThat(activities.getHits()).hasSize(1);
  QProfileActivity activity=activities.getHits().get(0);
  assertThat(activity.severity()).isNull();
  assertThat(activity.parameters()).hasSize(1);
  assertThat(activity.parameters().get("max")).isEqualTo("10");
}
