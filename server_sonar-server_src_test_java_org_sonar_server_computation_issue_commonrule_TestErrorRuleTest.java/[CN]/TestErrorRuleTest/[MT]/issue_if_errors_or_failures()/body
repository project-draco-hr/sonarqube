{
  activeRuleHolder.put(new ActiveRule(RULE_KEY,Severity.CRITICAL,Collections.<String,String>emptyMap()));
  measureRepository.addRawMeasure(FILE.getReportAttributes().getRef(),CoreMetrics.TEST_ERRORS_KEY,Measure.newMeasureBuilder().create(2));
  measureRepository.addRawMeasure(FILE.getReportAttributes().getRef(),CoreMetrics.TEST_FAILURES_KEY,Measure.newMeasureBuilder().create(1));
  DefaultIssue issue=underTest.processFile(FILE,"java");
  assertThat(issue.ruleKey()).isEqualTo(RULE_KEY);
  assertThat(issue.severity()).isEqualTo(Severity.CRITICAL);
  assertThat(issue.effortToFix()).isEqualTo(3.0);
  assertThat(issue.message()).isEqualTo("Fix failing unit tests on file \"FooTest.java\".");
}
