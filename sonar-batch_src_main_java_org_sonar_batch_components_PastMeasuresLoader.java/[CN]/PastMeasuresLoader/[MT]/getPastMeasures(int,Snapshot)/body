{
  String sql="select m.metric_id, m.characteristic_id, m.value from project_measures m, snapshots s" + " where m.snapshot_id=s.id and m.metric_id in (:metricIds) and m.rule_id is null and m.rule_priority is null " + " and (s.root_snapshot_id=:rootSnapshotId or s.id=:rootSnapshotId) and s.project_id=:resourceId and s.status=:status";
  return session.createNativeQuery(sql).setParameter("metricIds",metricByIds.keySet()).setParameter("rootSnapshotId",ObjectUtils.defaultIfNull(projectSnapshot.getRootId(),projectSnapshot.getId())).setParameter("resourceId",resourceId).setParameter("status",Snapshot.STATUS_PROCESSED).getResultList();
}
