{
  if (done) {
    throw new IllegalStateException("Plugin classloaders are already initialized");
  }
  try {
    ClassRealm base=world.getRealm(plugin.getBasePlugin());
    if (base == null) {
      LOG.warn("Plugin " + plugin.getKey() + " is ignored because base plugin is not installed: "+ plugin.getBasePlugin());
      return false;
    }
    base.createChildRealm(plugin.getKey());
    for (    File file : plugin.getDeployedFiles()) {
      base.addURL(file.toURI().toURL());
    }
    return true;
  }
 catch (  UnsupportedClassVersionError e) {
    throw new SonarException("The plugin " + plugin.getKey() + " is not supported with Java "+ SystemUtils.JAVA_VERSION_TRIMMED,e);
  }
catch (  Throwable e) {
    throw new SonarException("Fail to extend the plugin " + plugin.getBasePlugin() + " with "+ plugin.getKey(),e);
  }
}
