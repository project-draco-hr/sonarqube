{
  if (done) {
    throw new IllegalStateException("Plugin classloaders are already initialized");
  }
  try {
    ClassRealm base=world.getRealm(plugin.getBasePlugin());
    if (base == null) {
      LOG.warn(String.format("Plugin %s is ignored because base plugin is not installed: %s",plugin.getKey(),plugin.getBasePlugin()));
      return false;
    }
    base.createChildRealm(plugin.getKey());
    for (    File file : plugin.getDeployedFiles()) {
      base.addURL(file.toURI().toURL());
    }
    return true;
  }
 catch (  UnsupportedClassVersionError e) {
    throw new SonarException(String.format("The plugin %s is not supported with Java %s",plugin.getKey(),SystemUtils.JAVA_VERSION_TRIMMED),e);
  }
catch (  Exception e) {
    throw new SonarException(String.format("Fail to extend the plugin %s for %s",plugin.getBasePlugin(),plugin.getKey()),e);
  }
}
