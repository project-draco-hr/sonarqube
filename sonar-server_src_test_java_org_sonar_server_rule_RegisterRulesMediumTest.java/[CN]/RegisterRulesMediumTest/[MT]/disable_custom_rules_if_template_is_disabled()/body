{
  Rule templateRule=index.getByKey(RuleKey.of("xoo","template1"));
  RuleKey customRuleKey=tester.get(RuleCreator.class).create(NewRule.createForCustomRule("CUSTOM_RULE",templateRule.key()).setName("My custom").setHtmlDescription("Some description").setSeverity(Severity.MAJOR).setStatus(RuleStatus.READY));
  dbSession.commit();
  dbSession.clearCache();
  assertThat(index.getByKey(customRuleKey).status()).isEqualTo(RuleStatus.READY);
  rulesDefinition.includeTemplate1=false;
  tester.get(Platform.class).executeStartupTasks();
  assertThat(index.getByKey(customRuleKey).status()).isEqualTo(RuleStatus.REMOVED);
}
