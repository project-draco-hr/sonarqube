{
  userSession.checkLoggedIn();
  if (componentKey == null) {
    userSession.checkGlobalPermission(GlobalPermissions.SYSTEM_ADMIN);
  }
 else   if (!userSession.hasGlobalPermission(GlobalPermissions.SYSTEM_ADMIN) && !userSession.hasProjectPermission(UserRole.ADMIN,componentKey)) {
    throw new ForbiddenException("Insufficient privileges");
  }
}
