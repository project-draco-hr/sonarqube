{
  try {
    WebService.Action action=getAction(controllerPath,actionKey);
    request.setAction(action);
    verifyRequest(action,request);
    action.handler().handle(request,response);
  }
 catch (  IllegalArgumentException e) {
    sendError(400,e.getMessage(),response);
  }
catch (  BadRequestException e) {
    if (StringUtils.isBlank(e.getMessage())) {
      sendError(e,response);
    }
 else {
      sendError(e.httpCode(),e.getMessage(),response);
    }
  }
catch (  ServerException e) {
    sendError(e.httpCode(),e.getMessage(),response);
  }
catch (  Exception e) {
    LoggerFactory.getLogger(getClass()).error("Fail to process request " + request,e);
    sendError(500,e.getMessage(),response);
  }
}
