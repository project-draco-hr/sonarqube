{
  try {
    WebService.Action action=getAction(controllerPath,actionKey);
    request.setAction(action);
    verifyRequest(action,request);
    action.handler().handle(request,response);
  }
 catch (  IllegalArgumentException e) {
    sendError(400,e.getMessage(),response);
  }
catch (  BadRequestException e) {
    sendError(e,response);
  }
catch (  ServerException e) {
    sendError(e.httpCode(),message(e.getMessage(),e.l10nKey(),e.l10nParams()),response);
  }
catch (  Exception e) {
    LoggerFactory.getLogger(getClass()).error("Fail to process request " + request,e);
    sendError(500,e.getMessage(),response);
  }
}
