{
  MockUserSession.set().addComponentPermission(UserRole.CODEVIEWER,PROJECT_KEY,COMPONENT_KEY);
  addComponent();
  when(views.getPages(anyString(),anyString(),anyString(),anyString(),any(String[].class))).thenReturn(newArrayList(new ViewProxy<Page>(new MyExtensionWithRole())));
  WsTester.TestRequest request=tester.newGetRequest("api/components","app").setParam("key",COMPONENT_KEY);
  request.execute().assertJson(getClass(),"app_with_extension_having_permission.json");
}
