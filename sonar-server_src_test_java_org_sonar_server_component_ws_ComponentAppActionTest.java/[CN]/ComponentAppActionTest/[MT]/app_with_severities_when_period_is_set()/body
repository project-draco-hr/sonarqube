{
  MockUserSession.set().addComponentPermission(UserRole.USER,SUB_PROJECT_KEY,COMPONENT_KEY);
  addComponent();
  addPeriod();
  Multiset<String> severities=HashMultiset.create();
  severities.add("MAJOR",5);
  when(issueService.findSeveritiesByComponent(eq(COMPONENT_KEY),any(Date.class),eq(session))).thenReturn(severities);
  when(i18n.message(any(Locale.class),eq("severity.MAJOR"),isNull(String.class))).thenReturn("Major");
  WsTester.TestRequest request=tester.newGetRequest("api/components","app").setParam("key",COMPONENT_KEY).setParam("period","1");
  request.execute().assertJson(getClass(),"app_with_severities_when_period_is_set.json");
}
