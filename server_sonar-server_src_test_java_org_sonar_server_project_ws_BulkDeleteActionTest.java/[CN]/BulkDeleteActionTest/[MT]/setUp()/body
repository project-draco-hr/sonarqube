{
  resourceType=mock(ResourceType.class);
  when(resourceType.getBooleanProperty(anyString())).thenReturn(true);
  ResourceTypes mockResourceTypes=mock(ResourceTypes.class);
  when(mockResourceTypes.get(anyString())).thenReturn(resourceType);
  ws=new WsTester(new ProjectsWs(new BulkDeleteAction(new ComponentCleanerService(dbClient,new IssueAuthorizationIndexer(dbClient,es.client()),new IssueIndexer(dbClient,es.client()),new TestIndexer(dbClient,es.client()),mockResourceTypes,new ComponentFinder(dbClient)),dbClient,userSessionRule)));
  userSessionRule.setGlobalPermissions(GlobalPermissions.SYSTEM_ADMIN);
  db.truncateTables();
  es.truncateIndices();
}
