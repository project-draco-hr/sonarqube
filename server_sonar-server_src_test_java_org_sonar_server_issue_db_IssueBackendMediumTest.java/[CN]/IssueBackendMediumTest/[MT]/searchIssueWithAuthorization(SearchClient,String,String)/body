{
  BoolFilterBuilder permissionFilter=FilterBuilders.boolFilter();
  OrFilterBuilder or=FilterBuilders.orFilter(FilterBuilders.termFilter("users",user));
  for (  String group : groups) {
    or.add(FilterBuilders.termFilter("groups",group));
  }
  permissionFilter.must(FilterBuilders.termFilter("permission","read"),or).cache(true);
  SearchRequestBuilder request=searchClient.prepareSearch(IndexDefinition.ISSUES.getIndexName()).setTypes(IndexDefinition.ISSUES.getIndexType()).setQuery(QueryBuilders.filteredQuery(QueryBuilders.matchAllQuery(),FilterBuilders.hasParentFilter(IndexDefinition.ISSUES_AUTHORIZATION.getIndexType(),QueryBuilders.filteredQuery(QueryBuilders.matchAllQuery(),permissionFilter)))).setSize(Integer.MAX_VALUE);
  return searchClient.execute(request);
}
