{
  Map<String,Object> permissionSource=newHashMap();
  permissionSource.put("_parent",project.key());
  permissionSource.put("permission","read");
  permissionSource.put("project",project.key());
  if (user != null) {
    permissionSource.put("user",user);
  }
  if (group != null) {
    permissionSource.put("group",group);
  }
  IndexRequestBuilder permissionRequestBuilder=searchClient.prepareIndex(IndexDefinition.ISSUES_PERMISSION.getIndexName(),IndexDefinition.ISSUES_PERMISSION.getIndexType()).setSource(permissionSource);
  if (bulkRequestBuilder != null) {
    bulkRequestBuilder.add(permissionRequestBuilder);
  }
 else {
    permissionRequestBuilder.setRefresh(true).get();
  }
  Map<String,Object> projectSource=newHashMap();
  projectSource.put("key",project.key());
  IndexRequestBuilder projectRequestBuilder=searchClient.prepareIndex(IndexDefinition.ISSUES_PROJECT.getIndexName(),IndexDefinition.ISSUES_PROJECT.getIndexType()).setId(project.key()).setSource(projectSource);
  if (bulkRequestBuilder != null) {
    bulkRequestBuilder.add(projectRequestBuilder);
  }
 else {
    projectRequestBuilder.setRefresh(true).get();
  }
}
