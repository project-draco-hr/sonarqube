{
  try {
    new WebService(){
      @Override public void define(      Context context){
        NewController controller=context.newController("api/rule");
        NewAction action=controller.newAction("create").setHandler(mock(RequestHandler.class));
        action.newParam("key");
        action.newParam("key");
        controller.done();
      }
    }
.define(context);
    fail();
  }
 catch (  IllegalStateException e) {
    assertThat(e).hasMessage("The parameter 'key' is defined multiple times in the action 'create'");
  }
}
