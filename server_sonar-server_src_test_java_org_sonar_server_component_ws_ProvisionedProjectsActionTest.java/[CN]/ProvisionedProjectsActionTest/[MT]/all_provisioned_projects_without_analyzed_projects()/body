{
  userSessionRule.setGlobalPermissions(UserRole.ADMIN);
  ComponentDto analyzedProject=ComponentTesting.newProjectDto("analyzed-uuid-1");
  componentDao.insert(dbSession,newProvisionedProject("1"),newProvisionedProject("2"));
  analyzedProject=componentDao.insert(dbSession,analyzedProject);
  SnapshotDto snapshot=SnapshotTesting.createForProject(analyzedProject);
  dbClient.snapshotDao().insert(dbSession,snapshot);
  dbSession.commit();
  WsTester.TestRequest request=ws.newGetRequest("api/projects","provisioned");
  request.execute().assertJson(getClass(),"all-projects.json");
}
