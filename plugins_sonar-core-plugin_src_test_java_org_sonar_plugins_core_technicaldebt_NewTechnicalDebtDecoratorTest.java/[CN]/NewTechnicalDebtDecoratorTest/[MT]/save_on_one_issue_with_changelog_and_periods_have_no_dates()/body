{
  when(timeMachineConfiguration.periods()).thenReturn(newArrayList(new Period(1,null,null),new Period(2,null,null)));
  Issue issue=new DefaultIssue().setKey("A").setCreationDate(fiveDaysAgo).setTechnicalDebt(fiveDaysDebt).setChanges(newArrayList(new FieldDiffs().setDiff("technicalDebt",null,fromWorkDayDuration(fiveDaysDebt)).setCreatedAt(rightNow),new FieldDiffs().setDiff("technicalDebt",fromWorkDayDuration(oneDaysDebt),null).setCreatedAt(fourDaysAgo),new FieldDiffs().setDiff("technicalDebt",null,fromWorkDayDuration(oneDaysDebt)).setCreatedAt(nineDaysAgo)));
  when(issuable.issues()).thenReturn(newArrayList(issue));
  decorator.decorate(resource,context);
  verify(context).saveMeasure(argThat(new IsVariationMeasure(CoreMetrics.NEW_TECHNICAL_DEBT,4.0,4.0)));
}
