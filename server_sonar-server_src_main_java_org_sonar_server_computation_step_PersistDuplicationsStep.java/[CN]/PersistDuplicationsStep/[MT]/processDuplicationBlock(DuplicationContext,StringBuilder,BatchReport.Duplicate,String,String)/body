{
  if (duplicate.hasOtherFileKey()) {
    String crossProjectComponentKey=duplicate.getOtherFileKey();
    appendDuplication(xml,crossProjectComponentKey,duplicate);
  }
 else {
    String branch=duplicationContext.context().getReportMetadata().getBranch();
    if (duplicate.hasOtherFileRef()) {
      BatchReport.Component duplicationComponent=duplicationContext.context().getReportReader().readComponent(duplicate.getOtherFileRef());
      appendDuplication(xml,ComponentKeys.createKey(parentComponentKey,duplicationComponent.getPath(),branch),duplicate);
    }
 else {
      appendDuplication(xml,ComponentKeys.createKey(parentComponentKey,componentPath,branch),duplicate);
    }
  }
}
