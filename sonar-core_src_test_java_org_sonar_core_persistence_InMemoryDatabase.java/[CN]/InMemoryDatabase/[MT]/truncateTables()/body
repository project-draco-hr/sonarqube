{
  Connection connection=null;
  try {
    connection=datasource.getConnection();
    DatabaseMetaData meta=connection.getMetaData();
    Statement statement=connection.createStatement();
    ResultSet res=meta.getTables(null,null,null,new String[]{"TABLE"});
    while (res.next()) {
      String tableName=res.getString("TABLE_NAME");
      statement.executeUpdate("TRUNCATE TABLE " + tableName);
    }
    res.close();
    res=meta.getColumns(null,null,null,"ID");
    while (res.next()) {
      String tableName=res.getString("TABLE_NAME");
      statement.executeUpdate("ALTER TABLE " + tableName + " ALTER COLUMN ID RESTART WITH 1");
    }
    res.close();
    statement.close();
  }
 catch (  SQLException e) {
    throw new IllegalStateException("Fail to truncate tables",e);
  }
 finally {
    closeQuietly(connection);
  }
}
