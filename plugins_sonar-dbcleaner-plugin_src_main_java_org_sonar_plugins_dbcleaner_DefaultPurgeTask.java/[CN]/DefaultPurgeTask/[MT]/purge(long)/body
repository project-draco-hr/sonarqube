{
  long start=System.currentTimeMillis();
  profiler.reset();
  cleanHistoricalData(resourceId);
  doPurge(resourceId);
  if (settings.getBoolean(CoreProperties.PROFILING_LOG_PROPERTY)) {
    long duration=System.currentTimeMillis() - start;
    System.out.println("\n -------- Profiling for purge: " + TimeUtils.formatDuration(duration) + " --------\n");
    profiler.dump(duration);
    System.out.println("\n -------- End of profiling for purge --------\n");
  }
  return this;
}
