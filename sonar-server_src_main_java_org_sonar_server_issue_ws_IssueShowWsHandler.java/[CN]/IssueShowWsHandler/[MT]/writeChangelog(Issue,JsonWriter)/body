{
  json.name("changelog").beginArray();
  IssueChangelog changelog=issueChangelogService.changelog(issue);
  for (  FieldDiffs diffs : changelog.changes()) {
    String userLogin=diffs.userLogin();
    json.beginObject().prop("userLogin",userLogin).prop("userName",userLogin != null ? changelog.user(diffs).name() : null).prop("creationDate",DateUtils.formatDateTime(diffs.creationDate()));
    json.name("diffs").beginArray();
    for (    Map.Entry<String,FieldDiffs.Diff> entry : diffs.diffs().entrySet()) {
      FieldDiffs.Diff diff=entry.getValue();
      json.beginObject().prop("key",entry.getKey()).prop("newValue",(String)diff.newValue()).prop("oldValue",(String)diff.oldValue()).endObject();
    }
    json.endArray();
    json.endObject();
  }
  json.endArray();
}
