{
  fileSystem=mock(ServerFileSystem.class);
  File tempHome=TestUtils.getTestTempDir(getClass(),"sonarHome");
  when(fileSystem.getHomeDir()).thenReturn(tempHome);
  File tempES=new File(tempHome,"data/es");
  tempES.mkdirs();
  settings=mock(Settings.class);
  settingsBuilder=mock(ImmutableSettings.Builder.class);
  when(settingsBuilder.put(anyString(),anyString())).thenReturn(settingsBuilder);
  when(settingsBuilder.put(anyString(),anyInt())).thenReturn(settingsBuilder);
  nodeBuilder=mock(NodeBuilder.class);
  when(nodeBuilder.local(anyBoolean())).thenReturn(nodeBuilder);
  when(nodeBuilder.clusterName(anyString())).thenReturn(nodeBuilder);
  when(nodeBuilder.data(anyBoolean())).thenReturn(nodeBuilder);
  when(nodeBuilder.settings(settingsBuilder)).thenReturn(nodeBuilder);
  searchNode=new SearchNode(fileSystem,settings,settingsBuilder,nodeBuilder);
}
