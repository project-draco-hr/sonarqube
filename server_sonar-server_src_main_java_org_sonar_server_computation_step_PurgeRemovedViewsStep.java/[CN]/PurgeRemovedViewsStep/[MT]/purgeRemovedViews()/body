{
  DbSession session=dbClient.openSession(false);
  try {
    Set<String> viewUuidsInIndex=newHashSet(index.findAllViewUuids());
    Set<String> viewUuidInDb=newHashSet(dbClient.componentDao().selectUuidsByUuids(session,viewUuidsInIndex));
    Set<String> viewsToRemove=Sets.difference(viewUuidsInIndex,viewUuidInDb);
    index.delete(viewsToRemove);
  }
  finally {
    session.close();
  }
}
