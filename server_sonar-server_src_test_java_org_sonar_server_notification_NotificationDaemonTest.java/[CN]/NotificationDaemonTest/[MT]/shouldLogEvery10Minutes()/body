{
  setUpMocks();
  when(manager.getFromQueue()).thenReturn(notification).thenReturn(notification).thenReturn(null);
  when(manager.count()).thenReturn(1L).thenReturn(0L);
  underTest=spy(underTest);
  when(underTest.now()).thenReturn(0L).thenReturn(10 * 60 * 1000 + 1L).thenReturn(20 * 60 * 1000 + 2L);
  underTest.start();
  verify(underTest,timeout(200)).log(1,1,10);
  verify(underTest,timeout(200)).log(2,0,20);
  underTest.stop();
}
