{
  System.setProperty("org.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH","true");
  System.setProperty("org.apache.catalina.startup.EXIT_ON_INIT_FAILURE","true");
  tomcat=new Tomcat();
  String basedir=tomcatBasedir().getAbsolutePath();
  tomcat.setBaseDir(basedir);
  tomcat.getHost().setAppBase(basedir);
  tomcat.getHost().setAutoDeploy(false);
  tomcat.getHost().setCreateDirs(false);
  tomcat.getHost().setDeployOnStartup(true);
  Logging.configure(tomcat,props);
  Connectors.configure(tomcat,props);
  webappContext=Webapp.configure(tomcat,props);
  try {
    tomcat.start();
    new StartupLogs(LoggerFactory.getLogger(getClass())).log(tomcat);
  }
 catch (  LifecycleException e) {
    Throwables.propagate(e);
  }
}
