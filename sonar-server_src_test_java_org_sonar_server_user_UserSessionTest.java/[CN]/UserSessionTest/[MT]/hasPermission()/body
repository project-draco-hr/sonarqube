{
  AuthorizationDao authorizationDao=mock(AuthorizationDao.class);
  UserSession session=new SpyUserSession("marius",authorizationDao);
  when(authorizationDao.selectGlobalPermissions("marius")).thenReturn(Arrays.asList("profileadmin","admin"));
  assertThat(session.hasGlobalPermission(GlobalPermission.QUALITY_PROFILE_ADMIN)).isTrue();
  assertThat(session.hasGlobalPermission(GlobalPermission.SYSTEM_ADMIN)).isTrue();
  assertThat(session.hasGlobalPermission(GlobalPermission.DASHBOARD_SHARING)).isFalse();
}
