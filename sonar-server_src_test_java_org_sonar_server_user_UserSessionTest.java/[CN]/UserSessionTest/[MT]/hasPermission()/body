{
  AuthorizationDao authorizationDao=mock(AuthorizationDao.class);
  UserSession session=new SpyUserSession("marius",authorizationDao);
  when(authorizationDao.selectGlobalPermissions("marius")).thenReturn(Arrays.asList("shareIssueFilter","admin"));
  assertThat(session.hasPermission("shareIssueFilter")).isTrue();
  assertThat(session.hasPermission("admin")).isTrue();
  assertThat(session.hasPermission("shareDashboard")).isFalse();
}
