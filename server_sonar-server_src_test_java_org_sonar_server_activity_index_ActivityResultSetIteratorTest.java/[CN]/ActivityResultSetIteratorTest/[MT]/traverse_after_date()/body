{
  dbTester.prepareDbUnit(getClass(),"traverse.xml");
  ActivityResultSetIterator it=ActivityResultSetIterator.create(dbTester.getDbClient(),dbTester.getSession(),DateUtils.parseDate("2014-12-01").getTime());
  assertThat(it.hasNext()).isTrue();
  UpdateRequest request=it.next();
  assertThat(request).isNotNull();
  Map<String,Object> doc=request.doc().sourceAsMap();
  assertThat(doc.get(ActivityIndexDefinition.FIELD_KEY)).isEqualTo("UUID2");
  assertThat(it.hasNext()).isFalse();
  it.close();
  assertThat(formatLongDate(it.getMaxRowDate())).startsWith("2015-01-01");
}
