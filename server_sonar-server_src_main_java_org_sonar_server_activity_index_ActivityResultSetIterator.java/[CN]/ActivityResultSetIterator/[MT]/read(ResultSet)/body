{
  ByteArrayOutputStream bytes=new ByteArrayOutputStream();
  JsonWriter writer=JsonWriter.of(new OutputStreamWriter(bytes,StandardCharsets.UTF_8)).setSerializeNulls(true);
  writer.beginObject();
  String key=rs.getString(1);
  writer.prop(ActivityIndexDefinition.FIELD_KEY,key);
  writer.prop(ActivityIndexDefinition.FIELD_ACTION,rs.getString(2));
  writer.prop(ActivityIndexDefinition.FIELD_MESSAGE,rs.getString(3));
  writer.name(ActivityIndexDefinition.FIELD_DETAILS).valueObject(KeyValueFormat.parse(rs.getString(4)));
  writer.prop(ActivityIndexDefinition.FIELD_LOGIN,rs.getString(5));
  writer.prop(ActivityIndexDefinition.FIELD_TYPE,rs.getString(6));
  Date createdAt=rs.getTimestamp(7);
  writer.prop(ActivityIndexDefinition.FIELD_CREATED_AT,EsUtils.formatDateTime(createdAt));
  writer.endObject().close();
  byte[] jsonDoc=bytes.toByteArray();
  dates.add(createdAt);
  return new UpdateRequest(ActivityIndexDefinition.INDEX,ActivityIndexDefinition.TYPE,key).doc(jsonDoc).upsert(jsonDoc);
}
