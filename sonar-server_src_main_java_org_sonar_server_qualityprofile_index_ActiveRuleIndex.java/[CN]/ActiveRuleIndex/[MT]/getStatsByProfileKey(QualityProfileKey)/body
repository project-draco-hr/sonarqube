{
  SearchResponse response=getClient().prepareSearch(this.getIndexName()).setQuery(QueryBuilders.filteredQuery(QueryBuilders.matchAllQuery(),FilterBuilders.termsFilter(ActiveRuleNormalizer.ActiveRuleField.PROFILE_KEY.field(),key.toString()))).addAggregation(AggregationBuilders.terms(ActiveRuleNormalizer.ActiveRuleField.PROFILE_KEY.field()).field(ActiveRuleNormalizer.ActiveRuleField.PROFILE_KEY.field()).subAggregation(AggregationBuilders.terms(ActiveRuleNormalizer.ActiveRuleField.INHERITANCE.field()).field(ActiveRuleNormalizer.ActiveRuleField.INHERITANCE.field()).subAggregation(AggregationBuilders.terms(ActiveRuleNormalizer.ActiveRuleField.SEVERITY.field()).field(ActiveRuleNormalizer.ActiveRuleField.SEVERITY.field())))).addAggregation(AggregationBuilders.terms(ActiveRuleNormalizer.ActiveRuleField.INHERITANCE.field()).field(ActiveRuleNormalizer.ActiveRuleField.INHERITANCE.field())).addAggregation(AggregationBuilders.terms(ActiveRuleNormalizer.ActiveRuleField.SEVERITY.field()).field(ActiveRuleNormalizer.ActiveRuleField.SEVERITY.field())).setSize(0).setTypes(this.getIndexType()).get();
  return this.processAggregations(response.getAggregations());
}
