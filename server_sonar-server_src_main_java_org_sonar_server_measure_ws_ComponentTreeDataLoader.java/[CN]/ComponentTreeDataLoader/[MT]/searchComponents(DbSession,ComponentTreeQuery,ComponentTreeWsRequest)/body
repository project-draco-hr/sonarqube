{
  if (dbQuery.getQualifiers() != null && dbQuery.getQualifiers().isEmpty()) {
    return new ComponentDtosAndTotal(Collections.<ComponentDtoWithSnapshotId>emptyList(),0);
  }
  String strategy=requireNonNull(wsRequest.getStrategy());
switch (strategy) {
case CHILDREN_STRATEGY:
    return new ComponentDtosAndTotal(dbClient.componentDao().selectDirectChildren(dbSession,dbQuery),dbClient.componentDao().countDirectChildren(dbSession,dbQuery));
case LEAVES_STRATEGY:
case ALL_STRATEGY:
  return new ComponentDtosAndTotal(dbClient.componentDao().selectAllChildren(dbSession,dbQuery),dbClient.componentDao().countAllChildren(dbSession,dbQuery));
default :
throw new IllegalStateException("Unknown component tree strategy");
}
}
