{
  DbSession dbSession=db.openSession(false);
  try {
    List<ActiveRuleChange> changes=activate(dbSession,activation);
    if (!changes.isEmpty()) {
      log.write(dbSession,changes);
      dbSession.commit();
      previewCache.reportGlobalModification();
    }
    return changes;
  }
  finally {
    dbSession.close();
  }
}
