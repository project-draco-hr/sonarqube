{
  ActiveRuleDto activeRule;
  ActiveRuleDao dao=db.activeRuleDao();
  activeRule=ActiveRuleDto.createFor(context.profile(),context.rule());
  activeRule.setSeverity(change.getSeverity());
  if (change.getInheritance() != null) {
    activeRule.setInheritance(change.getInheritance().name());
  }
  dao.insert(dbSession,activeRule);
  for (  Map.Entry<String,String> param : change.getParameters().entrySet()) {
    if (param.getValue() != null) {
      ActiveRuleParamDto paramDto=ActiveRuleParamDto.createFor(context.ruleParamsByKeys().get(param.getKey()));
      paramDto.setValue(param.getValue());
      dao.addParam(dbSession,activeRule,paramDto);
    }
  }
  return activeRule;
}
