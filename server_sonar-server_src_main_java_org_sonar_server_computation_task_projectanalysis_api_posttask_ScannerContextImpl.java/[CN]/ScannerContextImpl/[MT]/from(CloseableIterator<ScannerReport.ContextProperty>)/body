{
  try {
    ImmutableMap.Builder<String,String> mapBuilder=ImmutableMap.builder();
    while (it.hasNext()) {
      ScannerReport.ContextProperty prop=it.next();
      mapBuilder.put(prop.getKey(),prop.getValue());
    }
    return new ScannerContextImpl(mapBuilder.build());
  }
  finally {
    it.close();
  }
}
