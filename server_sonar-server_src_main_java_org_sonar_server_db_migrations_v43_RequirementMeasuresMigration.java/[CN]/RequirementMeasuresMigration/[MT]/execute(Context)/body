{
  MassUpdate massUpdate=context.prepareMassUpdate();
  massUpdate.select("SELECT project_measures.id,characteristics.rule_id FROM project_measures " + "INNER JOIN characteristics ON characteristics.id = project_measures.characteristic_id " + "WHERE characteristics.rule_id IS NOT NULL");
  massUpdate.update("UPDATE project_measures SET characteristic_id=null,rule_id=? WHERE id=?");
  massUpdate.execute(new MassUpdate.Handler(){
    @Override public boolean handle(    Select.Row row,    SqlStatement update) throws SQLException {
      Long id=row.getNullableLong(1);
      Long ruleId=row.getNullableLong(2);
      update.setLong(1,ruleId);
      update.setLong(2,id);
      return true;
    }
  }
);
}
