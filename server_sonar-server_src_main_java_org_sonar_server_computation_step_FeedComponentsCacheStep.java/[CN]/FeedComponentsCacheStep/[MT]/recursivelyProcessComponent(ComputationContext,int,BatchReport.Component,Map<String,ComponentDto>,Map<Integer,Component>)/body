{
  BatchReportReader reportReader=context.getReportReader();
  BatchReport.Component reportComponent=reportReader.readComponent(componentRef);
  String componentKey=ComponentKeys.createKey(nearestModule.getKey(),reportComponent.getPath(),context.getReportMetadata().getBranch());
  Component component=new Component().setKey(componentKey);
  ComponentDto componentDto=componentDtosByKey.get(componentKey);
  if (componentDto == null) {
    component.setUuid(Uuids.create());
  }
 else {
    component.setId(component.getId());
    component.setKey(componentKey);
  }
  for (  Integer childRef : reportComponent.getChildRefList()) {
    BatchReport.Component nextNearestModule=!reportComponent.getType().equals(Constants.ComponentType.PROJECT) && !reportComponent.getType().equals(Constants.ComponentType.MODULE) ? nearestModule : reportComponent;
    recursivelyProcessComponent(context,childRef,nextNearestModule,componentDtosByKey,componentsByRef);
  }
}
