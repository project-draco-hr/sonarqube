{
  String projectUuid=wsRequest.param(PARAM_PROJECT_UUID);
  String projectKey=wsRequest.param(PARAM_PROJECT_KEY);
  boolean isProjectUuidNonNull=projectUuid != null;
  boolean isProjectKeyNonNull=projectKey != null;
  if (isProjectUuidNonNull || isProjectKeyNonNull) {
    checkRequest(projectUuid != null ^ projectKey != null,"Project id or project key can be provided, not both.");
  }
  userSession.checkLoggedIn();
  if (userSession.hasGlobalPermission(GlobalPermissions.SYSTEM_ADMIN)) {
    return;
  }
  if (isProjectUuidNonNull) {
    userSession.checkProjectUuidPermission(UserRole.ADMIN,projectUuid);
    return;
  }
  if (isProjectKeyNonNull) {
    userSession.checkProjectPermission(UserRole.ADMIN,projectKey);
    return;
  }
  userSession.checkGlobalPermission(GlobalPermissions.SYSTEM_ADMIN);
}
