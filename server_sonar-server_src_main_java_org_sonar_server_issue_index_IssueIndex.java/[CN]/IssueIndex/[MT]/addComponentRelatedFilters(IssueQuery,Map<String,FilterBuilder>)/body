{
  Collection<String> componentUuids=query.componentUuids();
  if (BooleanUtils.isTrue(query.onComponentOnly())) {
    Set<String> allComponents=Sets.newHashSet();
    allComponents.addAll(query.projectUuids());
    allComponents.addAll(query.moduleUuids());
    allComponents.addAll(componentUuids);
    filters.put(IssueIndexDefinition.FIELD_ISSUE_COMPONENT_UUID,matchFilter(IssueIndexDefinition.FIELD_ISSUE_COMPONENT_UUID,allComponents));
  }
 else {
    filters.put(IssueIndexDefinition.FIELD_ISSUE_PROJECT_UUID,matchFilter(IssueIndexDefinition.FIELD_ISSUE_PROJECT_UUID,query.projectUuids()));
    filters.put(IssueIndexDefinition.FIELD_ISSUE_MODULE_UUID,matchFilter(IssueIndexDefinition.FIELD_ISSUE_MODULE_UUID,query.moduleUuids()));
    FilterBuilder compositeFilter=componentFilter(componentUuids);
    filters.put(IssueIndexDefinition.FIELD_ISSUE_COMPONENT_UUID,compositeFilter);
    filters.put(IssueIndexDefinition.FIELD_ISSUE_DIRECTORY_PATH,matchFilter(IssueIndexDefinition.FIELD_ISSUE_DIRECTORY_PATH,query.directories()));
  }
}
