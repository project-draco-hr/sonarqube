{
  FilterBuilder viewFilter=createViewFilter(query.viewUuids());
  FilterBuilder componentFilter=createTermsFilter(IssueIndexDefinition.FIELD_ISSUE_COMPONENT_UUID,query.componentUuids());
  FilterBuilder projectFilter=createTermsFilter(IssueIndexDefinition.FIELD_ISSUE_PROJECT_UUID,query.projectUuids());
  FilterBuilder moduleRootFilter=createModuleRootFilter(query.moduleRootUuids());
  FilterBuilder moduleFilter=createTermsFilter(IssueIndexDefinition.FIELD_ISSUE_MODULE_UUID,query.moduleUuids());
  FilterBuilder directoryRootFilter=createDirectoryRootFilter(query.moduleUuids(),query.directories());
  FilterBuilder directoryFilter=createTermsFilter(IssueIndexDefinition.FIELD_ISSUE_DIRECTORY_PATH,query.directories());
  FilterBuilder fileFilter=createTermsFilter(IssueIndexDefinition.FIELD_ISSUE_COMPONENT_UUID,query.fileUuids());
  if (query.onComponentOnly()) {
    filters.put(IssueIndexDefinition.FIELD_ISSUE_COMPONENT_UUID,componentFilter);
  }
 else {
    filters.put("__view",viewFilter);
    filters.put(IssueIndexDefinition.FIELD_ISSUE_PROJECT_UUID,projectFilter);
    filters.put("__module",moduleRootFilter);
    filters.put(IssueIndexDefinition.FIELD_ISSUE_MODULE_UUID,moduleFilter);
    filters.put(IssueIndexDefinition.FIELD_ISSUE_DIRECTORY_PATH,directoryFilter);
    if (fileFilter != null) {
      filters.put(IssueIndexDefinition.FIELD_ISSUE_COMPONENT_UUID,fileFilter);
    }
 else {
      filters.put(IssueIndexDefinition.FIELD_ISSUE_COMPONENT_UUID,componentFilter);
    }
  }
}
