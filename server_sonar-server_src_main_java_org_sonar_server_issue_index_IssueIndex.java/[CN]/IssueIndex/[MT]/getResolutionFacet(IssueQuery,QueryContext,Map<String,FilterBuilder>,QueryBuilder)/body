{
  String fieldName=IssueNormalizer.IssueField.RESOLUTION.field();
  String facetName=IssueFilterParameters.RESOLUTIONS;
  Map<String,FilterBuilder> resolutionFilters=Maps.newHashMap(filters);
  resolutionFilters.remove("__isResolved");
  resolutionFilters.remove(fieldName);
  StickyFacetBuilder assigneeFacetBuilder=new StickyFacetBuilder(esQuery,resolutionFilters);
  BoolFilterBuilder facetFilter=assigneeFacetBuilder.getStickyFacetFilter(fieldName);
  FilterAggregationBuilder facetTopAggregation=assigneeFacetBuilder.buildTopFacetAggregation(fieldName,facetName,facetFilter,DEFAULT_ISSUE_FACET_SIZE,0);
  facetTopAggregation=assigneeFacetBuilder.addSelectedItemsToFacet(fieldName,facetName,facetTopAggregation,query.resolutions().toArray());
  facetTopAggregation.subAggregation(AggregationBuilders.missing(facetName + "_missing").field(fieldName));
  return AggregationBuilders.global(facetName).subAggregation(facetTopAggregation);
}
