{
  if (checkAuthorization) {
    OrFilterBuilder groupsAndUser=FilterBuilders.orFilter();
    if (userLogin != null) {
      groupsAndUser.add(FilterBuilders.termFilter(IssueIndexDefinition.FIELD_AUTHORIZATION_USERS,userLogin));
    }
    for (    String group : userGroups) {
      groupsAndUser.add(FilterBuilders.termFilter(IssueIndexDefinition.FIELD_AUTHORIZATION_GROUPS,group));
    }
    return FilterBuilders.hasParentFilter(IssueIndexDefinition.TYPE_AUTHORIZATION,QueryBuilders.filteredQuery(QueryBuilders.matchAllQuery(),FilterBuilders.boolFilter().must(groupsAndUser).cache(true)));
  }
 else {
    return FilterBuilders.matchAllFilter();
  }
}
