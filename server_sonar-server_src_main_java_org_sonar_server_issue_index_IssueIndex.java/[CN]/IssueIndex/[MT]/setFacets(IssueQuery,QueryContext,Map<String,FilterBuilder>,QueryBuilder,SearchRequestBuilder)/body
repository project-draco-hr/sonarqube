{
  if (options.isFacet()) {
    StickyFacetBuilder stickyFacetBuilder=stickyFacetBuilder(esQuery,filters);
    addSimpleStickyFacetIfNeeded(options,stickyFacetBuilder,esSearch,IssueFilterParameters.SEVERITIES,IssueNormalizer.IssueField.SEVERITY.field(),Severity.ALL.toArray());
    addSimpleStickyFacetIfNeeded(options,stickyFacetBuilder,esSearch,IssueFilterParameters.STATUSES,IssueNormalizer.IssueField.STATUS.field(),Issue.STATUSES.toArray());
    addSimpleStickyFacetIfNeeded(options,stickyFacetBuilder,esSearch,IssueFilterParameters.COMPONENT_UUIDS,IssueNormalizer.IssueField.COMPONENT.field(),query.componentUuids().toArray());
    addSimpleStickyFacetIfNeeded(options,stickyFacetBuilder,esSearch,IssueFilterParameters.PROJECT_UUIDS,IssueNormalizer.IssueField.PROJECT.field(),query.projectUuids().toArray());
    addSimpleStickyFacetIfNeeded(options,stickyFacetBuilder,esSearch,IssueFilterParameters.LANGUAGES,IssueNormalizer.IssueField.LANGUAGE.field(),query.languages().toArray());
    addSimpleStickyFacetIfNeeded(options,stickyFacetBuilder,esSearch,IssueFilterParameters.RULES,IssueNormalizer.IssueField.RULE_KEY.field(),query.rules().toArray());
    addSimpleStickyFacetIfNeeded(options,stickyFacetBuilder,esSearch,IssueFilterParameters.REPORTERS,IssueNormalizer.IssueField.REPORTER.field());
    if (options.facets().contains(IssueFilterParameters.TAGS)) {
      esSearch.addAggregation(stickyFacetBuilder.buildStickyFacet(IssueNormalizer.IssueField.TAGS.field(),IssueFilterParameters.TAGS,TAGS_FACET_SIZE,query.tags().toArray()));
    }
    if (options.facets().contains(IssueFilterParameters.RESOLUTIONS)) {
      esSearch.addAggregation(getResolutionFacet(filters,esQuery));
    }
    if (options.facets().contains(IssueFilterParameters.ASSIGNEES)) {
      esSearch.addAggregation(getAssigneesFacet(query,filters,esQuery));
    }
    if (options.facets().contains(IssueFilterParameters.ACTION_PLANS)) {
      esSearch.addAggregation(getActionPlansFacet(query,filters,esQuery));
    }
  }
}
