{
  SearchRequestBuilder esSearch=getClient().prepareSearch(this.getIndexName()).setTypes(this.getIndexType()).setIndices(this.getIndexName());
  if (options.isScroll()) {
    esSearch.setSearchType(SearchType.SCAN);
    esSearch.setScroll(TimeValue.timeValueMinutes(3));
  }
  setFacets(options,esSearch);
  setSorting(query,esSearch);
  setPagination(options,esSearch);
  QueryBuilder esQuery=QueryBuilders.matchAllQuery();
  BoolFilterBuilder esFilter=getFilter(query,options);
  if (esFilter.hasClauses()) {
    esSearch.setQuery(QueryBuilders.filteredQuery(esQuery,esFilter));
  }
 else {
    esSearch.setQuery(esQuery);
  }
  SearchResponse response=getClient().execute(esSearch);
  return new Result<Issue>(this,response);
}
