{
  DbSession dbSession=dbClient.openSession(false);
  try {
    Optional<CeQueueDto> queueDto=dbClient.ceQueueDao().selectByUuid(dbSession,taskUuid);
    if (queueDto.isPresent()) {
      if (!queueDto.get().getStatus().equals(CeQueueDto.Status.PENDING)) {
        throw new IllegalStateException(String.format("Task is in progress and can't be cancelled [uuid=%s]",taskUuid));
      }
      cancel(dbSession,queueDto.get());
      return true;
    }
    return false;
  }
  finally {
    dbClient.closeSession(dbSession);
  }
}
