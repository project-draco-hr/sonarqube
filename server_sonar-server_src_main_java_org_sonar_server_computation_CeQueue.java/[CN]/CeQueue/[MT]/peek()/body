{
  if (peekPaused) {
    return Optional.absent();
  }
  DbSession dbSession=dbClient.openSession(false);
  try {
    Optional<CeQueueDto> dto=dbClient.ceQueueDao().peek(dbSession);
    if (!dto.isPresent()) {
      return Optional.absent();
    }
    queueStatus.addInProgress();
    return Optional.of(new CeTask(dto.get()));
  }
  finally {
    dbClient.closeSession(dbSession);
  }
}
