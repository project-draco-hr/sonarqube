{
  LOG.debug("UPDATE _id:{} in index {}",key,this.getIndexName());
  BulkRequestBuilder bulkRequest=getClient().prepareBulk();
  for (  UpdateRequest request : requests) {
    if (request.id() == null || request.id().isEmpty()) {
      bulkRequest.add(new IndexRequest().source(request.doc().sourceAsMap()).type(this.getIndexType()).index(this.getIndexName()));
    }
 else {
      bulkRequest.add(request.id(this.getKeyValue(key)).index(this.getIndexName()).type(this.getIndexType()));
    }
  }
  bulkRequest.get();
}
