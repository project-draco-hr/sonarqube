{
  setupData("user_should_be_authorized");
  Collection<Long> componentIds=authorization.keepAuthorizedProjectIds(session,Sets.newHashSet(PROJECT_ID,PROJECT_ID_WITHOUT_SNAPSHOT),USER,"user");
  assertThat(componentIds).containsOnly(PROJECT_ID,PROJECT_ID_WITHOUT_SNAPSHOT);
  componentIds=authorization.keepAuthorizedProjectIds(session,Sets.newHashSet(PROJECT_ID),USER,"admin");
  assertThat(componentIds).isEmpty();
  assertThat(authorization.keepAuthorizedProjectIds(session,Collections.<Long>emptySet(),USER,"admin")).isEmpty();
}
