{
  ruleRepository.add(XOO_X1);
  ruleRepository.add(XOO_X2);
  ScannerReport.ActiveRule.Builder batch1=ScannerReport.ActiveRule.newBuilder().setRuleRepository(XOO_X1.repository()).setRuleKey(XOO_X1.rule()).setSeverity(Constants.Severity.BLOCKER);
  batch1.getMutableParamsByKey().put("p1","v1");
  ScannerReport.ActiveRule.Builder batch2=ScannerReport.ActiveRule.newBuilder().setRuleRepository(XOO_X2.repository()).setRuleKey(XOO_X2.rule()).setSeverity(Constants.Severity.MAJOR);
  batchReportReader.putActiveRules(asList(batch1.build(),batch2.build()));
  underTest.execute();
  assertThat(activeRulesHolder.getAll()).hasSize(2);
  Optional<ActiveRule> ar1=activeRulesHolder.get(XOO_X1);
  assertThat(ar1.get().getSeverity()).isEqualTo(Severity.BLOCKER);
  assertThat(ar1.get().getParams()).containsExactly(MapEntry.entry("p1","v1"));
  Optional<ActiveRule> ar2=activeRulesHolder.get(XOO_X2);
  assertThat(ar2.get().getSeverity()).isEqualTo(Severity.MAJOR);
  assertThat(ar2.get().getParams()).isEmpty();
}
