{
  setup("saveOptimizedBestValuesIfOptionalFields");
  assertThat(CoreMetrics.VIOLATIONS.getBestValue(),is(0.0));
  assertThat(CoreMetrics.VIOLATIONS.isOptimizedBestValue(),is(true));
  final Resource javaFile=new JavaFile("org.foo.Bar");
  assertThat(context.getMeasure(javaFile,CoreMetrics.VIOLATIONS),nullValue());
  Measure measure=new Measure(CoreMetrics.VIOLATIONS,0.0).setTendency(1);
  context.saveMeasure(javaFile,measure);
  assertThat(context.getMeasure(javaFile,CoreMetrics.VIOLATIONS).getValue(),is(0.0));
  assertThat(context.getMeasure(javaFile,CoreMetrics.VIOLATIONS).getTendency(),is(1));
  check("saveOptimizedBestValuesIfOptionalFields","projects","snapshots","project_measures");
}
