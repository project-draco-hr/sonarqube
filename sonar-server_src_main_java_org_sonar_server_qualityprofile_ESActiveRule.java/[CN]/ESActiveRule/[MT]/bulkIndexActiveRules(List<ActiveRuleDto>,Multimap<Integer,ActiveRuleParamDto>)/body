{
  StopWatch bulkWatch=startWatch();
  try {
    int size=activeRules.size();
    String[] ids=new String[size];
    BytesStream[] docs=new BytesStream[size];
    String[] parentIds=new String[size];
    int index=0;
    for (    ActiveRuleDto activeRule : activeRules) {
      ids[index]=activeRule.getId().toString();
      docs[index]=activeRuleDocument(activeRule,paramsByActiveRule.get(activeRule.getId()));
      parentIds[index]=activeRule.getRulId().toString();
      index++;
    }
    if (!activeRules.isEmpty()) {
      esIndex.bulkIndex(RuleRegistry.INDEX_RULES,ESActiveRule.TYPE_ACTIVE_RULE,ids,docs,parentIds);
    }
    bulkWatch.stop(String.format("Indexed %d active rules",size));
    return ids;
  }
 catch (  IOException e) {
    bulkWatch.stop("Failed to indes active rules");
    throw new IllegalStateException("Unable to index active rules",e);
  }
}
