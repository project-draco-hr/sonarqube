{
  Graph g=TinkerGraphFactory.createTinkerGraph();
  ByteArrayOutputStream stream=new ByteArrayOutputStream();
  GraphsonWriter writer=new GraphsonWriter();
  writer.write(g,stream,GraphsonMode.COMPACT);
  stream.flush();
  stream.close();
  String jsonString=new String(stream.toByteArray());
  JSONObject rootNode=(JSONObject)JSONValue.parse(jsonString);
  assertThat(rootNode).isNotNull();
  assertThat(rootNode.containsKey(GraphsonTokens.MODE)).isTrue();
  assertThat(rootNode.get(GraphsonTokens.MODE)).isEqualTo("COMPACT");
  assertThat(rootNode.containsKey(GraphsonTokens.VERTICES)).isTrue();
  JSONArray vertices=(JSONArray)rootNode.get(GraphsonTokens.VERTICES);
  assertThat(vertices).hasSize(6);
  assertThat(rootNode.containsKey(GraphsonTokens.EDGES)).isTrue();
  JSONArray edges=(JSONArray)rootNode.get(GraphsonTokens.EDGES);
  assertThat(edges).hasSize(6);
}
