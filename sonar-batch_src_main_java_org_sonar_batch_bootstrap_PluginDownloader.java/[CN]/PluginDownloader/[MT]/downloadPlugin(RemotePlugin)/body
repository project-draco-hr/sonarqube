{
  try {
    List<File> files=Lists.newArrayList();
    for (    final RemotePluginFile file : remote.getFiles()) {
      File cachedFile=fileCache.get(file.getFilename(),file.getHash(),new FileCache.Downloader(){
        public void download(        String filename,        File toFile) throws IOException {
          String url="/deploy/plugins/" + remote.getKey() + "/"+ file.getFilename();
          if (LOG.isDebugEnabled()) {
            LOG.debug("Download {} to {}",url,toFile.getAbsolutePath());
          }
 else {
            LOG.info("Download {}",file.getFilename());
          }
          server.download(url,toFile);
        }
      }
);
      files.add(cachedFile);
    }
    return files;
  }
 catch (  Exception e) {
    throw new SonarException("Fail to download plugin: " + remote.getKey(),e);
  }
}
