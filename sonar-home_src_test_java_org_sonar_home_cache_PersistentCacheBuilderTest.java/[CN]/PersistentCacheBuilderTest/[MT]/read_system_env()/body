{
  assumeTrue(System.getenv("SONAR_USER_HOME") == null);
  System.setProperty("user.home",temp.getRoot().getAbsolutePath());
  PersistentCache cache=new PersistentCacheBuilder().build();
  assertTrue(Files.isDirectory(cache.getBaseDirectory()));
  assertThat(cache.getBaseDirectory().getFileName().toString()).isEqualTo("ws_cache");
  String expectedSonarHome=temp.getRoot().toPath().resolve(".sonar").toString();
  assertThat(cache.getBaseDirectory().getParent().toString()).isEqualTo(expectedSonarHome);
}
