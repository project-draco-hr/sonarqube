{
  File dir=new File("./target/test-tmp/org/sonar/server/startup/GwtPublisherTest/shouldCleanTheOutputDirOnStop");
  if (!dir.exists()) {
    FileUtils.forceMkdir(dir);
  }
  File file=new File(dir,"test.txt");
  FileUtils.writeStringToFile(file,"test");
  File testDir=new File(dir,"testDir");
  testDir.mkdir();
  File testDirFile=new File(testDir,"test.txt");
  FileUtils.writeStringToFile(testDirFile,"test");
  File scm=new File(dir,".svn");
  scm.mkdir();
  assertThat(file.exists(),is(true));
  assertThat(testDir.exists(),is(true));
  assertThat(testDirFile.exists(),is(true));
  assertThat(scm.exists(),is(true));
  GwtPublisher publisher=new GwtPublisher(null,dir);
  publisher.cleanDirectory();
  assertThat(dir.exists(),is(true));
  assertThat(FileUtils.listFiles(dir,null,true).size(),is(0));
  scm=new File(dir,".svn");
  if (scm.isHidden()) {
    assertThat(scm.exists(),is(true));
  }
}
