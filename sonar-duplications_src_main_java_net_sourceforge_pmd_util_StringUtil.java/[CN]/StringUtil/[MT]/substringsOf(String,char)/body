{
  if (source == null || source.length() == 0) {
    return EMPTY_STRINGS;
  }
  int delimiterCount=0;
  int length=source.length();
  char[] chars=source.toCharArray();
  for (int i=0; i < length; i++) {
    if (chars[i] == delimiter)     delimiterCount++;
  }
  if (delimiterCount == 0)   return new String[]{source};
  String results[]=new String[delimiterCount + 1];
  int i=0;
  int offset=0;
  while (offset <= length) {
    int pos=source.indexOf(delimiter,offset);
    if (pos < 0)     pos=length;
    results[i++]=pos == offset ? "" : source.substring(offset,pos);
    offset=pos + 1;
  }
  return results;
}
