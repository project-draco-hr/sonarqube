{
  String mode=snapshot.getPeriodMode(periodIndex);
  String param=snapshot.getPeriodModeParameter(periodIndex);
  Date date=snapshot.getPeriodDate(periodIndex);
  if (mode.equals(CoreProperties.TIMEMACHINE_MODE_DAYS)) {
    return message("over_x_days",param);
  }
 else   if (mode.equals(CoreProperties.TIMEMACHINE_MODE_VERSION)) {
    if (date != null) {
      return message("since_version_detailed",param,convertDate(date));
    }
 else {
      return message("since_version",param);
    }
  }
 else   if (mode.equals(CoreProperties.TIMEMACHINE_MODE_PREVIOUS_ANALYSIS)) {
    if (date != null) {
      return message("since_previous_analysis_detailed",convertDate(date));
    }
 else {
      return message("since_previous_analysis");
    }
  }
 else   if (mode.equals(CoreProperties.TIMEMACHINE_MODE_PREVIOUS_VERSION)) {
    if (param != null) {
      return message("since_previous_version_detailed",param);
    }
 else {
      return message("since_previous_version");
    }
  }
 else   if (mode.equals(CoreProperties.TIMEMACHINE_MODE_DATE)) {
    return message("since_x",convertDate(date));
  }
 else {
    throw new IllegalStateException("This mode is not supported : " + mode);
  }
}
