{
  Map<Long,ComponentDto> projectById=newHashMap();
  for (  Map.Entry<String,String> entry : refByComponentKey.entrySet()) {
    String componentKey=entry.getKey();
    String ref=entry.getValue();
    ComponentDto file=componentDao.getNullableByKey(session,componentKey);
    if (file != null) {
      json.name(ref).beginObject();
      json.prop("key",file.key());
      json.prop("name",file.longName());
      ComponentDto project=projectById.get(file.projectId());
      if (project == null) {
        project=componentDao.getById(file.projectId(),session);
        projectById.put(file.projectId(),project);
      }
      json.prop("projectName",project != null ? project.longName() : null);
      json.endObject();
    }
  }
}
