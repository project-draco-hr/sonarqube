{
  RuleDto rule=findRuleNotNull(ruleId);
  String sanitizedNote=Strings.emptyToNull(note);
  if (sanitizedNote != null) {
    operations.updateRuleNote(rule,note,UserSession.get());
  }
 else {
    operations.deleteRuleNote(rule,UserSession.get());
  }
  ActiveRuleDto activeRule=findActiveRuleNotNull(activeRuleId);
  return rules.getFromActiveRuleId(activeRule.getId());
}
