{
  String sanitizedValue=Strings.emptyToNull(value);
  ActiveRuleParamDto activeRuleParam=findActiveRuleParam(activeRuleId,key);
  ActiveRuleDto activeRule=findActiveRuleNotNull(activeRuleId);
  UserSession userSession=UserSession.get();
  QProfileRule result=null;
  if (activeRuleParam == null && sanitizedValue != null) {
    result=operations.createActiveRuleParam(activeRule,key,value,userSession);
  }
 else   if (activeRuleParam != null && sanitizedValue == null) {
    result=operations.deleteActiveRuleParam(activeRule,activeRuleParam,userSession);
  }
 else   if (activeRuleParam != null) {
    operations.updateActiveRuleParam(activeRule,activeRuleParam,value,userSession);
  }
  return result;
}
