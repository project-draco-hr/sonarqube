{
  dbTester.prepareDbUnit(getClass(),"shared.xml");
  esTester.putDocuments(IssueIndexDefinition.INDEX,IssueIndexDefinition.TYPE_ISSUE,IssueTesting.newDoc());
  esTester.putDocuments(SourceLineIndexDefinition.INDEX,SourceLineIndexDefinition.TYPE,new SourceLineDoc().setProjectUuid("ABCD").setFileUuid("BCDE"));
  esTester.putDocuments(ViewIndexDefinition.INDEX,ViewIndexDefinition.TYPE_VIEW,new ViewDoc().setUuid("CDEF").setProjects(newArrayList("DEFG")));
  esTester.putDocuments(IndexDefinition.RULE.getIndexName(),IndexDefinition.RULE.getIndexType(),newRuleDoc());
  backendCleanup.resetData();
  assertThat(dbTester.countRowsOfTable("projects")).isEqualTo(0);
  assertThat(dbTester.countRowsOfTable("snapshots")).isEqualTo(0);
  assertThat(dbTester.countRowsOfTable("properties")).isEqualTo(0);
  assertThat(esTester.countDocuments(IssueIndexDefinition.INDEX,IssueIndexDefinition.TYPE_ISSUE)).isEqualTo(0);
  assertThat(esTester.countDocuments(SourceLineIndexDefinition.INDEX,SourceLineIndexDefinition.TYPE)).isEqualTo(0);
  assertThat(esTester.countDocuments(ViewIndexDefinition.INDEX,ViewIndexDefinition.TYPE_VIEW)).isEqualTo(0);
  assertThat(dbTester.countRowsOfTable("rules")).isEqualTo(1);
  assertThat(esTester.countDocuments(IndexDefinition.RULE.getIndexName(),IndexDefinition.RULE.getIndexType())).isEqualTo(1);
}
