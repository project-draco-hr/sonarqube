{
  InputFile file=new DefaultInputFile("foo","src/Foo.php");
  ArgumentCaptor<org.sonar.api.measures.Measure> argumentCaptor=ArgumentCaptor.forClass(org.sonar.api.measures.Measure.class);
  File sonarFile=File.create("src/Foo.php");
  when(sonarIndex.addMeasure(eq(sonarFile),argumentCaptor.capture())).thenReturn(null);
  when(sonarIndex.getResource(sonarFile)).thenReturn(sonarFile);
  sensorStorage.store(new DefaultMeasure().onFile(file).forMetric(CoreMetrics.NCLOC).withValue(10));
  org.sonar.api.measures.Measure m=argumentCaptor.getValue();
  assertThat(m.getValue()).isEqualTo(10.0);
  assertThat(m.getMetric()).isEqualTo(CoreMetrics.NCLOC);
}
