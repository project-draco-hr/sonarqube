{
  Resource foo=File.create("src/Foo.java").setEffectiveKey("foo:src/Foo.java");
  Resource bar=File.create("src/Bar.java").setEffectiveKey("foo:src/Bar.java");
  resourceCache.add(foo,null);
  resourceCache.add(bar,null);
  sensorStorage.store(new DefaultDependency().from(new DefaultInputFile("foo","src/Foo.java").setType(Type.MAIN)).to(new DefaultInputFile("foo","src/Bar.java").setType(Type.MAIN)).weight(3));
  ArgumentCaptor<Dependency> argumentCaptor=ArgumentCaptor.forClass(Dependency.class);
  verify(sonarIndex).addDependency(argumentCaptor.capture());
  assertThat(argumentCaptor.getValue().getFrom()).isEqualTo(foo);
  assertThat(argumentCaptor.getValue().getTo()).isEqualTo(bar);
  assertThat(argumentCaptor.getValue().getWeight()).isEqualTo(3);
  assertThat(argumentCaptor.getValue().getUsage()).isEqualTo("USES");
}
