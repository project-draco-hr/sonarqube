{
  setupData("dbContent");
  Project project=new Project("myproject");
  project.setConfiguration(new PropertiesConfiguration());
  GregorianCalendar calendar=new GregorianCalendar(2010,10,1);
  Date dateToStartKeepingOneSnapshotByWeek=calendar.getTime();
  calendar.set(2010,7,1);
  Date dateToStartKeepingOneSnapshotByMonth=calendar.getTime();
  calendar.set(2010,2,1);
  Date dateToStartDeletingAllSnapshots=calendar.getTime();
  Periods periods=new Periods(dateToStartKeepingOneSnapshotByWeek,dateToStartKeepingOneSnapshotByMonth,dateToStartDeletingAllSnapshots);
  cleaner.purge(project,1010,periods);
  checkTables("dbContent","snapshots");
  setupData("dbContent-result");
  cleaner.purge(project,1010,periods);
  checkTables("dbContent");
}
