{
  File tempFile=temp.newFile();
  FileUtils.write(tempFile,"foo\nbar\r\nbaz\n",Charsets.UTF_8,true);
  FileMetadata.Metadata metadata=FileMetadata.INSTANCE.read(tempFile,Charsets.UTF_8);
  assertThat(metadata.lines).isEqualTo(4);
  assertThat(metadata.hash).isEqualTo(EXPECTED_HASH_WITH_LATEST_EOL);
  assertThat(metadata.originalLineOffsets).containsOnly(0,4,9,13);
  assertThat(metadata.lineChecksum).containsOnly(2090263731,2090104836,2090105100,5381);
}
