{
  File tempFile=temp.newFile();
  FileUtils.write(tempFile,"foo\r\nbar\r\nbaz",Charsets.UTF_8,true);
  FileMetadata.Metadata metadata=FileMetadata.INSTANCE.read(tempFile,Charsets.UTF_8);
  assertThat(metadata.lines).isEqualTo(3);
  assertThat(metadata.hash).isEqualTo(EXPECTED_HASH_WITHOUT_LATEST_EOL);
  assertThat(metadata.originalLineOffsets).containsOnly(0,5,10);
  assertThat(metadata.lineHashes[0]).containsOnly(md5("foo"));
  assertThat(metadata.lineHashes[1]).containsOnly(md5("bar"));
  assertThat(metadata.lineHashes[2]).containsOnly(md5("baz"));
}
