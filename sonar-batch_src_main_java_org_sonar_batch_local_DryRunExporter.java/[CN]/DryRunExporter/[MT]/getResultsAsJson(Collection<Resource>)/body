{
  Gson gson=new Gson();
  StringWriter output=new StringWriter();
  JsonWriter writer=null;
  try {
    writer=new JsonWriter(output);
    writer.beginArray();
    for (    Resource resource : resources) {
      for (      Violation violation : getViolations(resource)) {
        gson.toJson(new ViolationToMap().apply(violation),writer);
      }
    }
    writer.endArray();
  }
 catch (  IOException e) {
    throw new SonarException("Unable to export results",e);
  }
 finally {
    Closeables.closeQuietly(writer);
  }
  return output.toString();
}
