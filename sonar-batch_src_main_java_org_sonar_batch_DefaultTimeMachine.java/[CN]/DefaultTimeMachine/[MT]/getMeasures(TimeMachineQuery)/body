{
  Map<Integer,Metric> metricById=getMetricsById(query);
  List<Object[]> objects=execute(query,true,metricById.keySet());
  List<Measure> result=Lists.newArrayList();
  for (  Object[] object : objects) {
    MeasureModel model=(MeasureModel)object[0];
    Measure measure=model.toMeasure(metricById.get(model.getMetricId()));
    measure.setDate((Date)object[1]);
    result.add(measure);
  }
  return result;
}
