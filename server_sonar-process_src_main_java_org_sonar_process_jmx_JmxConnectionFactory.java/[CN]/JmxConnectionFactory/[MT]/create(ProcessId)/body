{
  try (DefaultProcessCommands commands=DefaultProcessCommands.secondary(ipcSharedDir,processId.getIpcIndex())){
    String url=commands.getJmxUrl();
    JMXConnector jmxConnector=JMXConnectorFactory.newJMXConnector(new JMXServiceURL(url),null);
    jmxConnector.connect();
    return new JmxConnection(jmxConnector);
  }
 catch (  Exception e) {
    throw new IllegalStateException("Can not connect to process " + processId,e);
  }
}
