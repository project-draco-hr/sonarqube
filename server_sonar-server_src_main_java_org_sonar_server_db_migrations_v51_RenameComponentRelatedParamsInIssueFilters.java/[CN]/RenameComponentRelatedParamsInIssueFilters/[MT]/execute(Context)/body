{
  final Date now=new Date(system.now());
  MassUpdate massUpdate=context.prepareMassUpdate();
  massUpdate.select("select id,data from issue_filters where " + "data like '%" + COMPONENTS + "%' or "+ "data like '%"+ PROJECTS+ "%' or "+ "data like '%"+ COMPONENT_ROOTS+ "%' or "+ "data like '%"+ COMPONENT_ROOT_UUIDS+ "%'");
  massUpdate.update("update issue_filters set data=?, updated_at=? where id=?");
  massUpdate.rowPluralName("issue filters");
  massUpdate.execute(new MassUpdate.Handler(){
    @Override public boolean handle(    Select.Row row,    SqlStatement update) throws SQLException {
      String data=row.getString(2);
      String[] fields=StringUtils.split(data,FIELD_SEPARATOR);
      List<String> fieldsToKeep=Lists.newArrayList();
      for (      String field : fields) {
        if (field.startsWith(COMPONENTS) || field.startsWith(PROJECTS) || field.startsWith(COMPONENT_ROOTS)|| field.startsWith(COMPONENT_ROOT_UUIDS)) {
          fieldsToKeep.add(field.replace(COMPONENTS,"componentKeys=").replace(PROJECTS,"projectKeys=").replace(COMPONENT_ROOTS,"moduleKeys=").replace(COMPONENT_ROOT_UUIDS,"moduleUuids="));
        }
 else {
          fieldsToKeep.add(field);
        }
      }
      update.setString(1,StringUtils.join(fieldsToKeep,FIELD_SEPARATOR));
      update.setDate(2,now);
      update.setLong(3,row.getLong(1));
      return true;
    }
  }
);
}
