{
  setupData("shared");
  ResourcePersister persister=new DefaultResourcePersister(getSession(),mock(ResourcePermissions.class),snapshotCache,resourceCache);
  existingProject.setParent(multiModuleProject);
  persister.saveProject(multiModuleProject,null);
  thrown.expect(SonarException.class);
  thrown.expectMessage("The project 'my:key' is already defined in SonarQube but not as a module of project 'root'. " + "If you really want to stop directly analysing project 'my:key', please first delete it from SonarQube and then relaunch the analysis of project 'root'.");
  persister.saveProject(existingProject,multiModuleProject);
}
