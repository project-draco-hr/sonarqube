{
  List<String> projectSnapshotIds=purgeCommands.selectSnapshotUuids(PurgeSnapshotQuery.create().setComponentUuid(project.getUuid()).setIslast(false).setNotPurged(true));
  for (  String analysisUuid : projectSnapshotIds) {
    LOG.debug("<- Clean analysis " + analysisUuid);
    if (!ArrayUtils.isEmpty(scopesWithoutHistoricalData)) {
      PurgeSnapshotQuery query=PurgeSnapshotQuery.create().setIslast(false).setScopes(scopesWithoutHistoricalData).setAnalysisUuid(analysisUuid);
      purgeCommands.deleteSnapshots(query);
    }
    purgeCommands.purgeSnapshots(PurgeSnapshotQuery.create().setAnalysisUuid(analysisUuid).setNotPurged(true),PurgeSnapshotQuery.create().setSnapshotUuid(analysisUuid).setNotPurged(true));
  }
}
