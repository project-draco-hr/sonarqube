{
  PurgeMapper mapper=session.getMapper(PurgeMapper.class);
  PurgeCommands commands=new PurgeCommands(session,mapper,profiler);
  deleteAbortedAnalyses(conf.rootProjectIdUuid().getUuid(),commands);
  deleteDataOfComponentsWithoutHistoricalData(session,conf.rootProjectIdUuid().getUuid(),conf.scopesWithoutHistoricalData(),commands);
  List<ResourceDto> projects=getProjects(conf.rootProjectIdUuid().getId(),session);
  for (  ResourceDto project : projects) {
    LOG.debug("-> Clean " + project.getLongName() + " [id="+ project.getId()+ "]");
    purge(project.getUuid(),commands);
  }
  for (  ResourceDto project : projects) {
    disableOrphanResources(project,session,mapper,listener);
  }
  deleteOldClosedIssues(conf,mapper,listener);
}
