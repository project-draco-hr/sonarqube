{
  File userHome=temp.getRoot();
  System.setProperty("user.home",userHome.getAbsolutePath());
  File defaultSonarHome=new File(System.getProperty("user.home"),".sonar");
  File workingDir=new File(defaultSonarHome,CoreProperties.GLOBAL_WORKING_DIRECTORY_DEFAULT_VALUE).getAbsoluteFile();
  try {
    TempFolder tempFolder=tempFolderProvider.provide(new BootstrapProperties(Collections.<String,String>emptyMap()));
    tempFolder.newDir();
    tempFolder.newFile();
    assertThat(getCreatedTempDir(workingDir)).exists();
    assertThat(getCreatedTempDir(workingDir).list()).hasSize(2);
  }
  finally {
    FileUtils.deleteDirectory(getCreatedTempDir(workingDir));
  }
}
