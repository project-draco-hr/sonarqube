{
  db.prepareDbUnit(getClass(),"select_by_snapshot_and_metric_keys_with_rule_id.xml");
  List<MeasureDto> results=underTest.selectBySnapshotIdAndMetricKeys(SNAPSHOT_ID,newHashSet("ncloc"),db.getSession());
  assertThat(results).hasSize(3);
  Map<Long,MeasureDto> measuresById=measuresById(results);
  assertThat(measuresById.get(1L).getRuleId()).isNull();
  assertThat(measuresById.get(2L).getRuleId()).isEqualTo(30);
  assertThat(measuresById.get(3L).getRuleId()).isEqualTo(31);
}
