{
  insertAnalysis(LAST_ANALYSIS_UUID,true);
  insertAnalysis(OTHER_ANALYSIS_UUID,false);
  insertMeasure("M1",OTHER_ANALYSIS_UUID,"C1",NCLOC_METRIC_ID);
  insertMeasure("M2",LAST_ANALYSIS_UUID,"C1",NCLOC_METRIC_ID);
  insertMeasure("M3",LAST_ANALYSIS_UUID,"C1",COVERAGE_METRIC_ID);
  insertMeasureOnPerson("M4",LAST_ANALYSIS_UUID,"C1",NCLOC_METRIC_ID,A_PERSON_ID);
  insertMeasureOnPerson("M5",OTHER_ANALYSIS_UUID,"C1",NCLOC_METRIC_ID,123L);
  insertMeasure("M6",LAST_ANALYSIS_UUID,"C2",NCLOC_METRIC_ID);
  db.commit();
  verifyZeroMeasures(MeasureQuery.builder().setComponentUuids(emptyList()));
  verifyZeroMeasures(MeasureQuery.builder().setComponentUuid("MISSING_COMPONENT"));
  verifyMeasures(MeasureQuery.builder().setComponentUuid("C1"),"M2","M3");
  verifyMeasures(MeasureQuery.builder().setComponentUuid("C1").setAnalysisUuid(OTHER_ANALYSIS_UUID),"M1");
  verifyMeasures(MeasureQuery.builder().setComponentUuid("C1").setAnalysisUuid(LAST_ANALYSIS_UUID),"M2","M3");
  verifyMeasures(MeasureQuery.builder().setComponentUuid("C1").setMetricId(NCLOC_METRIC_ID),"M2");
  verifyMeasures(MeasureQuery.builder().setComponentUuid("C1").setAnalysisUuid(OTHER_ANALYSIS_UUID).setMetricId(NCLOC_METRIC_ID),"M1");
  verifyMeasures(MeasureQuery.builder().setComponentUuid("C1").setAnalysisUuid(LAST_ANALYSIS_UUID).setMetricId(NCLOC_METRIC_ID),"M2");
  verifyMeasures(MeasureQuery.builder().setComponentUuid("C1").setMetricIds(asList(NCLOC_METRIC_ID,COVERAGE_METRIC_ID)),"M2","M3");
  verifyMeasures(MeasureQuery.builder().setComponentUuid("C1").setAnalysisUuid(OTHER_ANALYSIS_UUID).setMetricIds(asList(NCLOC_METRIC_ID,COVERAGE_METRIC_ID)),"M1");
  verifyMeasures(MeasureQuery.builder().setComponentUuid("C1").setAnalysisUuid(LAST_ANALYSIS_UUID).setMetricIds(asList(NCLOC_METRIC_ID,COVERAGE_METRIC_ID)),"M2","M3");
  verifyZeroMeasures(MeasureQuery.builder().setComponentUuid("C1").setMetricId(COMPLEXITY_METRIC_ID));
  verifyZeroMeasures(MeasureQuery.builder().setComponentUuid("C1").setAnalysisUuid(OTHER_ANALYSIS_UUID).setMetricId(COMPLEXITY_METRIC_ID));
  verifyZeroMeasures(MeasureQuery.builder().setComponentUuid("C1").setAnalysisUuid(LAST_ANALYSIS_UUID).setMetricId(COMPLEXITY_METRIC_ID));
  verifyMeasures(MeasureQuery.builder().setComponentUuids(asList("C1","C2","C3")),"M2","M3","M6");
  verifyMeasures(MeasureQuery.builder().setComponentUuids(asList("C1","C2","C3")).setAnalysisUuid(OTHER_ANALYSIS_UUID),"M1");
  verifyMeasures(MeasureQuery.builder().setComponentUuids(asList("C1","C2","C3")).setAnalysisUuid(LAST_ANALYSIS_UUID),"M2","M3","M6");
  verifyZeroMeasures(MeasureQuery.builder().setComponentUuid("C1").setPersonId(123L));
  verifyMeasures(MeasureQuery.builder().setComponentUuid("C1").setAnalysisUuid(OTHER_ANALYSIS_UUID).setPersonId(123L),"M5");
  verifyZeroMeasures(MeasureQuery.builder().setComponentUuid("C1").setAnalysisUuid(LAST_ANALYSIS_UUID).setPersonId(123L));
  verifyMeasures(MeasureQuery.builder().setComponentUuid("C1").setPersonId(A_PERSON_ID),"M4");
  verifyZeroMeasures(MeasureQuery.builder().setComponentUuid("C1").setAnalysisUuid(OTHER_ANALYSIS_UUID).setPersonId(A_PERSON_ID));
  verifyMeasures(MeasureQuery.builder().setComponentUuid("C1").setAnalysisUuid(LAST_ANALYSIS_UUID).setPersonId(A_PERSON_ID),"M4");
}
