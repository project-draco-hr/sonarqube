{
  Long componentId=componentId(query.component());
  List<GroupWithPermissionDto> dtos=permissionDao.selectGroups(query,componentId);
  addAnyoneGroup(dtos,query);
  List<GroupWithPermissionDto> filteredDtos=filterMembership(dtos,query);
  Paging paging=Paging.create(query.pageSize(),query.pageIndex(),filteredDtos.size());
  List<GroupWithPermission> pagedGroups=pagedGroups(filteredDtos,paging);
  return new GroupWithPermissionQueryResult(pagedGroups,paging.hasNextPage());
}
