{
  Rules rules=new Rules(){
    @Override public void init(    RulesDefinition.NewRepository repository){
      repository.createRule("x1").setName("x1 name").setHtmlDescription("x1 desc");
    }
  }
;
  register(rules);
  register(null);
  RuleDto rule=db.deprecatedRuleDao().getByKey(dbSession,RuleTesting.XOO_X1);
  assertThat(rule.getStatus()).isEqualTo(RuleStatus.REMOVED);
  Rule indexedRule=ruleIndex.getByKey(RuleTesting.XOO_X1);
  assertThat(indexedRule.status()).isEqualTo(RuleStatus.REMOVED);
  register(rules);
  rule=db.deprecatedRuleDao().getByKey(dbSession,RuleTesting.XOO_X1);
  assertThat(rule.getStatus()).isEqualTo(RuleStatus.READY);
  indexedRule=ruleIndex.getByKey(RuleTesting.XOO_X1);
  assertThat(indexedRule.status()).isEqualTo(RuleStatus.READY);
}
