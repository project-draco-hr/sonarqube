{
  IssueQuery query=IssueQuery.builder().actionPlans(Arrays.asList(actionPlan.key())).requiredRole(null).build();
  List<IssueDto> dtos=issueDao.selectIssues(query);
  IssueChangeContext context=IssueChangeContext.createUser(new Date(),userSession.login());
  List<DefaultIssue> issues=newArrayList();
  for (  IssueDto issueDto : dtos) {
    Long debt=issueDto.getTechnicalDebt();
    DefaultIssue issue=issueDto.toDefaultIssue(debt != null ? workDurationFactory.createFromWorkingLong(debt) : null);
    if (issueUpdater.plan(issue,null,context)) {
      issues.add(issue);
    }
  }
  issueStorage.save(issues);
}
