{
  WSLoader server=mock(WSLoader.class);
  when(server.loadString(anyString())).thenThrow(new HttpDownloader.HttpException(new URI(""),500));
  ServerLineHashesLoader lastSnapshots=new DefaultServerLineHashesLoader(server);
  thrown.expect(HttpDownloader.HttpException.class);
  lastSnapshots.getLineHashes("foo");
}
