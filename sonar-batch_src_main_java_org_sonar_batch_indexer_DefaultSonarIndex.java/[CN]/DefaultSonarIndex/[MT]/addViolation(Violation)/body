{
  Bucket bucket;
  Resource resource=violation.getResource();
  if (resource == null) {
    bucket=selectedProjectBucket;
  }
 else {
    bucket=getOrCreateBucket(resource,true);
  }
  if (!bucket.isExcluded()) {
    persistViolation(violation,bucket.getSnapshot());
  }
}
