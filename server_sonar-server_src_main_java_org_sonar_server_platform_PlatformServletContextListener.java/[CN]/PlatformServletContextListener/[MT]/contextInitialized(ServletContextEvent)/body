{
  try {
    Properties props=new Properties();
    ServletContext context=event.getServletContext();
    Enumeration<String> paramKeys=context.getInitParameterNames();
    while (paramKeys.hasMoreElements()) {
      String key=paramKeys.nextElement();
      if (key.startsWith("sonar.")) {
        props.put(key,context.getInitParameter(key));
      }
    }
    Platform.getInstance().init(props);
    Platform.getInstance().doStart();
  }
 catch (  Throwable t) {
    LoggerFactory.getLogger(getClass()).error("Fail to start server",t);
    stopQuietly();
    throw new IllegalStateException("Fail to start webapp",t);
  }
}
