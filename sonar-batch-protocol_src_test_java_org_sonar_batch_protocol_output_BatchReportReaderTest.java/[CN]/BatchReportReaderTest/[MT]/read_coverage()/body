{
  BatchReportWriter writer=new BatchReportWriter(dir);
  writer.writeMetadata(BatchReport.Metadata.newBuilder().setRootComponentRef(1).build());
  writer.writeComponent(BatchReport.Component.newBuilder().setRef(1).build());
  writer.writeComponentCoverage(1,Arrays.asList(BatchReport.Coverage.newBuilder().setLine(1).setConditions(1).setUtHits(true).setItHits(false).setUtCoveredConditions(1).setItCoveredConditions(1).setOverallCoveredConditions(1).build(),BatchReport.Coverage.newBuilder().setLine(2).setConditions(5).setUtHits(false).setItHits(false).setUtCoveredConditions(4).setItCoveredConditions(5).setOverallCoveredConditions(5).build()));
  sut=new BatchReportReader(dir);
  try (InputStream inputStream=FileUtils.openInputStream(new BatchReportReader(dir).readComponentCoverage(1))){
    BatchReport.Coverage coverage=BatchReport.Coverage.PARSER.parseDelimitedFrom(inputStream);
    assertThat(coverage.getLine()).isEqualTo(1);
    assertThat(coverage.getConditions()).isEqualTo(1);
    assertThat(coverage.getUtHits()).isTrue();
    assertThat(coverage.getItHits()).isFalse();
    assertThat(coverage.getUtCoveredConditions()).isEqualTo(1);
    assertThat(coverage.getItCoveredConditions()).isEqualTo(1);
    assertThat(coverage.getOverallCoveredConditions()).isEqualTo(1);
    coverage=BatchReport.Coverage.PARSER.parseDelimitedFrom(inputStream);
    assertThat(coverage.getLine()).isEqualTo(2);
    assertThat(coverage.getConditions()).isEqualTo(5);
    assertThat(coverage.getUtHits()).isFalse();
    assertThat(coverage.getItHits()).isFalse();
    assertThat(coverage.getUtCoveredConditions()).isEqualTo(4);
    assertThat(coverage.getItCoveredConditions()).isEqualTo(5);
    assertThat(coverage.getOverallCoveredConditions()).isEqualTo(5);
  }
 }
