{
  BatchReportWriter writer=new BatchReportWriter(dir);
  writer.writeMetadata(BatchReport.Metadata.newBuilder().setRootComponentRef(1).build());
  writer.writeComponent(BatchReport.Component.newBuilder().setRef(1).build());
  BatchReport.DuplicationBlock duplicationBlock=BatchReport.DuplicationBlock.newBuilder().addAllHash(asList(1,2,3,5,7)).setStartLine(1).setEndLine(2).setStartTokenIndex(10).setEndTokenIndex(15).build();
  writer.writeDuplicationBlocks(1,singletonList(duplicationBlock));
  BatchReportReader sut=new BatchReportReader(dir);
  assertThat(sut.readComponentDuplicationBlocks(1)).hasSize(1);
}
