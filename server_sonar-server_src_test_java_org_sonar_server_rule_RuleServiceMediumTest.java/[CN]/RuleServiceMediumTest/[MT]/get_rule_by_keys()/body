{
  MockUserSession.set().setGlobalPermissions(GlobalPermissions.QUALITY_PROFILE_ADMIN).setLogin("me");
  dao.insert(dbSession,RuleTesting.newDto(RuleKey.of("java","S001")));
  dbSession.commit();
  dbSession.clearCache();
  assertThat(service.getByKeys(newArrayList(RuleKey.of("java","S001")))).hasSize(1);
  assertThat(service.getByKeys(newArrayList(RuleKey.of("un","known")))).isEmpty();
  assertThat(service.getByKeys(Collections.<RuleKey>emptyList())).isEmpty();
}
