{
  userSessionRule.login("me").setGlobalPermissions(GlobalPermissions.QUALITY_PROFILE_ADMIN);
  RuleKey key=RuleKey.of("java","S001");
  dao.insert(dbSession,RuleTesting.newDto(key));
  dbSession.commit();
  RuleUpdate update=RuleUpdate.createForCustomRule(key);
  update.setMarkdownNote("my *note*");
  service.update(update);
  dbSession.clearCache();
  RuleDto rule=dao.getNullableByKey(dbSession,key);
  assertThat(rule.getNoteData()).isEqualTo("my *note*");
  assertThat(rule.getNoteUserLogin()).isEqualTo("me");
}
