{
  ignoreStartupFailure=settings.getBoolean(CoreProperties.CORE_AUTHENTICATOR_IGNORE_STARTUP_FAILURE);
  String realmName=settings.getString(REALM_PROPERTY);
  String className=settings.getString(CoreProperties.CORE_AUTHENTICATOR_CLASS);
  Realm selectedRealm=null;
  if (!StringUtils.isEmpty(realmName)) {
    selectedRealm=selectRealm(realms,realmName);
    if (selectedRealm == null) {
      LOG.error("Realm not found. Please check the property '" + REALM_PROPERTY + "' in conf/sonar.properties");
      throw new AuthenticatorNotFoundException(realmName);
    }
  }
  if (selectedRealm == null && !StringUtils.isEmpty(className)) {
    LoginPasswordAuthenticator authenticator=selectAuthenticator(authenticators,className);
    if (authenticator == null) {
      LOG.error("Authenticator plugin not found. Please check the property '" + CoreProperties.CORE_AUTHENTICATOR_CLASS + "' in conf/sonar.properties");
      throw new AuthenticatorNotFoundException(className);
    }
    selectedRealm=new CompatibilityRealm(authenticator);
  }
  realm=selectedRealm;
}
