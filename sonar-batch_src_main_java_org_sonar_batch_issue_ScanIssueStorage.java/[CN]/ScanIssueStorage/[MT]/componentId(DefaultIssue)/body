{
  BatchResource resource=resourceCache.get(issue.componentKey());
  if (resource != null) {
    return resource.resource().getId();
  }
  ResourceDto resourceDto=resourceDao.getResource(ResourceQuery.create().setKey(issue.componentKey()));
  if (resourceDto == null) {
    throw new IllegalStateException("Unknown component: " + issue.componentKey());
  }
  return resourceDto.getId();
}
