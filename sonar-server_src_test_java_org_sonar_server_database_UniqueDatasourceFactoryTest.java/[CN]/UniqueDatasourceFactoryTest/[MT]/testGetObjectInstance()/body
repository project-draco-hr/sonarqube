{
  Reference ref=mock(Reference.class);
  Name name=mock(Name.class);
  Context ctx=mock(Context.class);
  when(ref.getClassName()).thenReturn(DataSource.class.getName());
  UniqueDatasourceFactory factory=new UniqueDatasourceFactory();
  DataSource ds=(DataSource)factory.getObjectInstance(ref,name,ctx,new Hashtable());
  DataSource ds2=(DataSource)factory.getObjectInstance(ref,name,ctx,new Hashtable());
  assertNotNull(ds);
  assertNotNull(ds2);
  assertTrue(ds == ds2);
  factory=new UniqueDatasourceFactory();
  DataSource ds3=(DataSource)factory.getObjectInstance(ref,name,ctx,new Hashtable());
  assertNotNull(ds3);
  assertTrue(ds == ds3);
  assertTrue(ds == ds2);
}
