{
  setupData("shared");
  TimeMachineConfiguration conf=mock(TimeMachineConfiguration.class);
  VariationSnapshot vs1=new VariationSnapshot(1,"days",getSession().getSingleResult(Snapshot.class,"id",100)).setModeParameter("30");
  VariationSnapshot vs3=new VariationSnapshot(3,"version",getSession().getSingleResult(Snapshot.class,"id",300)).setModeParameter("1.2.3");
  when(conf.getVariationSnapshots()).thenReturn(Arrays.asList(vs1,vs3));
  Snapshot projectSnapshot=getSession().getSingleResult(Snapshot.class,"id",1000);
  TimeMachineConfigurationPersister persister=new TimeMachineConfigurationPersister(conf,projectSnapshot,getSession());
  persister.start();
  checkTables("shouldSaveVariationConfigurationInSnapshotsTable","snapshots");
}
