{
  server=new MockHttpServer();
  server.start();
  server.setMockResponseStatus(401);
  when(settings.property(eq("sonar.login"))).thenReturn("");
  when(settings.property(eq("sonar.password"))).thenReturn("");
  thrown.expectMessage("Not authorized. Analyzing this project requires to be authenticated. Please provide the values of the properties sonar.login and sonar.password.");
  newServerClient().request("/foo");
}
