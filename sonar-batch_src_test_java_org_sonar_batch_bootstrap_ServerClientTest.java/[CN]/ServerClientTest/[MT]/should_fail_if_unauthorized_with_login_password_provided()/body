{
  server=new MockHttpServer();
  server.start();
  server.setMockResponseStatus(401);
  when(settings.property(eq("sonar.login"))).thenReturn("login");
  when(settings.property(eq("sonar.password"))).thenReturn("password");
  thrown.expectMessage("Not authorized. Please check the properties sonar.login and sonar.password");
  newServerClient().request("/foo");
}
