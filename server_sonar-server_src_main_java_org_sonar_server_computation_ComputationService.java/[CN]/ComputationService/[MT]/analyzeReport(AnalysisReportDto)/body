{
  TimeProfiler profiler=new TimeProfiler(LOG).start(String.format("#%s - %s - Analysis report processing",report.getId(),report.getProjectKey()));
  DbSession session=dbClient.openSession(true);
  ComponentDto project=findProject(report,session);
  ComputeEngineContext context=new ComputeEngineContext(report,project);
  try {
    report.succeed();
    for (    ComputationStep step : stepRegistry.steps()) {
      TimeProfiler stepProfiler=new TimeProfiler(LOG).start(step.getDescription());
      step.execute(session,context);
      session.commit();
      stepProfiler.stop();
    }
  }
 catch (  Exception exception) {
    report.fail();
    Throwables.propagate(exception);
  }
 finally {
    logActivity(session,report,project);
    session.commit();
    MyBatis.closeQuietly(session);
    profiler.stop();
  }
}
