{
  DbSession session=dbClient.openSession(false);
  try {
    SnapshotDto snapshot=dbClient.snapshotDao().getNullableByKey(session,snapshotId);
    if (snapshot == null) {
      item.dto.setStatus(CANCELLED);
      LOG.info("Processing of report #{} is canceled because it was submitted while another report of the same project was already being processed.",item.dto.getId());
      LOG.debug("The snapshot ID #{} provided by the report #{} does not exist anymore.",snapshotId,item.dto.getId());
    }
    return snapshot == null;
  }
  finally {
    MyBatis.closeQuietly(session);
  }
}
