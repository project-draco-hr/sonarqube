{
  RuleDto rule=RuleTesting.newXooX1();
  dao.insert(dbSession,rule);
  dao.insertRuleParam(dbSession,rule,RuleParamDto.createFor(rule).setName("MyParam").setType("STRING").setDefaultValue("test"));
  dbSession.commit();
  assertThat(dao.selectAll(dbSession)).hasSize(1);
  assertThat(index.countAll()).isEqualTo(1);
  tester.clearIndexes();
  assertThat(index.countAll()).isEqualTo(0);
  tester.get(Platform.class).executeStartupTasks();
  assertThat(index.countAll()).isEqualTo(1);
  assertThat(index.getByKey(rule.getKey()).param("MyParam").defaultValue()).isEqualTo("test");
}
