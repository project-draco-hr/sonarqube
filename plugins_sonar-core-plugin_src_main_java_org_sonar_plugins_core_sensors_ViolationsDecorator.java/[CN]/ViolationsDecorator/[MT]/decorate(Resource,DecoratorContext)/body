{
  if (shouldDecorateResource(resource)) {
    resetCounters();
    countViolations(context);
    saveTotalViolations(context);
    saveViolationsBySeverity(context);
    saveViolationsByRule(context);
  }
}
