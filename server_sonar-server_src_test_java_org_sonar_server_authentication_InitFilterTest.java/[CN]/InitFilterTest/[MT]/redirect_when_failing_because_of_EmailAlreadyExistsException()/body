{
  IdentityProvider identityProvider=new FailWithEmailAlreadyExistsExceptionIdProvider("failing");
  when(request.getRequestURI()).thenReturn("/sessions/init/" + identityProvider.getKey());
  identityProviderRepository.addIdentityProvider(identityProvider);
  underTest.doFilter(request,response,chain);
  verify(response).sendRedirect("/sessions/email_already_exists?email=john@email.com");
}
