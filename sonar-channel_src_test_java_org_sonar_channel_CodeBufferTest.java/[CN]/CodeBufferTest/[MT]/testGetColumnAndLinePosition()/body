{
  CodeBuffer reader=new CodeBuffer("pa\nc\r\ns\r\n\r\n");
  assertThat(reader.getColumnPosition(),is(0));
  assertThat(reader.getLinePosition(),is(1));
  reader.pop();
  reader.pop();
  assertThat(reader.getColumnPosition(),is(2));
  assertThat(reader.getLinePosition(),is(1));
  reader.peek();
  reader.lastChar();
  assertThat(reader.getColumnPosition(),is(2));
  assertThat(reader.getLinePosition(),is(1));
  reader.pop();
  assertThat(reader.getColumnPosition(),is(0));
  assertThat(reader.getLinePosition(),is(2));
  reader.pop();
  assertThat(reader.getColumnPosition(),is(1));
  assertThat(reader.getLinePosition(),is(2));
  reader.pop();
  reader.pop();
  assertThat(reader.getColumnPosition(),is(0));
  assertThat(reader.getLinePosition(),is(3));
  assertThat((char)reader.pop(),is('s'));
  reader.pop();
  assertThat(reader.getColumnPosition(),is(0));
  assertThat(reader.getLinePosition(),is(4));
  reader.pop();
  assertThat(reader.getColumnPosition(),is(0));
  assertThat(reader.getLinePosition(),is(4));
  reader.pop();
  reader.pop();
  assertThat(reader.getColumnPosition(),is(0));
  assertThat(reader.getLinePosition(),is(5));
}
