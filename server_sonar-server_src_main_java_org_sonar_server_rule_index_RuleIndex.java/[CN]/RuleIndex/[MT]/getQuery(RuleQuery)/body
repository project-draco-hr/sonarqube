{
  String queryText=query.getQueryText();
  if (queryText == null || queryText.isEmpty()) {
    return QueryBuilders.matchAllQuery();
  }
  BoolQueryBuilder qb=QueryBuilders.boolQuery();
  String queryString=query.getQueryText();
  qb.should(QueryBuilders.simpleQueryStringQuery(query.getQueryText()).field(RuleNormalizer.RuleField.NAME.field() + "." + IndexField.SEARCH_WORDS_SUFFIX,20f).field(RuleNormalizer.RuleField.HTML_DESCRIPTION.field() + "." + IndexField.SEARCH_WORDS_SUFFIX,3f).defaultOperator(SimpleQueryStringBuilder.Operator.AND)).boost(20f);
  qb.should(this.termQuery(RuleNormalizer.RuleField.KEY,queryString,15f));
  qb.should(this.termQuery(RuleNormalizer.RuleField._KEY,queryString,35f));
  qb.should(this.termQuery(RuleNormalizer.RuleField.LANGUAGE,queryString,3f));
  qb.should(this.termQuery(RuleNormalizer.RuleField.CHARACTERISTIC,queryString,5f));
  qb.should(this.termQuery(RuleNormalizer.RuleField.SUB_CHARACTERISTIC,queryString,5f));
  qb.should(this.termQuery(RuleNormalizer.RuleField.ALL_TAGS,queryString,10f));
  qb.should(this.termAnyQuery(RuleNormalizer.RuleField.CHARACTERISTIC,queryString,1f));
  qb.should(this.termAnyQuery(RuleNormalizer.RuleField.SUB_CHARACTERISTIC,queryString,1f));
  qb.should(this.termAnyQuery(RuleNormalizer.RuleField.ALL_TAGS,queryString,1f));
  return qb;
}
