{
  String queryText=query.getQueryText();
  if (query.getSortField() != null) {
    FieldSortBuilder sort=SortBuilders.fieldSort(query.getSortField());
    if (query.isAscendingSort()) {
      sort.order(SortOrder.ASC);
    }
 else {
      sort.order(SortOrder.DESC);
    }
    esSearch.addSort(sort);
  }
 else   if (queryText != null && !queryText.isEmpty()) {
    esSearch.addSort(SortBuilders.scoreSort());
  }
 else {
    esSearch.addSort(RuleNormalizer.RuleField.UPDATED_AT.sortField(),SortOrder.DESC);
    esSearch.addSort(RuleNormalizer.RuleField.KEY.sortField(),SortOrder.ASC);
  }
}
