{
  Map<String,AggregationBuilder> aggregations=new HashMap<String,AggregationBuilder>();
  StickyFacetBuilder stickyFacetBuilder=stickyFacetBuilder(queryBuilder,filters);
  addDefaultFacets(query,options,queryBuilder,filters,aggregations,stickyFacetBuilder);
  if (options.facets().contains(FACET_STATUSES)) {
    aggregations.put(FACET_STATUSES,stickyFacetBuilder.buildStickyFacet(RuleNormalizer.RuleField.STATUS.field(),FACET_STATUSES,ALL_STATUSES.toArray()));
  }
  if (options.facets().contains(FACET_SEVERITIES)) {
    aggregations.put(FACET_SEVERITIES,stickyFacetBuilder.buildStickyFacet(RuleNormalizer.RuleField.SEVERITY.field(),FACET_SEVERITIES,Severity.ALL.toArray()));
  }
  return aggregations;
}
