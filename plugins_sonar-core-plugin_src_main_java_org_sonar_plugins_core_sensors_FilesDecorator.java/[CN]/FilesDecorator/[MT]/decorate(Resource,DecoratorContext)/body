{
  if (MeasureUtils.hasValue(context.getMeasure(CoreMetrics.FILES))) {
    checkRootProjectHasFiles(resource,context.getMeasure(CoreMetrics.FILES).getValue());
    return;
  }
  if (Resource.QUALIFIER_CLASS.equals(resource.getQualifier()) || Resource.QUALIFIER_FILE.equals(resource.getQualifier())) {
    context.saveMeasure(CoreMetrics.FILES,1.0);
  }
 else {
    Collection<Measure> childrenMeasures=context.getChildrenMeasures(CoreMetrics.FILES);
    Double sum=MeasureUtils.sum(false,childrenMeasures);
    checkRootProjectHasFiles(resource,sum);
    if (sum != null) {
      context.saveMeasure(CoreMetrics.FILES,sum);
    }
  }
}
