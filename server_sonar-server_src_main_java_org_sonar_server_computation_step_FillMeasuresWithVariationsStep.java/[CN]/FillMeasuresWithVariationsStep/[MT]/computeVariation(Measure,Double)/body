{
switch (measure.getValueType()) {
case INT:
    return measure.getIntValue() - pastValue;
case LONG:
  return measure.getLongValue() - pastValue;
case DOUBLE:
return measure.getDoubleValue() - pastValue;
case BOOLEAN:
return (measure.getBooleanValue() ? 1d : 0d) - pastValue;
default :
throw new IllegalArgumentException("Unsupported Measure.ValueType " + measure.getValueType());
}
}
