{
  int total=dbClient.permissionTemplateDao().countGroups(dbSession,query,template.getId());
  List<GroupWithPermissionDto> groupsWithPermission=dbClient.permissionTemplateDao().selectGroups(dbSession,query,template.getId(),query.pageOffset(),query.pageSize());
  WsTemplateGroupsResponse.Builder groupsResponse=WsTemplateGroupsResponse.newBuilder();
  for (  GroupWithPermissionDto groupWithPermission : groupsWithPermission) {
    groupsResponse.addGroups(groupDtoToGroupResponse(groupWithPermission));
  }
  groupsResponse.getPagingBuilder().setPageIndex(query.pageIndex()).setPageSize(query.pageSize()).setTotal(total).build();
  return groupsResponse.build();
}
