{
  StopWatch fullProfile=profiling.start("es",Profiling.Level.FULL);
  StopWatch basicProfile=profiling.start("es",Profiling.Level.BASIC);
  LOG.debug("UPDATE _id:{} in index {}",key,this.getIndexName());
  BulkRequestBuilder bulkRequest=getClient().prepareBulk();
  for (  UpdateRequest request : requests) {
    if (request.id() == null || request.id().isEmpty()) {
      bulkRequest.add(new IndexRequest().source(request.doc().sourceAsMap()).type(this.getIndexType()).index(this.getIndexName()));
    }
 else {
      bulkRequest.add(request.id(this.getKeyValue(key)).index(this.getIndexName()).type(this.getIndexType()));
    }
  }
  basicProfile.stop(bulkRequest.toString());
  BulkResponse response=bulkRequest.get();
  fullProfile.stop(response.toString());
}
