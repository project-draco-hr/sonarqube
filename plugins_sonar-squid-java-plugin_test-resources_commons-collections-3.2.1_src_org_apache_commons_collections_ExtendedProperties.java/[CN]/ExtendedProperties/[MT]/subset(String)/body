{
  ExtendedProperties c=new ExtendedProperties();
  Iterator keys=getKeys();
  boolean validSubset=false;
  while (keys.hasNext()) {
    Object key=keys.next();
    if (key instanceof String && ((String)key).startsWith(prefix)) {
      if (!validSubset) {
        validSubset=true;
      }
      String newKey=null;
      if (((String)key).length() == prefix.length()) {
        newKey=prefix;
      }
 else {
        newKey=((String)key).substring(prefix.length() + 1);
      }
      c.addPropertyDirect(newKey,get(key));
    }
  }
  if (validSubset) {
    return c;
  }
 else {
    return null;
  }
}
