{
  OrchestratorBuilder builder=Orchestrator.builderEnv();
  builder.setSonarVersion("DEV");
  builder.addPlugin(MavenLocation.create("com.sonarsource.xoo","sonar-xoo-plugin","1.0-SNAPSHOT"));
  orchestrator=builder.build();
  orchestrator.start();
  String json=orchestrator.getServer().wsClient().get("/api/rules/search",Collections.<String,Object>emptyMap());
  assertThat(json).startsWith("{").endsWith("}");
  orchestrator.executeBuild(SonarRunner.create(new File("src/test/projects/xoo-sample")));
  orchestrator.stop();
  try {
    orchestrator.getServer().wsClient().get("/api/rules/search",Collections.<String,Object>emptyMap());
    fail("Server is not stopped");
  }
 catch (  Exception e) {
  }
}
