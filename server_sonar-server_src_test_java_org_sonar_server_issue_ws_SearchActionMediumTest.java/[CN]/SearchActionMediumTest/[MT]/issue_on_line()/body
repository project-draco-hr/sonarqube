{
  db.userDao().insert(session,new UserDto().setLogin("simon").setName("Simon").setEmail("simon@email.com"));
  db.userDao().insert(session,new UserDto().setLogin("fabrice").setName("Fabrice").setEmail("fabrice@email.com"));
  IssueDto issue=IssueTesting.newDto(rule,file,project).setLine(3).setRule(rule).setDebt(10L).setRootComponent(project).setComponent(file).setStatus("OPEN").setResolution("OPEN").setKee("82fd47d4-b650-4037-80bc-7b112bd4eac2").setSeverity("MAJOR").setAuthorLogin("John").setAssignee("simon").setReporter("fabrice").setIssueCreationDate(DateUtils.parseDate("2014-09-04")).setIssueUpdateDate(DateUtils.parseDate("2014-12-04"));
  db.issueDao().insert(session,issue);
  session.commit();
  WsTester.Result result=wsTester.newGetRequest(IssuesWs.API_ENDPOINT,SearchAction.SEARCH_ACTION).execute();
  result.assertJson(this.getClass(),"issue_with_snippet.json",false);
}
