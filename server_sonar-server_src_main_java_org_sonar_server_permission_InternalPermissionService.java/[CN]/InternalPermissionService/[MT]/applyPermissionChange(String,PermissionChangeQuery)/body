{
  DbSession session=dbClient.openSession(false);
  boolean changed;
  try {
    if (permissionChangeQuery.targetsUser()) {
      changed=applyUserPermissionChange(session,operation,permissionChangeQuery);
    }
 else {
      changed=applyGroupPermissionChange(session,operation,permissionChangeQuery);
    }
    if (changed) {
      session.commit();
    }
  }
  finally {
    session.close();
  }
  if (changed) {
    synchronizePermissions();
  }
}
