{
  if (projectKey == null) {
    userSession.checkGlobalPermission(GlobalPermissions.SYSTEM_ADMIN);
  }
 else {
    if (!userSession.hasGlobalPermission(GlobalPermissions.SYSTEM_ADMIN) && !userSession.hasProjectPermission(UserRole.ADMIN,projectKey)) {
      throw new ForbiddenException("Insufficient privileges");
    }
  }
}
