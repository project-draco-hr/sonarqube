{
  for (  Map.Entry<String,Map<Integer,Object>> entry : map.entrySet()) {
    String metricKey=entry.getKey();
    org.sonar.api.batch.measure.Metric<String> metric=metricFinder.findByKey(metricKey);
    if (metric == null) {
      throw new IllegalStateException("Unable to find metric with key: " + metricKey);
    }
    Map<Integer,Object> lines=entry.getValue();
    String data=KeyValueFormat.format(lines);
    new DefaultMeasure<String>(sensorStorage).forMetric(metric).onFile(inputFile).withValue(data).save();
    entry.setValue(ImmutableMap.copyOf(lines));
  }
}
