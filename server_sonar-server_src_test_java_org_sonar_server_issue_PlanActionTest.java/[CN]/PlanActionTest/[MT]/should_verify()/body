{
  String planKey="ABCD";
  Map<String,Object> properties=newHashMap();
  properties.put("plan",planKey);
  ActionPlan actionPlan=new DefaultActionPlan().setProjectKey("struts");
  List<Issue> issues=newArrayList((Issue)new DefaultIssue().setKey("ABC").setProjectKey("struts"));
  when(actionPlanService.findByKey(eq(planKey),any(ThreadLocalUserSession.class))).thenReturn(actionPlan);
  assertThat(action.verify(properties,issues,mock(ThreadLocalUserSession.class))).isTrue();
  assertThat(properties.get(PlanAction.VERIFIED_ACTION_PLAN)).isEqualTo(actionPlan);
}
