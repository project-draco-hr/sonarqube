{
  List<ModuleQProfiles.QProfile> profiles=Lists.newArrayList();
  for (  String language : fs.languages()) {
    ModuleQProfiles.QProfile qProfile=moduleQProfiles.findByLanguage(language);
    if (qProfile != null) {
      dao.updateUsedColumn(qProfile.id(),true);
      profiles.add(qProfile);
    }
  }
  UsedQProfiles used=UsedQProfiles.fromProfiles(profiles);
  Measure detailsMeasure=new Measure(CoreMetrics.QUALITY_PROFILES,used.toJSON());
  context.saveMeasure(detailsMeasure);
  if (profiles.size() == 1) {
    ModuleQProfiles.QProfile qProfile=profiles.get(0);
    Measure measure=new Measure(CoreMetrics.PROFILE,qProfile.name()).setValue((double)qProfile.id());
    Measure measureVersion=new Measure(CoreMetrics.PROFILE_VERSION,qProfile.version().doubleValue());
    context.saveMeasure(measure);
    context.saveMeasure(measureVersion);
  }
}
