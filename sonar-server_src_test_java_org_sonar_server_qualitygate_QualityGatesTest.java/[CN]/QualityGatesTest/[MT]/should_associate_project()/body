{
  Long qGateId=42L;
  Long projectId=24L;
  when(dao.selectById(qGateId)).thenReturn(new QualityGateDto().setId(qGateId));
  when(componentDao.selectComponent(any(ComponentQuery.class))).thenReturn(ImmutableList.of(new ComponentDto().setId(projectId)));
  qGates.associateProject(qGateId,projectId);
  verify(dao).selectById(qGateId);
  verify(componentDao).selectComponent(any(ComponentQuery.class));
  ArgumentCaptor<PropertyDto> propertyCaptor=ArgumentCaptor.forClass(PropertyDto.class);
  verify(propertiesDao).setProperty(propertyCaptor.capture());
  PropertyDto property=propertyCaptor.getValue();
  assertThat(property.getKey()).isEqualTo("sonar.qualitygate");
  assertThat(property.getResourceId()).isEqualTo(projectId);
  assertThat(property.getValue()).isEqualTo("42");
}
