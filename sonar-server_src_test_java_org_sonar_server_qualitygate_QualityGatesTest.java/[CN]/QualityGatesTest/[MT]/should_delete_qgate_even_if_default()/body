{
  long idToDelete=42L;
  String name="To Delete";
  QualityGateDto toDelete=new QualityGateDto().setId(idToDelete).setName(name);
  when(dao.selectById(idToDelete)).thenReturn(toDelete);
  when(propertiesDao.selectGlobalProperty("sonar.qualitygate")).thenReturn(new PropertyDto().setValue("42"));
  SonarSession session=mock(SonarSession.class);
  when(myBatis.openSession()).thenReturn(session);
  qGates.delete(idToDelete);
  verify(dao).selectById(idToDelete);
  verify(propertiesDao).deleteGlobalProperty("sonar.qualitygate",session);
  verify(propertiesDao).deleteProjectProperties("sonar.qualitygate","42",session);
  verify(dao).delete(toDelete,session);
}
