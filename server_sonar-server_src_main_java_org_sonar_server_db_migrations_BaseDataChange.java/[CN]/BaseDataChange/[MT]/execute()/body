{
  Connection readConnection=null, writeConnection=null;
  try {
    readConnection=db.getDataSource().getConnection();
    readConnection.setAutoCommit(false);
    if (readConnection.getMetaData().supportsTransactionIsolationLevel(Connection.TRANSACTION_READ_UNCOMMITTED)) {
      readConnection.setTransactionIsolation(Connection.TRANSACTION_READ_UNCOMMITTED);
    }
    writeConnection=db.getDataSource().getConnection();
    writeConnection.setAutoCommit(false);
    Context context=new Context(db,readConnection,writeConnection);
    execute(context);
  }
  finally {
    DbUtils.closeQuietly(readConnection);
    DbUtils.closeQuietly(writeConnection);
  }
}
