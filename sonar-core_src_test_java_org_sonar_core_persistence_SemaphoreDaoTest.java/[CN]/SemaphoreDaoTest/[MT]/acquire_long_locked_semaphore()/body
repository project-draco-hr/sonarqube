{
  setupData("old_semaphore");
  SemaphoreDao dao=new SemaphoreDao(getMyBatis());
  Lock lock=dao.acquire("foo",60);
  assertThat(lock.isAcquired()).isTrue();
  assertThat(lock.getDurationSinceLocked()).isNull();
  SemaphoreDto semaphore=selectSemaphore("foo");
  assertThat(semaphore).isNotNull();
  assertThat(semaphore.getName()).isEqualTo("foo");
  assertThat(isRecent(semaphore.getCreatedAt(),10)).isFalse();
  assertThat(isRecent(semaphore.getUpdatedAt(),10)).isTrue();
  assertThat(isRecent(semaphore.getLockedAt(),10)).isTrue();
}
