{
  esSetup.client().prepareBulk().add(Requests.indexRequest().index("rules").type("rule").source(testFileAsString("find_inactive_rules_with_tags/tags_empty.json"))).add(Requests.indexRequest().index("rules").type("rule").source(testFileAsString("find_inactive_rules_with_tags/tags_a.json"))).add(Requests.indexRequest().index("rules").type("rule").source(testFileAsString("find_inactive_rules_with_tags/tags_ab.json"))).add(Requests.indexRequest().index("rules").type("rule").source(testFileAsString("find_inactive_rules_with_tags/tags_bc.json"))).setRefresh(true).execute().actionGet();
  Paging paging=Paging.create(10,1);
  List<QProfileRule> rules=profileRules.searchInactives(ProfileRuleQuery.create(1).setLanguage("xoo"),paging).rules();
  assertThat(rules).hasSize(4);
  assertThat(rules.get(0).systemTags()).containsOnly("taga");
  assertThat(rules.get(0).adminTags()).isEmpty();
  assertThat(rules.get(1).systemTags()).containsOnly("tagb");
  assertThat(rules.get(1).adminTags()).containsOnly("taga");
  assertThat(rules.get(2).systemTags()).containsOnly("tagb","tagc");
  assertThat(rules.get(2).adminTags()).isEmpty();
  assertThat(rules.get(3).systemTags()).isEmpty();
  assertThat(rules.get(3).adminTags()).isEmpty();
}
