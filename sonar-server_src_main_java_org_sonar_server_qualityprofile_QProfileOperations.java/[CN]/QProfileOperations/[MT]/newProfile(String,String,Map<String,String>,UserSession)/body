{
  DbSession session=db.openSession(false);
  try {
    QProfile profile=newProfile(name,language,true,userSession,session);
    QProfileResult result=new QProfileResult();
    result.setProfile(profile);
    for (    Map.Entry<String,String> entry : xmlProfilesByPlugin.entrySet()) {
      result.add(exporter.importXml(profile,entry.getKey(),entry.getValue(),session));
    }
    dryRunCache.reportGlobalModification(session);
    session.commit();
    return result;
  }
  finally {
    MyBatis.closeQuietly(session);
  }
}
