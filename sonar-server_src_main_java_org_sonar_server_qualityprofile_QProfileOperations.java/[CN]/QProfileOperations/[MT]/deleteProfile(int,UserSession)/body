{
  checkPermission(userSession);
  DbSession session=myBatis.openSession(false);
  try {
    QualityProfileDto profile=findNotNull(profileId,session);
    QProfile qProfile=QProfile.from(profile);
    if (!profileLookup.isDeletable(QProfile.from(profile),session)) {
      throw new BadRequestException("This profile can not be deleted");
    }
 else {
      deleteProfile(qProfile,session);
    }
    session.commit();
  }
  finally {
    MyBatis.closeQuietly(session);
  }
}
