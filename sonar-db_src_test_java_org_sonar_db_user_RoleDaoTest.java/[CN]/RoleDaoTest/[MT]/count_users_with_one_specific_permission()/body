{
  DbClient dbClient=db.getDbClient();
  UserDto user=dbClient.userDao().insert(db.getSession(),new UserDto().setActive(true));
  dbClient.roleDao().insertUserRole(db.getSession(),new UserPermissionDto().setUserId(user.getId()).setComponentId(123L).setPermission(GlobalPermissions.SYSTEM_ADMIN));
  dbClient.roleDao().insertUserRole(db.getSession(),new UserPermissionDto().setUserId(user.getId()).setPermission(GlobalPermissions.SYSTEM_ADMIN));
  dbClient.roleDao().insertUserRole(db.getSession(),new UserPermissionDto().setUserId(user.getId()).setPermission(GlobalPermissions.SCAN_EXECUTION));
  int result=underTest.countUserPermissions(db.getSession(),GlobalPermissions.SYSTEM_ADMIN,null);
  assertThat(result).isEqualTo(1);
}
