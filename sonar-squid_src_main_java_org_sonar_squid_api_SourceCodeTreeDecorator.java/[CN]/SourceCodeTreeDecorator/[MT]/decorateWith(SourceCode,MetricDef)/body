{
  if (sourceCode.hasChildren()) {
    for (    SourceCode child : sourceCode.getChildren()) {
      decorateWith(child,metrics);
    }
  }
  for (  MetricDef metric : metrics) {
    if (!metric.aggregateIfThereIsAlreadyAValue() && sourceCode.getDouble(metric) != 0) {
      continue;
    }
    if (sourceCode.hasChildren()) {
      for (      SourceCode child : sourceCode.getChildren()) {
        if (!metric.isCalculatedMetric() && metric.isThereAggregationFormula()) {
          sourceCode.add(metric,child);
        }
      }
    }
  }
}
