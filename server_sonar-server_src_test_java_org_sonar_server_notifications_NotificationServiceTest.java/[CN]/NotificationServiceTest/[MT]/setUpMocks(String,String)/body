{
  when(emailChannel.getKey()).thenReturn("email");
  when(gtalkChannel.getKey()).thenReturn("gtalk");
  when(commentOnReviewAssignedToMe.getKey()).thenReturn("comment on review assigned to me");
  when(commentOnReviewCreatedByMe.getKey()).thenReturn("comment on review created by me");
  when(manager.getFromQueue()).thenReturn(notification).thenReturn(null);
  Settings settings=new Settings().setProperty("sonar.notifications.delay",1L);
  service=new NotificationService(settings,manager,mock(DatabaseSessionFactory.class),new NotificationDispatcher[]{commentOnReviewAssignedToMe,commentOnReviewCreatedByMe});
}
