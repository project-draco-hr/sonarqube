{
  when(lastSnapshots.getSource(project)).thenReturn(load("example1-v1"));
  when(index.getSource(project)).thenReturn(load("example1-v2"));
  sourceHashHolder=new SourceHashHolder(index,lastSnapshots,project);
  IssueDto referenceIssue1=newReferenceIssue("Indentation",7,"squid","AvoidCycle",null);
  IssueDto referenceIssue2=newReferenceIssue("Indentation",11,"squid","AvoidCycle",null);
  DefaultIssue newIssue1=newDefaultIssue("Indentation",9,RuleKey.of("squid","AvoidCycle"),null);
  DefaultIssue newIssue2=newDefaultIssue("Indentation",13,RuleKey.of("squid","AvoidCycle"),null);
  DefaultIssue newIssue3=newDefaultIssue("Indentation",17,RuleKey.of("squid","AvoidCycle"),null);
  DefaultIssue newIssue4=newDefaultIssue("Indentation",21,RuleKey.of("squid","AvoidCycle"),null);
  IssueTrackingResult result=new IssueTrackingResult();
  tracking.mapIssues(Arrays.asList(newIssue1,newIssue2,newIssue3,newIssue4),Arrays.asList(referenceIssue1,referenceIssue2),sourceHashHolder,result);
  assertThat(result.matching(newIssue1)).isNull();
  assertThat(result.matching(newIssue2)).isNull();
  assertThat(result.matching(newIssue3)).isSameAs(referenceIssue1);
  assertThat(result.matching(newIssue4)).isSameAs(referenceIssue2);
}
