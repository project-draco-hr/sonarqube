{
  when(lastSnapshots.getSource(project)).thenReturn(load("example2-v1"));
  String source=load("example2-v2");
  IssueDto referenceIssue1=newReferenceIssue("SystemPrintln",5,1,null);
  DefaultIssue newIssue1=newDefaultIssue("SystemPrintln",6,RuleKey.of("squid","AvoidCycle"),null);
  DefaultIssue newIssue2=newDefaultIssue("SystemPrintln",10,RuleKey.of("squid","AvoidCycle"),null);
  DefaultIssue newIssue3=newDefaultIssue("SystemPrintln",14,RuleKey.of("squid","AvoidCycle"),null);
  Map<DefaultIssue,IssueDto> mapping=decorator.mapIssues(Arrays.asList(newIssue1,newIssue2,newIssue3),Arrays.asList(referenceIssue1),source,project);
  assertThat(newIssue1.isNew()).isTrue();
  assertThat(newIssue2.isNew()).isFalse();
  assertThat(mapping.get(newIssue2)).isEqualTo(referenceIssue1);
  assertThat(newIssue3.isNew()).isTrue();
}
