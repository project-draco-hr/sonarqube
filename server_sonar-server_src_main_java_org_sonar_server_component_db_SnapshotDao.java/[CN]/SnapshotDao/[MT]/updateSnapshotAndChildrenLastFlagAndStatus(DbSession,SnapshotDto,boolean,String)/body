{
  Long rootId=snapshot.getId();
  String path=snapshot.getPath() + snapshot.getId() + ".%";
  Long pathRootId=componentRootIdOrSelfIfRootOf(snapshot);
  return mapper(session).updateSnapshotAndChildrenLastFlagAndStatus(rootId,pathRootId,path,isLast,status);
}
