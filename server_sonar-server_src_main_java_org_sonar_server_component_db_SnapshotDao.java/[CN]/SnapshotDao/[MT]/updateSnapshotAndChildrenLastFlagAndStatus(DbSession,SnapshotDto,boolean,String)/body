{
  Long rootId=snapshot.getId();
  String path=snapshot.getPath() + snapshot.getId() + ".%";
  Long pathRootId=snapshot.getRootId() == null ? snapshot.getId() : snapshot.getRootId();
  return mapper(session).updateSnapshotAndChildrenLastFlagAndStatus(rootId,pathRootId,path,isLast,status);
}
