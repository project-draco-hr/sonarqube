{
  Long rootId=snapshot.getId();
  String path=snapshot.getPath() + snapshot.getId() + ".%";
  Long pathRootId=componentRootIdOrSelfIfRootOf(snapshot);
  return mapper(session).updateSnapshotAndChildrenLastFlag(rootId,pathRootId,path,isLast);
}
