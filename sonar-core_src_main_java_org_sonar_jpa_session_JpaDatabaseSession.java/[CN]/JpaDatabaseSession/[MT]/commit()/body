{
  if (inTransaction) {
    if (getEntityManager().isOpen()) {
      if (getEntityManager().getTransaction().getRollbackOnly()) {
        getEntityManager().getTransaction().rollback();
      }
 else {
        getEntityManager().getTransaction().commit();
      }
      getEntityManager().clear();
      index=0;
    }
    inTransaction=false;
  }
}
