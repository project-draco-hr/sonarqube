{
  JSONObject root=new JSONObject();
  final GraphSONUtility graphson=new GraphSONUtility(mode,null,vertexPropertyKeys,edgePropertyKeys);
  root.put(GraphSONTokens.MODE,mode.toString());
  JSONArray verticesArray=new JSONArray();
  for (  Vertex v : this.graph.getVertices()) {
    verticesArray.add(graphson.objectNodeFromElement(v));
  }
  root.put(GraphSONTokens.VERTICES,verticesArray);
  JSONArray edgesArray=new JSONArray();
  for (  Edge e : this.graph.getEdges()) {
    edgesArray.add(graphson.objectNodeFromElement(e));
  }
  root.put(GraphSONTokens.EDGES,edgesArray);
  jsonOutputStream.write(root.toString().getBytes());
}
