{
  MetricDto metric=newCustomEnabledMetric(1);
  metricDao.insert(dbSession,metric);
  CustomMeasureDto customMeasure=CustomMeasureTesting.newDto().setMetricId(metric.getId());
  CustomMeasureDto undeletedCustomMeasure=CustomMeasureTesting.newDto().setMetricId(metric.getId() + 1);
  dbClient.customMeasureDao().insert(dbSession,customMeasure);
  dbClient.customMeasureDao().insert(dbSession,undeletedCustomMeasure);
  dbSession.commit();
  newRequest().setParam("keys","key-1").execute();
  assertThat(dbClient.customMeasureDao().selectNullableById(dbSession,customMeasure.getId())).isNull();
  assertThat(dbClient.customMeasureDao().selectNullableById(dbSession,undeletedCustomMeasure.getId())).isNotNull();
}
