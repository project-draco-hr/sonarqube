{
  Reader reader=new InputStreamReader(getClass().getResourceAsStream("/org/sonar/api/profiles/XMLProfileImporterTest/importProfile.xml"),CharEncoding.UTF_8);
  try {
    ValidationMessages validation=ValidationMessages.create();
    RuleFinder ruleFinder=newRuleFinder();
    RulesProfile profile=XMLProfileImporter.create(ruleFinder).importProfile(reader,validation);
    assertThat(profile.getLanguage(),is("java"));
    assertThat(profile.getName(),is("sonar way"));
    assertThat(validation.hasErrors(),is(false));
    assertNotNull(profile);
    assertThat(profile.getActiveRule("checkstyle","IllegalRegexp").getPriority(),is(RulePriority.CRITICAL));
  }
  finally {
    IOUtils.closeQuietly(reader);
  }
}
