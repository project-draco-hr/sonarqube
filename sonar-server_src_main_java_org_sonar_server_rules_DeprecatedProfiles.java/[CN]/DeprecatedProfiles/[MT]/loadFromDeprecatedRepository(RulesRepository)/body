{
  List<ProfileDefinition> result=new ArrayList<ProfileDefinition>();
  for (int index=0; index < repository.getProvidedProfiles().size(); index++) {
    RulesProfile deprecated=(RulesProfile)repository.getProvidedProfiles().get(index);
    DefaultProfileDefinition providedProfile=DefaultProfileDefinition.create(deprecated.getName(),repository.getLanguage().getKey());
    for (    ActiveRule deprecatedActiveRule : deprecated.getActiveRules(true)) {
      String repositoryKey=deprecatedActiveRule.getRepositoryKey();
      if (StringUtils.isBlank(repositoryKey)) {
        repositoryKey=getPluginKey(repository);
      }
      Rule rule=ruleFinder.findByKey(repositoryKey,deprecatedActiveRule.getRuleKey());
      if (rule != null) {
        ActiveRule activeRule=providedProfile.activateRule(rule,deprecatedActiveRule.getSeverity());
        for (        ActiveRuleParam arp : deprecatedActiveRule.getActiveRuleParams()) {
          activeRule.setParameter(arp.getKey(),arp.getValue());
        }
      }
    }
    result.add(providedProfile);
  }
  return result;
}
