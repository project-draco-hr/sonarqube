{
  for (  InputFile inputFile : files) {
    Resource sonarFile;
    if (Java.KEY.equals(languageKey)) {
      sonarFile=JavaFile.create(inputFile.path(),inputFile.attribute(InputFile.ATTRIBUTE_SOURCE_RELATIVE_PATH),unitTest);
    }
 else {
      sonarFile=File.create(inputFile.path(),inputFile.attribute(InputFile.ATTRIBUTE_SOURCE_RELATIVE_PATH),languages.get(languageKey),unitTest);
    }
    if (sonarFile != null) {
      sonarIndex.index(sonarFile);
      try {
        if (importSource) {
          String source=Files.toString(inputFile.file(),inputFile.encoding());
          source=CharMatcher.anyOf("\uFEFF").removeFrom(source);
          sonarIndex.setSource(sonarFile,source);
        }
      }
 catch (      Exception e) {
        throw new SonarException("Unable to read and import the source file : '" + inputFile.absolutePath() + "' with the charset : '"+ inputFile.encoding()+ "'.",e);
      }
    }
  }
}
