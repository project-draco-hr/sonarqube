{
  File file=new File("org/foo/Bar.java");
  Violation violation1=Violation.create(rule,file);
  index.addViolation(violation1);
  Violation violation2=Violation.create(rule,file);
  violation2.setSwitchedOff(true);
  index.addViolation(violation2);
  Violation violation3=Violation.create(rule,file);
  violation3.setSwitchedOff(true);
  index.addViolation(violation3);
  assertThat(index.getViolations(ViolationQuery.create().forResource(file).setSwitchedOff(true)).size(),is(2));
}
