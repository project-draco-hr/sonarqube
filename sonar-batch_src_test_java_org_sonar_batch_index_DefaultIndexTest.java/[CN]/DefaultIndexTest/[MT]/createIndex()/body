{
  index=new DefaultIndex(mock(PersistenceManager.class),new DefaultResourceCreationLock(),mock(ProjectTree.class),mock(MetricFinder.class));
  Project project=new Project("project");
  ResourceFilter filter=new ResourceFilter(){
    public boolean isIgnored(    Resource resource){
      return StringUtils.containsIgnoreCase(resource.getKey(),"excluded");
    }
  }
;
  index.setCurrentProject(project,new ResourceFilters(new ResourceFilter[]{filter}),new ViolationFilters(),RulesProfile.create());
  index.doStart(project);
}
