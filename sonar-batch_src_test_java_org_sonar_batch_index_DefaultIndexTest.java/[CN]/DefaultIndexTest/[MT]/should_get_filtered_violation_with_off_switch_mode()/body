{
  Rule rule=Rule.create("repoKey","ruleKey","Rule");
  File file=new File("org/foo/Bar.java");
  Violation violation=Violation.create(rule,file).setSwitchedOff(true);
  when(deprecatedViolations.get(anyString())).thenReturn(newArrayList(violation));
  index.addViolation(violation);
  assertThat(index.getViolations(ViolationQuery.create().forResource(file).setSwitchMode(ViolationQuery.SwitchMode.OFF))).hasSize(1);
}
