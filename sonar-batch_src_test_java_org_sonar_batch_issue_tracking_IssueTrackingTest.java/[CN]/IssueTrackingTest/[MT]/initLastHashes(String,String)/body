{
  DefaultInputFile inputFile=mock(DefaultInputFile.class);
  File f=temp.newFile();
  when(inputFile.path()).thenReturn(f.toPath());
  when(inputFile.file()).thenReturn(f);
  when(inputFile.charset()).thenReturn(StandardCharsets.UTF_8);
  String data=load(newSource);
  when(inputFile.lines()).thenReturn(StringUtils.countMatches(data,"\n") + 1);
  FileUtils.write(f,data,StandardCharsets.UTF_8);
  when(inputFile.key()).thenReturn("foo:Action.java");
  when(lastSnapshots.getLineHashes("foo:Action.java")).thenReturn(computeHexHashes(load(reference)));
  sourceHashHolder=new SourceHashHolder(inputFile,lastSnapshots);
}
