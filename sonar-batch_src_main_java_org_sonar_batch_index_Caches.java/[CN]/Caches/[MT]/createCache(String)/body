{
  Preconditions.checkState(volume != null && volume.isOpened(),"Caches are not started");
  Preconditions.checkState(!cacheNames.contains(cacheName),"Cache is already created: " + cacheName);
  try {
    Exchange exchange=persistit.getExchange(volume,cacheName,true);
    Cache<K,V> cache=new Cache<K,V>(cacheName,exchange);
    cacheNames.add(cacheName);
    return cache;
  }
 catch (  Exception e) {
    throw new IllegalStateException("Fail to create cache: " + cacheName,e);
  }
}
