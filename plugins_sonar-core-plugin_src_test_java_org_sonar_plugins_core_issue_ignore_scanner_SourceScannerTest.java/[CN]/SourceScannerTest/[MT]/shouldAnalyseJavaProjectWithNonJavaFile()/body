{
  File sourceFile=new File("src/main/java/Foo.java");
  File otherFile=new File("other.js");
  when(project.getLanguageKey()).thenReturn("java");
  List<File> empty=Collections.emptyList();
  when(fileSystem.files(Mockito.isA(FileQuery.class))).thenReturn(Arrays.asList(sourceFile,otherFile)).thenReturn(empty);
  when(fileSystem.sourceDirs()).thenReturn(ImmutableList.of(new File("src/main/java"),new File("")));
  when(fileSystem.testDirs()).thenReturn(ImmutableList.of(new File("src/test/java")));
  when(exclusionPatternInitializer.hasFileContentPattern()).thenReturn(true);
  scanner.analyse(project,null);
  verify(inclusionPatternInitializer).initializePatternsForPath("Foo.java","polop:[default].Foo");
  verify(exclusionPatternInitializer).initializePatternsForPath("Foo.java","polop:[default].Foo");
  verify(regexpScanner).scan("polop:[default].Foo",sourceFile,UTF_8);
  verify(regexpScanner,never()).scan("other.js",otherFile,UTF_8);
}
