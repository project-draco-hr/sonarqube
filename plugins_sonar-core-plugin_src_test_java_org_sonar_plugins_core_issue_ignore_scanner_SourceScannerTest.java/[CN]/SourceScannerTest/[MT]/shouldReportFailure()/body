{
  File phpFile1=new File(baseDir,"src/Foo.php");
  when(fs.inputFiles(FileQuery.all())).thenReturn((Iterable)Arrays.asList(new InputFileBuilder(phpFile1,Charsets.UTF_8,"src/Foo.php").attribute(DefaultInputFile.ATTRIBUTE_COMPONENT_KEY,"polop:src/Foo.php").build()));
  when(exclusionPatternInitializer.hasFileContentPattern()).thenReturn(true);
  doThrow(new IOException("BUG")).when(regexpScanner).scan("polop:src/Foo.php",phpFile1,UTF_8);
  thrown.expect(SonarException.class);
  thrown.expectMessage("Unable to read the source file");
  scanner.analyse(project,null);
}
