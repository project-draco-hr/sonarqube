{
  db.issueDao().insert(session,IssueTesting.newDto(rule,file,project).setStatus(Issue.STATUS_OPEN),IssueTesting.newDto(rule,file,project).setStatus(Issue.STATUS_CLOSED),IssueTesting.newDto(rule,file,project).setStatus(Issue.STATUS_REOPENED));
  session.commit();
  IssueQuery.Builder query=IssueQuery.builder().sort(IssueQuery.SORT_BY_STATUS).asc(true);
  Result<Issue> result=index.search(query.build(),new QueryContext());
  assertThat(result.getHits().get(0).status()).isEqualTo(Issue.STATUS_CLOSED);
  assertThat(result.getHits().get(1).status()).isEqualTo(Issue.STATUS_OPEN);
  assertThat(result.getHits().get(2).status()).isEqualTo(Issue.STATUS_REOPENED);
  query=IssueQuery.builder().sort(IssueQuery.SORT_BY_STATUS).asc(false);
  result=index.search(query.build(),new QueryContext());
  assertThat(result.getHits().get(0).status()).isEqualTo(Issue.STATUS_REOPENED);
  assertThat(result.getHits().get(1).status()).isEqualTo(Issue.STATUS_OPEN);
  assertThat(result.getHits().get(2).status()).isEqualTo(Issue.STATUS_CLOSED);
}
