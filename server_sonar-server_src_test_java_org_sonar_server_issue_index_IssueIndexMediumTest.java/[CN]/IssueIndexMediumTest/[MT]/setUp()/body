{
  tester.clearDbAndIndexes();
  db=tester.get(DbClient.class);
  session=db.openSession(false);
  index=tester.get(IssueIndex.class);
  rule=RuleTesting.newXooX1();
  tester.get(RuleDao.class).insert(session,rule);
  project=new ComponentDto().setId(1L).setKey("MyProject").setProjectId_unit_test_only(1L);
  tester.get(ComponentDao.class).insert(session,project);
  file=new ComponentDto().setProjectId_unit_test_only(1L).setKey("MyComponent").setId(2L);
  tester.get(ComponentDao.class).insert(session,file);
  tester.get(PermissionFacade.class).insertGroupPermission(project.getId(),DefaultGroups.ANYONE,UserRole.USER,session);
  db.issueAuthorizationDao().synchronizeAfter(session,new Date(0));
  MockUserSession.set();
  session.commit();
  session.clearCache();
}
