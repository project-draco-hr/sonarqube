{
  db.issueDao().insert(session,IssueTesting.newDto(rule,file,project).setSeverity(Severity.BLOCKER),IssueTesting.newDto(rule,file,project).setSeverity(Severity.INFO),IssueTesting.newDto(rule,file,project).setSeverity(Severity.MINOR),IssueTesting.newDto(rule,file,project).setSeverity(Severity.CRITICAL),IssueTesting.newDto(rule,file,project).setSeverity(Severity.MAJOR));
  session.commit();
  index();
  IssueQuery.Builder query=IssueQuery.builder().sort(IssueQuery.SORT_BY_SEVERITY).asc(true);
  Result<Issue> result=index.search(query.build(),new QueryContext());
  assertThat(result.getHits().get(0).severity()).isEqualTo(Severity.INFO);
  assertThat(result.getHits().get(1).severity()).isEqualTo(Severity.MINOR);
  assertThat(result.getHits().get(2).severity()).isEqualTo(Severity.MAJOR);
  assertThat(result.getHits().get(3).severity()).isEqualTo(Severity.CRITICAL);
  assertThat(result.getHits().get(4).severity()).isEqualTo(Severity.BLOCKER);
  query=IssueQuery.builder().sort(IssueQuery.SORT_BY_SEVERITY).asc(false);
  result=index.search(query.build(),new QueryContext());
  assertThat(result.getHits().get(0).severity()).isEqualTo(Severity.BLOCKER);
  assertThat(result.getHits().get(1).severity()).isEqualTo(Severity.CRITICAL);
  assertThat(result.getHits().get(2).severity()).isEqualTo(Severity.MAJOR);
  assertThat(result.getHits().get(3).severity()).isEqualTo(Severity.MINOR);
  assertThat(result.getHits().get(4).severity()).isEqualTo(Severity.INFO);
}
