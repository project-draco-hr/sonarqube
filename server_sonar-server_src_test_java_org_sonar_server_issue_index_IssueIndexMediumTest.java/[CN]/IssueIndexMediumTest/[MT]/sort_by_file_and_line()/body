{
  ComponentDto project=ComponentTesting.newProjectDto();
  ComponentDto file1=ComponentTesting.newFileDto(project,"F1").setPath("src/main/xoo/org/sonar/samples/File.xoo");
  ComponentDto file2=ComponentTesting.newFileDto(project,"F2").setPath("src/main/xoo/org/sonar/samples/File2.xoo");
  indexIssues(IssueTesting.newDoc("F1_2",file1).setLine(20),IssueTesting.newDoc("F1_1",file1).setLine(null),IssueTesting.newDoc("F1_3",file1).setLine(25),IssueTesting.newDoc("F2_1",file2).setLine(9),IssueTesting.newDoc("F2_2",file2).setLine(109),IssueTesting.newDoc("F2_3",file2).setLine(109));
  IssueQuery.Builder query=IssueQuery.builder().sort(IssueQuery.SORT_BY_FILE_LINE).asc(true);
  Result<Issue> result=index.search(query.build(),new QueryContext());
  assertThat(result.getHits()).hasSize(6);
  assertThat(result.getHits().get(0).key()).isEqualTo("F1_1");
  assertThat(result.getHits().get(1).key()).isEqualTo("F1_2");
  assertThat(result.getHits().get(2).key()).isEqualTo("F1_3");
  assertThat(result.getHits().get(3).key()).isEqualTo("F2_1");
  assertThat(result.getHits().get(4).key()).isEqualTo("F2_2");
  assertThat(result.getHits().get(5).key()).isEqualTo("F2_3");
  query=IssueQuery.builder().sort(IssueQuery.SORT_BY_FILE_LINE).asc(false);
  result=index.search(query.build(),new QueryContext());
  assertThat(result.getHits()).hasSize(6);
  assertThat(result.getHits().get(0).key()).isEqualTo("F2_3");
  assertThat(result.getHits().get(1).key()).isEqualTo("F2_2");
  assertThat(result.getHits().get(2).key()).isEqualTo("F2_1");
  assertThat(result.getHits().get(3).key()).isEqualTo("F1_3");
  assertThat(result.getHits().get(4).key()).isEqualTo("F1_2");
  assertThat(result.getHits().get(5).key()).isEqualTo("F1_1");
}
