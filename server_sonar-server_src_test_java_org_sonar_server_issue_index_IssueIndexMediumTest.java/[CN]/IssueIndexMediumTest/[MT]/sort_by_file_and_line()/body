{
  db.issueDao().insert(session,IssueTesting.newDto(rule,file,project).setLine(20).setKee("F1_2"),IssueTesting.newDto(rule,file,project).setLine(null).setKee("F1_1"),IssueTesting.newDto(rule,file,project).setLine(25).setKee("F1_3"),IssueTesting.newDto(rule,file2,project).setLine(9).setKee("F2_1"),IssueTesting.newDto(rule,file2,project).setLine(109).setKee("F2_2"),IssueTesting.newDto(rule,file2,project).setLine(109).setKee("F2_3"));
  session.commit();
  index();
  IssueQuery.Builder query=IssueQuery.builder().sort(IssueQuery.SORT_BY_FILE_LINE).asc(true);
  Result<Issue> result=index.search(query.build(),new QueryContext());
  assertThat(result.getHits()).hasSize(6);
  assertThat(result.getHits().get(0).key()).isEqualTo("F1_1");
  assertThat(result.getHits().get(1).key()).isEqualTo("F1_2");
  assertThat(result.getHits().get(2).key()).isEqualTo("F1_3");
  assertThat(result.getHits().get(3).key()).isEqualTo("F2_1");
  assertThat(result.getHits().get(4).key()).isEqualTo("F2_2");
  assertThat(result.getHits().get(5).key()).isEqualTo("F2_3");
  query=IssueQuery.builder().sort(IssueQuery.SORT_BY_FILE_LINE).asc(false);
  result=index.search(query.build(),new QueryContext());
  assertThat(result.getHits()).hasSize(6);
  assertThat(result.getHits().get(0).key()).isEqualTo("F2_3");
  assertThat(result.getHits().get(1).key()).isEqualTo("F2_2");
  assertThat(result.getHits().get(2).key()).isEqualTo("F2_1");
  assertThat(result.getHits().get(3).key()).isEqualTo("F1_3");
  assertThat(result.getHits().get(4).key()).isEqualTo("F1_2");
  assertThat(result.getHits().get(5).key()).isEqualTo("F1_1");
}
