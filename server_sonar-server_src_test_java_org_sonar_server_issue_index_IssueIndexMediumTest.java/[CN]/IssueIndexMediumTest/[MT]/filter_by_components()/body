{
  ComponentDto file1=ComponentTesting.newFileDto(project);
  ComponentDto file2=ComponentTesting.newFileDto(project);
  tester.get(ComponentDao.class).insert(session,file1,file2);
  db.issueDao().insert(session,IssueTesting.newDto(rule,file1,project),IssueTesting.newDto(rule,file2,project));
  session.commit();
  assertThat(index.search(IssueQuery.builder().components(newArrayList(file1.uuid(),file2.uuid())).build(),new QueryContext()).getHits()).hasSize(2);
  assertThat(index.search(IssueQuery.builder().components(newArrayList(file1.uuid())).build(),new QueryContext()).getHits()).hasSize(1);
  assertThat(index.search(IssueQuery.builder().components(newArrayList("unknown")).build(),new QueryContext()).getHits()).isEmpty();
  assertThat(index.search(IssueQuery.builder().components(newArrayList(project.uuid())).build(),new QueryContext()).getHits()).isEmpty();
}
