{
  DefaultIssue fileIssue=new DefaultIssue().setDebt(Duration.create(10)).setRuleKey(rule.getKey());
  DefaultIssue projectIssue=new DefaultIssue().setDebt(Duration.create(30)).setRuleKey(rule.getKey());
  underTest.beforeComponent(file);
  underTest.onIssue(file,fileIssue);
  underTest.afterComponent(file);
  underTest.beforeComponent(project);
  underTest.onIssue(project,projectIssue);
  underTest.afterComponent(project);
  assertThat(debtMeasure(project).get().getLongValue()).isEqualTo(10 + 30);
  assertThat(debtRuleMeasure(project,rule.getId()).get().getLongValue()).isEqualTo(10 + 30);
  assertThat(debtCharacteristicMeasure(project,PORTABILITY_ID).get().getLongValue()).isEqualTo(10 + 30);
  assertThat(debtCharacteristicMeasure(project,PORTABILITY_SOFT_ID).get().getLongValue()).isEqualTo(10 + 30);
  assertThat(debtCharacteristicMeasure(project,PORTABILITY_HARD_ID).isPresent()).isFalse();
  assertThat(debtCharacteristicMeasure(project,RELIABILITY_ID).get().getLongValue()).isZero();
}
