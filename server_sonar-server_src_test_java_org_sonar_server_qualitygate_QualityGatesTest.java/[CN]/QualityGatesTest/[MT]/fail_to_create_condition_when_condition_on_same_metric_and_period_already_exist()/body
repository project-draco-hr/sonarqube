{
  String metricKey="new_coverage";
  addMetric(metricKey,"New Coverage");
  when(dao.selectById(QUALITY_GATE_ID)).thenReturn(new QualityGateDto().setId(QUALITY_GATE_ID));
  when(conditionDao.selectForQualityGate(QUALITY_GATE_ID)).thenReturn(singletonList(new QualityGateConditionDto().setMetricKey(metricKey).setMetricId(METRIC_ID).setPeriod(1)));
  expectedException.expect(BadRequestException.class);
  expectedException.expectMessage("Condition on metric 'New Coverage' over leak period already exists.");
  underTest.createCondition(QUALITY_GATE_ID,metricKey,"LT","90",null,1);
}
