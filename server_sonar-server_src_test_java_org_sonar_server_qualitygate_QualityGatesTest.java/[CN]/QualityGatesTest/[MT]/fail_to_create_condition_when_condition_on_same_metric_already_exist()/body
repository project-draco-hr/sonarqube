{
  String metricKey="coverage";
  addMetric(metricKey,"Coverage");
  when(dao.selectById(QUALITY_GATE_ID)).thenReturn(new QualityGateDto().setId(QUALITY_GATE_ID));
  when(conditionDao.selectForQualityGate(QUALITY_GATE_ID)).thenReturn(singletonList(new QualityGateConditionDto().setMetricKey(metricKey).setMetricId(METRIC_ID)));
  expectedException.expect(BadRequestException.class);
  expectedException.expectMessage("Condition on metric 'Coverage' already exists.");
  underTest.createCondition(QUALITY_GATE_ID,metricKey,"LT","90",null,null);
}
