{
  settings.clear();
  when(dbClient.openSession(false)).thenReturn(dbSession);
  when(dbClient.qualityGateDao()).thenReturn(dao);
  when(dbClient.gateConditionDao()).thenReturn(conditionDao);
  when(dbClient.propertiesDao()).thenReturn(propertiesDao);
  when(dbClient.componentDao()).thenReturn(componentDao);
  when(componentDao.selectOrFailById(eq(dbSession),anyLong())).thenReturn(new ComponentDto().setId(1L).setKey(PROJECT_KEY));
  underTest=new QualityGates(dbClient,metricFinder,userSessionRule,settings);
  userSessionRule.set(authorizedProfileAdminUserSession);
}
