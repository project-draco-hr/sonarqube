{
  String login=getLoggedLogin(userSession);
  IssueFilterDto existingFilterDto=findIssueFilterDto(issueFilter.id(),login);
  verifyCurrentUserCanModifyFilter(existingFilterDto.toIssueFilter(),userSession);
  verifyCurrentUserCanChangeFilterSharingFilter(issueFilter,existingFilterDto,login);
  if (!existingFilterDto.getUserLogin().equals(issueFilter.user())) {
    verifyCurrentUserCanChangeFilterOwnership(userSession);
  }
  validateFilter(issueFilter,userSession);
  deleteOtherFavoriteFiltersIfFilterBecomeUnshared(existingFilterDto,issueFilter);
  filterDao.update(IssueFilterDto.toIssueFilter(issueFilter));
  return issueFilter;
}
