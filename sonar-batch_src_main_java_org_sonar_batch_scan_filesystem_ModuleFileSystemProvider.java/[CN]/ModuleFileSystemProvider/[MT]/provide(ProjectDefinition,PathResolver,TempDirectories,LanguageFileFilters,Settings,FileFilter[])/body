{
  if (singleton == null) {
    DefaultModuleFileSystem.Builder builder=new DefaultModuleFileSystem.Builder();
    builder.pathResolver(pathResolver);
    builder.languageFileFilters(languageFileFilters);
    builder.baseDir(module.getBaseDir());
    builder.sourceCharset(guessCharset(settings));
    builder.workingDir(guessWorkingDir(module,tempDirectories));
    initBinaryDirs(module,pathResolver,builder);
    initSources(module,pathResolver,builder);
    initTests(module,pathResolver,builder);
    initPluginFilters(builder,pluginFileFilters);
    initSourceInclusions(builder,settings);
    initTestInclusions(builder,settings);
    singleton=builder.build();
  }
  return singleton;
}
