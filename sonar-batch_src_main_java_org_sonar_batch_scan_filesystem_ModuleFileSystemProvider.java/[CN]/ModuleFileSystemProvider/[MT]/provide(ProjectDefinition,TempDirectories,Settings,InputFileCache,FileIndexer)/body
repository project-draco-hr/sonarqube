{
  if (singleton == null) {
    DefaultModuleFileSystem fs=new DefaultModuleFileSystem(module.getKey(),settings,cache,indexer);
    fs.setBaseDir(module.getBaseDir());
    fs.setBuildDir(module.getBuildDir());
    fs.setWorkingDir(guessWorkingDir(module,tempDirectories));
    initBinaryDirs(module,fs);
    initSources(module,fs);
    initTests(module,fs);
    fs.index();
    singleton=fs;
  }
  return singleton;
}
