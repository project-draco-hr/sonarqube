{
  LOG.info("Deploy Ruby on Rails applications");
  File appsDir=prepareRailsDirectory();
  for (  PluginMetadata pluginMetadata : pluginRepository.getMetadata()) {
    String pluginKey=pluginMetadata.getKey();
    Plugin plugin=pluginRepository.getPlugin(pluginKey);
    if (plugin != null) {
      try {
        deployRailsApp(appsDir,pluginKey,plugin.getClass().getClassLoader());
      }
 catch (      Exception e) {
        throw new IllegalStateException("Fail to deploy Ruby on Rails application: " + pluginKey,e);
      }
    }
  }
}
