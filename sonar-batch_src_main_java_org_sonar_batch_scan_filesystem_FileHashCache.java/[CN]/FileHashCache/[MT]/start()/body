{
  PastSnapshot pastSnapshot=pastSnapshotFinder.findPreviousAnalysis(snapshot);
  if (pastSnapshot.isRelatedToSnapshot()) {
    Collection<SnapshotDataDto> selectSnapshotData=snapshotDataDao.selectSnapshotData(pastSnapshot.getProjectSnapshot().getId().longValue(),Arrays.asList(SnapshotDataType.FILE_HASH.getValue()));
    if (!selectSnapshotData.isEmpty()) {
      SnapshotDataDto snapshotDataDto=selectSnapshotData.iterator().next();
      String data=snapshotDataDto.getData();
      try {
        List<String> lines=IOUtils.readLines(new StringReader(data));
        for (        String line : lines) {
          String[] keyValue=StringUtils.split(line,"=");
          if (keyValue.length == 2) {
            previousHashCache.put(keyValue[0],keyValue[1]);
          }
        }
      }
 catch (      IOException e) {
        throw new SonarException("Unable to read previous file hashes",e);
      }
    }
  }
}
