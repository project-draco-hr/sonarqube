{
  treeRootHolder.setRoot(ROOT_PROJECT);
  fillComponentIssuesVisitorRule.setIssues(FILE_1_REF,newVulnerabilityIssue(1L,MAJOR).setCreationDate(BEFORE_LEAK_PERIOD_DATE));
  underTest.visit(ROOT_PROJECT);
  verifyAddedRawMeasureOnLeakPeriod(FILE_1_REF,NEW_SECURITY_RATING_KEY,A);
  verifyAddedRawMeasureOnLeakPeriod(FILE_2_REF,NEW_SECURITY_RATING_KEY,A);
  verifyAddedRawMeasureOnLeakPeriod(DIRECTORY_REF,NEW_SECURITY_RATING_KEY,A);
  verifyAddedRawMeasureOnLeakPeriod(MODULE_REF,NEW_SECURITY_RATING_KEY,A);
  verifyAddedRawMeasureOnLeakPeriod(PROJECT_REF,NEW_SECURITY_RATING_KEY,A);
}
