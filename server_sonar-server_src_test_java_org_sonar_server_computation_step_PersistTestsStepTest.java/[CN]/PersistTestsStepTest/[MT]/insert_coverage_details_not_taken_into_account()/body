{
  BatchReportWriter writer=new BatchReportWriter(reportDir);
  List<BatchReport.Test> batchTests=Arrays.asList(newTest(1));
  writer.writeTests(TEST_FILE_REF_1,batchTests);
  List<CoverageDetail> coverageDetails=Arrays.asList(newCoverageDetail(1,MAIN_FILE_REF_1),newCoverageDetail(2,MAIN_FILE_REF_2));
  writer.writeCoverageDetails(TEST_FILE_REF_1,coverageDetails);
  writer.writeCoverageDetails(TEST_FILE_REF_2,coverageDetails);
  sut.execute(new ComputationContext(new BatchReportReader(reportDir),PROJECT_KEY,projectSettings,dbClient,ComponentTreeBuilders.from(root),languageRepository));
  assertThat(log.logs(LoggerLevel.WARN)).hasSize(1);
  assertThat(log.logs(LoggerLevel.WARN).get(0)).isEqualTo("Some coverage tests are not taken into account during analysis of project 'PROJECT_KEY'");
  assertThat(log.logs(LoggerLevel.TRACE)).hasSize(2);
  assertThat(log.logs(LoggerLevel.TRACE).get(0)).isEqualTo("The following test coverages for file 'TEST-PATH-1' have not been taken into account: name#2");
  assertThat(log.logs(LoggerLevel.TRACE).get(1)).startsWith("The following test coverages for file 'TEST-PATH-2' have not been taken into account: ");
  assertThat(log.logs(LoggerLevel.TRACE).get(1)).contains("name#1","name#2");
}
