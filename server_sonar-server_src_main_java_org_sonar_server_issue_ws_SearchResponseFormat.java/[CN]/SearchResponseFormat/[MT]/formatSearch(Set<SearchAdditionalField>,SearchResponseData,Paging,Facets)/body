{
  Issues.SearchWsResponse.Builder response=Issues.SearchWsResponse.newBuilder();
  formatPaging(paging,response);
  formatEffortTotal(data,response);
  response.addAllIssues(formatIssues(fields,data));
  response.addAllComponents(formatComponents(data));
  if (facets != null) {
    formatFacets(facets,response);
  }
  if (fields.contains(SearchAdditionalField.RULES)) {
    response.setRules(formatRules(data));
  }
  if (fields.contains(SearchAdditionalField.USERS)) {
    response.setUsers(formatUsers(data));
  }
  if (fields.contains(SearchAdditionalField.LANGUAGES)) {
    response.setLanguages(formatLanguages());
  }
  return response.build();
}
