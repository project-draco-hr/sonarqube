{
  File phpFile1=new File(baseDir,"src/Foo.php");
  fs.add(new DeprecatedDefaultInputFile("polop","src/Foo.php").setFile(phpFile1).setType(InputFile.Type.MAIN));
  when(exclusionPatternInitializer.hasFileContentPattern()).thenReturn(true);
  doThrow(new IOException("BUG")).when(regexpScanner).scan("polop:src/Foo.php",phpFile1,UTF_8);
  thrown.expect(SonarException.class);
  thrown.expectMessage("Unable to read the source file");
  scanner.execute();
}
