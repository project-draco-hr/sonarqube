{
  Snapshot snapshot=getSession().getSingleResult(Snapshot.class,"id",1000);
  doReturn(snapshot).when(resourcePersister).getSnapshot(any(Resource.class));
  doReturn(snapshot).when(resourcePersister).getLastSnapshot(any(Snapshot.class),anyBoolean());
  List<RuleFailureModel> violations=loader.getPastViolations(new JavaFile("file"));
  assertThat(violations.size(),is(2));
}
