{
  Backup backup=new Backup(Arrays.asList(new MetricsBackup(null),new PropertiesBackup(null,cleanDryRunCache),new RulesBackup((DatabaseSession)null),new ProfilesBackup((DatabaseSession)null)));
  SonarConfig sonarConfig=getSonarConfig();
  sonarConfig.setMetrics(getMetrics());
  sonarConfig.setProperties(getProperties());
  sonarConfig.setProfiles(getProfiles());
  sonarConfig.setRules(getUserRules());
  String xml=backup.getXmlFromSonarConfig(sonarConfig);
  assertXmlAreSimilar(xml,"backup-valid.xml");
}
