{
  xStream.alias("rule",Rule.class);
  xStream.registerConverter(new Converter(){
    public void marshal(    Object source,    HierarchicalStreamWriter writer,    MarshallingContext context){
      Rule rule=(Rule)source;
      writeNode(writer,PARENT_REPOSITORY_KEY,rule.getParent().getRepositoryKey());
      writeNode(writer,PARENT_KEY,rule.getParent().getKey());
      writeNode(writer,REPOSITORY_KEY,rule.getRepositoryKey());
      writeNode(writer,KEY,rule.getKey());
      writeNode(writer,CONFIG_KEY,rule.getConfigKey());
      writeNode(writer,LEVEL,rule.getSeverity().name());
      writeNode(writer,NAME,rule.getName());
      writeNode(writer,DESCRIPTION,rule.getDescription());
      if (!rule.getParams().isEmpty()) {
        writer.startNode(PARAMS);
        for (        RuleParam ruleParam : rule.getParams()) {
          writer.startNode("param");
          writeNode(writer,KEY,ruleParam.getKey());
          writeNode(writer,VALUE,ruleParam.getDefaultValue());
          writer.endNode();
        }
        writer.endNode();
      }
    }
    public Object unmarshal(    HierarchicalStreamReader reader,    UnmarshallingContext context){
      Rule rule=Rule.create();
      Map<String,String> valuesRule=new HashMap<String,String>();
      while (reader.hasMoreChildren()) {
        reader.moveDown();
        valuesRule.put(reader.getNodeName(),reader.getValue());
        if (PARAMS.equals(reader.getNodeName())) {
          while (reader.hasMoreChildren()) {
            reader.moveDown();
            Map<String,String> valuesParam=readNode(reader);
            rule.createParameter().setKey(valuesParam.get(KEY)).setDefaultValue(valuesParam.get(VALUE));
            reader.moveUp();
          }
        }
        reader.moveUp();
      }
      Rule parent=Rule.create().setRepositoryKey(valuesRule.get(PARENT_REPOSITORY_KEY)).setKey(valuesRule.get(PARENT_KEY));
      rule.setParent(parent).setRepositoryKey(valuesRule.get(REPOSITORY_KEY)).setKey(valuesRule.get(KEY)).setConfigKey(valuesRule.get(CONFIG_KEY)).setName(valuesRule.get(NAME)).setDescription(valuesRule.get(DESCRIPTION)).setSeverity(RulePriority.valueOf(valuesRule.get(LEVEL)));
      return rule;
    }
    public boolean canConvert(    Class type){
      return Rule.class.equals(type);
    }
  }
);
}
