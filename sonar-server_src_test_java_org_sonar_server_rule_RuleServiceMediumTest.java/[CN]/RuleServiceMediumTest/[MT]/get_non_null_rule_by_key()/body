{
  MockUserSession.set().setGlobalPermissions(GlobalPermissions.QUALITY_PROFILE_ADMIN).setLogin("me");
  RuleKey key=RuleKey.of("java","S001");
  dao.insert(dbSession,RuleTesting.newDto(key));
  dbSession.commit();
  dbSession.clearCache();
  assertThat(service.getNonNullByKey(key)).isNotNull();
  try {
    service.getNonNullByKey(RuleKey.of("un","known"));
    fail();
  }
 catch (  NotFoundException e) {
    assertThat(e).hasMessage("Rule not found: un:known");
  }
}
