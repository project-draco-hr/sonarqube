{
  PluginMetadata metadata=pluginByKeys.get(pluginKey);
  if (metadata != null && !metadata.isCore()) {
    try {
      File masterFile=new File(fs.getUserPluginsDir(),metadata.getFile().getName());
      FileUtils.moveFileToDirectory(masterFile,fs.getTrashPluginsDir(),true);
    }
 catch (    IOException e) {
      throw new IllegalStateException("Fail to uninstall plugin: " + pluginKey,e);
    }
  }
}
