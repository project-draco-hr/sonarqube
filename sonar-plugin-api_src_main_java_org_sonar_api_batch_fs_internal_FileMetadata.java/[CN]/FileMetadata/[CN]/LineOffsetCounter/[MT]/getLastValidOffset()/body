{
  if (lastValidOffset > Integer.MAX_VALUE) {
    throw new IllegalStateException("File is too big: " + lastValidOffset);
  }
  return (int)lastValidOffset;
}
