{
  LineCounter lineCounter=new LineCounter(new File("fromString"),Charsets.UTF_16);
  FileHashComputer fileHashComputer=new FileHashComputer();
  LineOffsetCounter lineOffsetCounter=new LineOffsetCounter();
  try {
    read(reader,lineCounter,fileHashComputer,lineOffsetCounter);
  }
 catch (  IOException e) {
    throw new IllegalStateException("Should never occurs",e);
  }
  return new Metadata(lineCounter.lines(),lineCounter.nonBlankLines(),fileHashComputer.getHash(),lineOffsetCounter.getOriginalLineOffsets(),lineOffsetCounter.getLastValidOffset(),lineCounter.isEmpty());
}
