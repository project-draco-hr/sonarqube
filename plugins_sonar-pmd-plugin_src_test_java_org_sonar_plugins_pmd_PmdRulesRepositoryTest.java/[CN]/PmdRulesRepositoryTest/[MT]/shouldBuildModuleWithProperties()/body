{
  org.sonar.api.rules.Rule dbRule=new org.sonar.api.rules.Rule();
  dbRule.setConfigKey("rulesets/design.xml/CloseResource");
  dbRule.setPluginName(CoreProperties.PMD_PLUGIN);
  RuleParam ruleParam=new RuleParam(dbRule,"types",null,null);
  ActiveRule activeRule=new ActiveRule(null,dbRule,RulePriority.MAJOR);
  activeRule.setActiveRuleParams(Arrays.asList(new ActiveRuleParam(activeRule,ruleParam,"Connection,Statement,ResultSet")));
  PmdRuleset ruleset=repository.buildModuleTree(Arrays.asList(activeRule));
  assertThat(ruleset.getRules().size(),is(1));
  PmdRule rule=ruleset.getRules().get(0);
  assertThat(rule.getRef(),is("rulesets/design.xml/CloseResource"));
  assertThat(rule.getProperties().size(),is(1));
  assertThat(rule.getPriority(),is("3"));
  Property property=rule.getProperties().get(0);
  assertThat(property.getName(),is("types"));
  assertThat(property.getValue(),is("Connection,Statement,ResultSet"));
}
