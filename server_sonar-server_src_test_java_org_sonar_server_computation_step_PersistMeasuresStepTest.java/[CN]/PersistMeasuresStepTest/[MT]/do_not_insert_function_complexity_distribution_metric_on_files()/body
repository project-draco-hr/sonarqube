{
  metricRepository.add(1,FUNCTION_COMPLEXITY_DISTRIBUTION);
  measureRepository.addRawMeasure(PROJECT_REF,FUNCTION_COMPLEXITY_DISTRIBUTION_KEY,Measure.newMeasureBuilder().create("0=1;2=10"));
  measureRepository.addRawMeasure(FILE_REF,FUNCTION_COMPLEXITY_DISTRIBUTION_KEY,Measure.newMeasureBuilder().create("0=1;2=10"));
  sut.execute();
  assertThat(dbTester.countRowsOfTable("project_measures")).isEqualTo(1);
  List<Map<String,Object>> dtos=selectSnapshots();
  Map<String,Object> dto=dtos.get(0);
  assertThat(dto.get("snapshotId")).isEqualTo(3L);
  assertThat(dto.get("componentId")).isEqualTo(projectDto.getId());
  assertThat(dto.get("textValue")).isEqualTo("0=1;2=10");
}
