{
  dbTester.truncateTables();
  underTest=new PersistMeasuresStep(dbClient,metricRepository,dbIdsRepository,treeRootHolder,measureRepository);
  projectDto=addComponent("project-key");
  fileDto=addComponent("file-key");
  Component file=ReportComponent.builder(Component.Type.FILE,FILE_REF).setUuid("CDEF").setKey("MODULE_KEY:file").build();
  Component project=ReportComponent.builder(Component.Type.PROJECT,PROJECT_REF).setUuid("ABCD").setKey(PROJECT_KEY).addChildren(file).build();
  treeRootHolder.setRoot(project);
  dbIdsRepository.setComponentId(project,projectDto.getId());
  dbIdsRepository.setSnapshotId(project,3L);
  dbIdsRepository.setComponentId(file,fileDto.getId());
  dbIdsRepository.setSnapshotId(file,4L);
}
