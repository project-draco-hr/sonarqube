{
  dbClient=mock(DbClient.class,Mockito.RETURNS_DEEP_STUBS);
  ruleCache=mock(RuleCache.class,Mockito.RETURNS_DEEP_STUBS);
  metricCache=mock(MetricCache.class,Mockito.RETURNS_DEEP_STUBS);
  when(metricCache.get("metric-key").getId()).thenReturn(654);
  measureDao=mock(MeasureDao.class);
  when(ruleCache.get(any(RuleKey.class)).getId()).thenReturn(987);
  sut=new PersistMeasuresStep(dbClient,ruleCache,metricCache);
  component=defaultComponent().build();
}
