{
  HttpRequest httpRequest=wsRequest.getMethod().equals(WsRequest.Method.GET) ? HttpRequest.post(buildUrl(wsRequest.getUrl()),wsRequest.getParams(),true) : HttpRequest.get(buildUrl(wsRequest.getUrl()),wsRequest.getParams(),true);
  httpRequest=prepare(httpRequest);
switch (wsRequest.getMediaType()) {
case PROTOBUF:
    httpRequest.accept(MediaType.PROTOBUF.toString());
  break;
case JSON:
httpRequest.accept(MediaType.JSON_UTF_8.toString());
break;
case TEXT:
default :
httpRequest.accept(MediaType.PLAIN_TEXT_UTF_8.toString());
break;
}
return httpRequest;
}
