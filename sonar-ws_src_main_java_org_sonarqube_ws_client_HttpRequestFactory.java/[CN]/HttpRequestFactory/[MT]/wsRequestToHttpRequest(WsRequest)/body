{
  HttpRequest httpRequest=WsRequest.Method.GET.equals(wsRequest.getMethod()) ? HttpRequest.get(buildUrl(wsRequest.getEndpoint()),wsRequest.getParams(),true) : HttpRequest.post(buildUrl(wsRequest.getEndpoint()),wsRequest.getParams(),true);
  httpRequest=prepare(httpRequest);
switch (wsRequest.getMediaType()) {
case PROTOBUF:
    httpRequest.accept(MediaTypes.PROTOBUF);
  break;
case JSON:
httpRequest.accept(MediaTypes.JSON);
break;
case TEXT:
httpRequest.accept(MediaTypes.TXT);
break;
default :
httpRequest.accept(MediaTypes.DEFAULT);
break;
}
return httpRequest;
}
