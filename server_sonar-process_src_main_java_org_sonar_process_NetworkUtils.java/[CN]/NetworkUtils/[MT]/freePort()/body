{
  ServerSocket s=null;
  try {
    s=new ServerSocket(0);
    return s.getLocalPort();
  }
 catch (  Exception e) {
    throw new IllegalStateException("Can not find an open network port",e);
  }
 finally {
    IOUtils.closeQuietly(s);
  }
}
