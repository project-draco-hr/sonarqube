{
  final PermissionTemplateDao permissionTemplateDao=mock(PermissionTemplateDao.class);
  when(permissionTemplateDao.selectByKey("my_template")).thenReturn(new PermissionTemplateDto().setId(1L));
  when(dbClient.permissionTemplateDao()).thenReturn(permissionTemplateDao);
  PermissionTemplateUpdater updater=new PermissionTemplateUpdater(dbClient,userSessionRule,"my_template",UserRole.USER,"user"){
    @Override void doExecute(    Long templateId,    String permission){
      permissionTemplateDao.insertUserPermission(1L,1L,UserRole.USER);
    }
  }
;
  updater.executeUpdate();
  verify(permissionTemplateDao,times(1)).insertUserPermission(1L,1L,UserRole.USER);
}
