{
  CountDistributionBuilder nclocDistribution=new CountDistributionBuilder(CoreMetrics.NCLOC_LANGUAGE_DISTRIBUTION);
  if (ResourceUtils.isFile(resource)) {
    Language language=resource.getLanguage();
    Measure ncloc=context.getMeasure(CoreMetrics.NCLOC);
    if (ncloc != null) {
      nclocDistribution.add(language != null ? language.getKey() : UNKNOWN_LANGUAGE_KEY,ncloc.getIntValue());
    }
  }
 else {
    for (    Measure measure : context.getChildrenMeasures(CoreMetrics.NCLOC_LANGUAGE_DISTRIBUTION)) {
      nclocDistribution.add(measure);
    }
  }
  Measure measure=nclocDistribution.build(false);
  if (measure != null) {
    context.saveMeasure(measure);
  }
}
