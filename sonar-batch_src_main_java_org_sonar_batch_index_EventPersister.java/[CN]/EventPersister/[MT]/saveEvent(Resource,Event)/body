{
  Snapshot snapshot=resourcePersister.getSnapshotOrFail(resource);
  if (event.getDate() == null) {
    event.setSnapshot(snapshot);
  }
 else {
    event.setResourceId(snapshot.getResourceId());
  }
  session.save(event);
  session.commit();
}
