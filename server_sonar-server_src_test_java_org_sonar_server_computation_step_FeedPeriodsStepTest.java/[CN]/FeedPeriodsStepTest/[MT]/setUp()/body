{
  dbClient=new DbClient(dbTester.database(),dbTester.myBatis(),new ComponentDao(),new SnapshotDao());
  dbSession=dbClient.openSession(false);
  reportReader.setMetadata(BatchReport.Metadata.newBuilder().setAnalysisDate(DATE_FORMAT.parse("2008-11-30").getTime()).build());
  reportReader.putComponent(BatchReport.Component.newBuilder().setRef(1).setType(Constants.ComponentType.PROJECT).setKey(PROJECT_KEY).setVersion("1.1").build());
  Component project=new DumbComponent(Component.Type.PROJECT,1,"ABCD",PROJECT_KEY);
  treeRootHolder.setRoot(project);
  sut=new FeedPeriodsStep(dbClient,settings,treeRootHolder,new PeriodFinder(dbClient),reportReader,periodsHolder);
}
