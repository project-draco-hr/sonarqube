{
  when(dryRun.isEnabled()).thenReturn(true);
  when(violation.getResource()).thenReturn(resource);
  when(violation.getLineId()).thenReturn(1);
  when(violation.getMessage()).thenReturn("VIOLATION");
  doReturn(Arrays.asList(violation)).when(dryRunExporter).getViolations(resource);
  String json=dryRunExporter.getResultsAsJson(ImmutableSet.of(resource));
  assertThat(json).isEqualTo("[{\"resource\":\"KEY\",\"line\":1,\"message\":\"VIOLATION\"}]");
}
