{
  File sonarDirectory=temporaryFolder.newFolder("sonar");
  when(dryRun.isEnabled()).thenReturn(true);
  when(dryRun.isEnabled()).thenReturn(true);
  when(server.getVersion()).thenReturn("3.4");
  doReturn(Arrays.<Violation>asList()).when(dryRunExporter).getViolations(resource);
  when(dryRun.getExportPath()).thenReturn("output.json");
  when(projectFileSystem.getSonarWorkingDirectory()).thenReturn(sonarDirectory);
  dryRunExporter.execute(sensorContext);
  assertThat(new File(sonarDirectory,"output.json")).exists();
}
