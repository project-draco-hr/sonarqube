{
  RuleKey templateRuleKey=RuleKey.of("java","S001");
  dao.insert(dbSession,RuleTesting.newDto(templateRuleKey).setCardinality(Cardinality.MULTIPLE));
  dbSession.commit();
  NewRule newRule=new NewRule().setTemplateKey(templateRuleKey).setName("My custom").setHtmlDescription("Some description").setSeverity(Severity.MAJOR).setStatus(RuleStatus.READY).setParameters(ImmutableMap.of("regex","a.*"));
  RuleKey customRuleKey=creator.create(newRule);
  deleter.delete(customRuleKey);
  Rule customRuleReloaded=index.getByKey(customRuleKey);
  assertThat(customRuleReloaded).isNotNull();
  assertThat(customRuleReloaded.status()).isEqualTo(RuleStatus.REMOVED);
}
