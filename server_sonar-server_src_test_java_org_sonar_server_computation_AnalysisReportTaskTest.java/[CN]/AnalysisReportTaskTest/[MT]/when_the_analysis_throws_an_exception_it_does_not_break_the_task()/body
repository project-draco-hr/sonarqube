{
  AnalysisReportDto report=AnalysisReportDto.newForTests(1L);
  when(queue.bookNextAvailable()).thenReturn(report);
  doThrow(IllegalStateException.class).when(service).analyzeReport(report);
  sut.run();
}
