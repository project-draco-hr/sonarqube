{
  Filter filter=new KeepOneFilter(DateUtils.parseDate("2011-03-25"),DateUtils.parseDate("2011-08-25"),Calendar.MONTH,"month");
  List<PurgeableSnapshotDto> toDelete=filter.filter(Arrays.<PurgeableSnapshotDto>asList(createSnapshotWithDate(1L,"2010-01-01"),createSnapshotWithDate(2L,"2011-05-01"),createSnapshotWithDate(3L,"2011-05-02"),createSnapshotWithDate(4L,"2011-05-19"),createSnapshotWithDate(5L,"2011-06-01"),createSnapshotWithDate(6L,"2012-01-01")));
  assertThat(toDelete.size(),is(2));
  assertThat(toDelete,IsCollectionContaining.hasItem(new DbCleanerTestUtils.SnapshotMatcher(3L)));
  assertThat(toDelete,IsCollectionContaining.hasItem(new DbCleanerTestUtils.SnapshotMatcher(4L)));
}
