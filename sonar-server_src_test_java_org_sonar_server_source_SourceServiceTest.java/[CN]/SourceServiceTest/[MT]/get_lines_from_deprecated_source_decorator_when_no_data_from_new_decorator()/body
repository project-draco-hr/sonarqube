{
  String projectKey="org.sonar.sample";
  String componentKey="org.sonar.sample:Sample";
  MockUserSession.set().addProjectPermissions(UserRole.CODEVIEWER,projectKey);
  when(resourceDao.getRootProjectByComponentKey(componentKey)).thenReturn(new ResourceDto().setKey(projectKey));
  when(sourceDecorator.getDecoratedSourceAsHtml(eq(componentKey),anyInt(),anyInt())).thenReturn(Collections.<String>emptyList());
  service.getLinesAsHtml(componentKey,1,2);
  verify(deprecatedSourceDecorator).getSourceAsHtml(componentKey,1,2);
}
