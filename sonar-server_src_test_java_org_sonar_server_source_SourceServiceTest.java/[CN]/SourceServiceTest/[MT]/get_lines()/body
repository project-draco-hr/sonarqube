{
  String projectKey="org.sonar.sample";
  String componentKey="org.sonar.sample:Sample";
  MockUserSession.set().addProjectPermissions(UserRole.CODEVIEWER,projectKey);
  when(resourceDao.getRootProjectByComponentKey(componentKey)).thenReturn(new ResourceDto().setKey(projectKey));
  service.getLinesAsHtml(componentKey);
  verify(sourceDecorator).getDecoratedSourceAsHtml(componentKey,null,null);
}
