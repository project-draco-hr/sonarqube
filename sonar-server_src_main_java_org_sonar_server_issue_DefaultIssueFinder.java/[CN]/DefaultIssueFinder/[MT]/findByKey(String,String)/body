{
  IssueDto dto=issueDao.selectByKey(issueKey);
  if (dto == null) {
    throw new IllegalStateException("Unknown issue: " + issueKey);
  }
  if (!UserSession.get().hasProjectPermission(requiredRole,dto.getRootComponentKey())) {
    throw new IllegalStateException("User does not have the required role required to change the issue: " + issueKey);
  }
  return dto.toDefaultIssue(workDurationFactory.createFromWorkingLong(dto.getTechnicalDebt()));
}
