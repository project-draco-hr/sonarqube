{
  IssueDto dto=issueDao.selectByKey(issueKey);
  if (dto == null) {
    throw new IllegalStateException("Unknown issue: " + issueKey);
  }
  if (!authorizationDao.isAuthorizedComponentId(dto.getComponentId(),UserSession.get().userId(),requiredRole)) {
    throw new IllegalStateException("User does not have the required role required to change the issue: " + issueKey);
  }
  return dto.toDefaultIssue();
}
