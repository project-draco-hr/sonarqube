{
  Properties properties=new Properties();
  properties.setProperty(MonitoredProcess.NAME_PROPERTY,DummyProcess.NAME);
  final DummyProcess dummyProcess=new DummyProcess(new Props(properties),true);
  dummyProcess.setTimeout(1000L).setCheckDelay(500L);
  Thread process=new Thread(new Runnable(){
    @Override public void run(){
      dummyProcess.start();
    }
  }
);
  assertProcessNotYetRunning(dummyProcess);
  process.start();
  Thread.sleep(100);
  int count=0;
  for (int i=0; i < 3; i++) {
    dummyProcess.ping();
    assertProcessRunning(dummyProcess);
    Thread.sleep(300);
    count++;
  }
  assertThat(count).isEqualTo(3);
  assertJoinAndTerminate(dummyProcess,process);
}
