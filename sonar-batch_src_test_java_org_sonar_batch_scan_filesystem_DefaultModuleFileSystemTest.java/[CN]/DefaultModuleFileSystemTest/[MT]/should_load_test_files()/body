{
  File basedir=new File(resourcesDir(),"main_and_test_files");
  DefaultModuleFileSystem fileSystem=new DefaultModuleFileSystem(mock(FileHashCache.class)).setBaseDir(basedir).setWorkingDir(temp.newFolder()).addSourceDir(new File(basedir,"src/main/java")).addTestDir(new File(basedir,"src/test/java")).setSettings(new Settings());
  assertThat(fileSystem.testDirs()).hasSize(1);
  List<File> testFiles=fileSystem.files(FileQuery.onTest());
  assertThat(testFiles).hasSize(2);
  for (  File testFile : testFiles) {
    assertThat(testFile).exists().isFile();
    assertThat(testFile.getName()).endsWith("Test.java");
  }
}
