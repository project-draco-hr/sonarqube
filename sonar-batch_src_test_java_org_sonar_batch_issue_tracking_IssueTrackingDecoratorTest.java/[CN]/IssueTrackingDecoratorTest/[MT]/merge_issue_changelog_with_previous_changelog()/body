{
  when(initialOpenIssues.selectChangelog("ABCDE")).thenReturn(newArrayList(new IssueChangeDto().setIssueKey("ABCD").setCreatedAt(System2.INSTANCE.now())));
  ServerIssue previousIssue=new ServerIssueFromDb(new IssueDto().setKee("ABCDE").setResolution(null).setStatus("OPEN").setRuleKey("squid","AvoidCycle").setLine(10).setMessage("Message").setEffortToFix(1.5).setDebt(1L).setCreatedAt(System2.INSTANCE.now()));
  DefaultIssue issue=new DefaultIssue();
  IssueTrackingResult trackingResult=mock(IssueTrackingResult.class);
  when(trackingResult.matched()).thenReturn(newArrayList(issue));
  when(trackingResult.matching(eq(issue))).thenReturn(previousIssue);
  decorator.mergeMatched(trackingResult);
  assertThat(issue.changes()).hasSize(1);
}
