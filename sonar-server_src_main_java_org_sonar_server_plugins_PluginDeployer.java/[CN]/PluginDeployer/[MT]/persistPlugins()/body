{
  List<JpaPlugin> previousPlugins=dao.getPlugins();
  List<JpaPlugin> installedPlugins=new ArrayList<JpaPlugin>();
  for (  PluginMetadata plugin : pluginByKeys.values()) {
    JpaPlugin installed=searchPlugin(plugin,previousPlugins);
    if (installed == null) {
      installed=JpaPlugin.create(plugin.getKey());
      installed.setInstallationDate(server.getStartedAt());
    }
    plugin.copyTo(installed);
    installedPlugins.add(installed);
    Logs.INFO.info("Plugin: " + plugin.getName() + " "+ StringUtils.defaultString(plugin.getVersion(),"-"));
  }
  dao.register(installedPlugins);
}
