{
  PluginMetadata metadata=PluginMetadata.createFromJar(file,corePlugin);
  String pluginKey=metadata.getKey();
  if (pluginKey != null) {
    registerPluginMetadata(pluginByKeys,file,metadata,canDeleteOld);
  }
 else   if (metadata.isOldManifest()) {
    loadDeprecatedPlugin(metadata);
    registerPluginMetadata(deprecatedPlugins,file,metadata,canDeleteOld);
  }
}
