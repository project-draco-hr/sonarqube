{
  index=mock(SonarIndex.class);
  decorator=new SubProjectDsmDecorator(index);
  module=new Project("foo");
  moduleContext=mock(DecoratorContext.class);
  dir1=Directory.create("src/foo1","foo1");
  dir1.setId(1);
  dir2=Directory.create("src/foo2","foo2");
  dir2.setId(2);
  DecoratorContext dir1Context=mock(DecoratorContext.class);
  when(dir1Context.getResource()).thenReturn(dir1);
  DecoratorContext dir2Context=mock(DecoratorContext.class);
  when(dir2Context.getResource()).thenReturn(dir2);
  when(moduleContext.getChildren()).thenReturn(Arrays.asList(dir1Context,dir2Context));
}
