{
  if (configuration.forceReloadAll()) {
    LOG.warn("Forced reloading of SCM data for all files.");
  }
  List<InputFile> filesToBlame=new LinkedList<>();
  for (  InputFile f : fs.inputFiles(fs.predicates().all())) {
    if (configuration.forceReloadAll() || f.status() != Status.SAME) {
      addIfNotEmpty(filesToBlame,f);
    }
 else {
      FileData fileData=projectRepositories.fileData(projectDefinition.getKeyWithBranch(),f.relativePath());
      if (StringUtils.isEmpty(fileData.revision())) {
        addIfNotEmpty(filesToBlame,f);
      }
 else {
        askToCopyDataFromPreviousAnalysis(f);
      }
    }
  }
  return filesToBlame;
}
