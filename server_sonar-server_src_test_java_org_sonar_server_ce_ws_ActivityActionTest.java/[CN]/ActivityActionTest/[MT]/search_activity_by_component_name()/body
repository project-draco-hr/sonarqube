{
  ComponentDto struts=newProjectDto().setName("old apache struts").setUuid("P1").setProjectUuid("P1");
  ComponentDto zookeeper=newProjectDto().setName("new apache zookeeper").setUuid("P2").setProjectUuid("P2");
  ComponentDto eclipse=newProjectDto().setName("eclipse").setUuid("P3").setProjectUuid("P3");
  componentDb.insertProjectAndSnapshot(struts);
  componentDb.insertProjectAndSnapshot(zookeeper);
  componentDb.insertProjectAndSnapshot(eclipse);
  dbTester.commit();
  componentDb.indexComponents(struts.uuid(),zookeeper.uuid(),eclipse.uuid());
  globalAdmin();
  insertActivity("T1","P1",CeActivityDto.Status.SUCCESS);
  insertActivity("T2","P2",CeActivityDto.Status.SUCCESS);
  insertActivity("T3","P3",CeActivityDto.Status.SUCCESS);
  ActivityResponse activityResponse=call(ws.newRequest().setParam(PARAM_COMPONENT_QUERY,"apac"));
  assertThat(activityResponse.getTasksList()).extracting("id").containsOnly("T1","T2");
}
