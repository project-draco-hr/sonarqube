{
  SearchRequestBuilder request=getClient().prepareSearch(getIndexName()).setTypes(IndexDefinition.ACTIVE_RULE.getIndexType()).setSearchType(SearchType.SCAN).setScroll(TimeValue.timeValueMinutes(SCROLL_TIME_IN_MINUTES)).setSize(100).setQuery(QueryBuilders.filteredQuery(QueryBuilders.matchAllQuery(),FilterBuilders.boolFilter().must(FilterBuilders.termFilter(ActiveRuleNormalizer.ActiveRuleField.PROFILE_KEY.field(),key)).mustNot(FilterBuilders.hasParentFilter(this.getParentType(),FilterBuilders.termFilter(RuleIndexDefinition.FIELD_RULE_STATUS,RuleStatus.REMOVED.name()))))).setRouting(key);
  SearchResponse response=request.get();
  return scroll(response.getScrollId());
}
