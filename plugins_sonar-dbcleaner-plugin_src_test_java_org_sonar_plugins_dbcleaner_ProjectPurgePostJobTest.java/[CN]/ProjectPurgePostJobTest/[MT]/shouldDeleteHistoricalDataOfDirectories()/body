{
  PurgeDao purgeDao=mock(PurgeDao.class);
  Settings settings=new Settings(new PropertyDefinitions(ProjectPurgePostJob.class));
  settings.setProperty(DbCleanerConstants.PROPERTY_CLEAN_DIRECTORY,"true");
  ProjectPurgePostJob job=new ProjectPurgePostJob(purgeDao,settings,mock(DefaultPeriodCleaner.class));
  job.executeOn(newProject(),mock(SensorContext.class));
  verify(purgeDao,times(1)).deleteSnapshots(argThat(newDirectoryQueryMatcher()));
}
