{
  Issue issue1=new DefaultIssue().setRuleKey(RuleKey.of(ruleA1.getRepositoryKey(),ruleA1.getKey())).setSeverity(RulePriority.CRITICAL.name()).setCreatedAt(rightNow);
  Issue issue2=new DefaultIssue().setRuleKey(RuleKey.of(ruleA2.getRepositoryKey(),ruleA2.getKey())).setSeverity(RulePriority.CRITICAL.name()).setCreatedAt(rightNow);
  when(issuable.issues()).thenReturn(newArrayList(issue1)).thenReturn(newArrayList(issue2));
  decorator.decorate(resource,context);
  decorator.decorate(resource,context);
  verify(context,times(2)).saveMeasure(argThat(new IsVariationMeasure(CoreMetrics.NEW_CRITICAL_ISSUES,1.0,1.0)));
  verify(context,never()).saveMeasure(argThat(new IsVariationMeasure(CoreMetrics.NEW_CRITICAL_ISSUES,2.0,2.0)));
}
