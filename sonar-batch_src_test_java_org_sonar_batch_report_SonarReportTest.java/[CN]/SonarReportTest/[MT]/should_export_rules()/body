{
  DefaultIssue issue=new DefaultIssue().setKey("200").setComponentKey("Action.java").setRuleKey(RuleKey.of("squid","AvoidCycle"));
  when(ruleI18nManager.getName("squid","AvoidCycle",Locale.getDefault())).thenReturn("Avoid Cycle");
  when(sonarReport.getIssues()).thenReturn(Lists.<DefaultIssue>newArrayList(issue));
  JSONObject root=sonarReport.createJson();
  assertThat(root.get("rules")).isNotNull();
  JSONArray rules=(JSONArray)root.get("rules");
  assertThat(rules).hasSize(1);
  JSONObject json=(JSONObject)rules.get(0);
  assertThat(json.values()).hasSize(4);
  assertThat(json.get("key")).isEqualTo("squid:AvoidCycle");
  assertThat(json.get("rule")).isEqualTo("AvoidCycle");
  assertThat(json.get("repository")).isEqualTo("squid");
  assertThat(json.get("name")).isEqualTo("Avoid Cycle");
}
