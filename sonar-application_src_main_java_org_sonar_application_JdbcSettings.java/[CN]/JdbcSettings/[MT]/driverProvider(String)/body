{
  Pattern pattern=Pattern.compile("jdbc:(\\w+):.+");
  Matcher matcher=pattern.matcher(url);
  if (!matcher.find()) {
    throw new MessageException(String.format("Bad format of JDBC URL: %s",url));
  }
  String key=matcher.group(1);
  try {
    return Provider.valueOf(StringUtils.upperCase(key));
  }
 catch (  IllegalArgumentException e) {
    throw new MessageException(String.format("Unsupported JDBC driver provider: %s",key));
  }
}
