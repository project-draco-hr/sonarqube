{
  try {
    XContentBuilder document=jsonBuilder().startObject();
    ActiveRuleKey key=rule.getKey();
    if (key == null) {
      throw new IllegalStateException("Cannot normalize ActiveRuleDto with null key");
    }
    document.startObject(RuleNormalizer.RuleField.ACTIVE.key());
    document.startObject(key.toString());
    indexField("_id",rule.getKey(),document);
    indexField(ActiveRuleField.OVERRIDE.key(),rule.doesOverride(),document);
    indexField(ActiveRuleField.INHERITANCE.key(),rule.getInheritance(),document);
    indexField(ActiveRuleField.PROFILE_ID.key(),rule.getProfileId(),document);
    indexField(ActiveRuleField.SEVERITY.key(),rule.getSeverityString(),document);
    indexField(ActiveRuleField.PARENT_ID.key(),rule.getParentId(),document);
    document.endObject();
    document.endObject();
    UpdateRequest request=new UpdateRequest().doc(document);
    request.docAsUpsert(true);
    return request;
  }
 catch (  Exception e) {
    throw new IllegalStateException(String.format("Could not normalize Object with key %s",rule.getKey().toString()),e);
  }
}
