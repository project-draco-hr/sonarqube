{
  String filename=filename(request);
  if (StringUtils.isBlank(filename)) {
    PrintWriter writer=null;
    try {
      response.setContentType("text/plain");
      writer=response.getWriter();
      writer.print(StringUtils.join(getLibs(),','));
    }
 catch (    IOException e) {
      LOG.error("Unable to provide list of batch resources",e);
      response.sendError(HttpServletResponse.SC_INTERNAL_SERVER_ERROR);
    }
 finally {
      IOUtils.closeQuietly(writer);
    }
  }
 else {
    InputStream in=null;
    OutputStream out=null;
    try {
      in=getServletContext().getResourceAsStream("/WEB-INF/lib/" + filename);
      if (in == null) {
      }
 else {
        response.setContentType("application/java-archive");
        out=response.getOutputStream();
        IOUtils.copy(in,out);
      }
    }
 catch (    Exception e) {
      LOG.error("Unable to load batch resource '" + filename + "'",e);
      response.sendError(HttpServletResponse.SC_INTERNAL_SERVER_ERROR);
    }
 finally {
      IOUtils.closeQuietly(in);
      IOUtils.closeQuietly(out);
    }
  }
}
