{
  WSLoader wsLoader=mock(WSLoader.class);
  UserRepositoryLoader userRepo=new UserRepositoryLoader(wsLoader);
  Map<String,String> userMap=ImmutableMap.of("fmallet","Freddy Mallet","sbrandhof","Simon");
  WSLoaderResult<ByteSource> res=new WSLoaderResult<>(createUsersMock(userMap),true);
  when(wsLoader.loadSource("/batch/users?logins=fmallet,sbrandhof")).thenReturn(res);
  assertThat(userRepo.load(Arrays.asList("fmallet","sbrandhof"))).extracting("login","name").containsOnly(tuple("fmallet","Freddy Mallet"),tuple("sbrandhof","Simon"));
}
