{
  List<CloneGroup> groups=Arrays.asList(newCloneGroup(new ClonePart(batchComponent1.key(),0,5,204),new ClonePart(batchComponent1.key(),0,215,414)));
  engine.saveDuplications(inputFile1,groups);
  assertThat(reader.readComponentDuplications(batchComponent1.batchId())).hasSize(1);
  CloseableIterator<Duplication> dups=reader.readComponentDuplications(batchComponent1.batchId());
  Duplication duplication=dups.next();
  dups.close();
  assertThat(duplication.getOriginPosition().getStartLine()).isEqualTo(5);
  assertThat(duplication.getOriginPosition().getEndLine()).isEqualTo(204);
  assertThat(duplication.getDuplicateList()).hasSize(1);
  assertThat(duplication.getDuplicate(0).hasOtherFileRef()).isFalse();
  assertThat(duplication.getDuplicate(0).getRange().getStartLine()).isEqualTo(215);
  assertThat(duplication.getDuplicate(0).getRange().getEndLine()).isEqualTo(414);
}
