{
  XmlWriter xml=XmlWriter.of(writer).declaration();
  xml.begin("profile");
  xml.prop("name",profile.getName());
  xml.prop("language",profile.getLanguage());
  xml.begin("rules");
  while (activeRules.hasNext()) {
    ActiveRuleDto activeRule=activeRules.next();
    xml.begin("rule");
    xml.prop("repositoryKey",activeRule.getKey().ruleKey().repository());
    xml.prop("key",activeRule.getKey().ruleKey().rule());
    xml.prop("priority",activeRule.getSeverityString());
    xml.begin("parameters");
    for (    ActiveRuleParamDto param : db.activeRuleDao().selectParamsByActiveRuleId(dbSession,activeRule.getId())) {
      xml.begin("parameter").prop("key",param.getKey()).prop("value",param.getValue()).end();
    }
    xml.end("parameters");
    xml.end("rule");
  }
  xml.end("rules").end("profile").close();
}
