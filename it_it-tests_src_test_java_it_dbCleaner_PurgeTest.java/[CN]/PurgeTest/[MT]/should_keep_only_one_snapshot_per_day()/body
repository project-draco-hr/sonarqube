{
  scan(PROJECT_SAMPLE_PATH);
  int snapshotsCount=count("snapshots where qualifier<>'LIB'");
  int measuresCount=count("project_measures");
  orchestrator.getServer().getAdminWsClient().update(new PropertyUpdateQuery("sonar.dbcleaner.hoursBeforeKeepingOnlyOneSnapshotByDay","0"));
  scan(PROJECT_SAMPLE_PATH);
  assertThat(count("snapshots where qualifier<>'LIB'")).as("Different number of snapshots").isEqualTo(snapshotsCount);
  int measureOnNewMetrics=count("project_measures, metrics where metrics.id = project_measures.metric_id and metrics.name like 'new_%'");
  assertThat(count("project_measures")).as("Different number of measures").isEqualTo(measuresCount + measureOnNewMetrics);
}
