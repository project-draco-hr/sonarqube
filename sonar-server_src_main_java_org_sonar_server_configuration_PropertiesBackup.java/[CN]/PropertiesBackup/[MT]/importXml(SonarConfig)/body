{
  LoggerFactory.getLogger(getClass()).info("Restore properties");
  Map<String,String> properties=Maps.newHashMap();
  if (sonarConfig.getProperties() != null && !sonarConfig.getProperties().isEmpty()) {
    for (    Property xmlProperty : sonarConfig.getProperties()) {
      properties.put(xmlProperty.getKey(),xmlProperty.getValue());
    }
  }
  for (  PropertyDto property : persistentSettings.getGlobalProperties()) {
    if (shouldNotBeErased(property.getKey())) {
      properties.put(property.getKey(),property.getValue());
    }
  }
  persistentSettings.deleteProperties();
  persistentSettings.saveProperties(properties);
}
