{
  when(authorizationDao.selectGlobalPermissions("john")).thenReturn(newArrayList(Permission.DASHBOARD_SHARING.key()));
  UserSession userSession=MockUserSession.create().setLogin("john");
  assertThat(service.canShareFilter(userSession)).isTrue();
  userSession=MockUserSession.create().setLogin(null);
  assertThat(service.canShareFilter(userSession)).isFalse();
  when(authorizationDao.selectGlobalPermissions("john")).thenReturn(Collections.<String>emptyList());
  userSession=MockUserSession.create().setLogin("john");
  assertThat(service.canShareFilter(userSession)).isFalse();
}
