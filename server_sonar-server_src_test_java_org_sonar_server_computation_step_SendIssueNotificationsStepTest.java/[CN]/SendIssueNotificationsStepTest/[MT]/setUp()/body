{
  issueCache=new IssueCache(temp.newFile(),System2.INSTANCE);
  NewIssuesNotificationFactory newIssuesNotificationFactory=mock(NewIssuesNotificationFactory.class,Mockito.RETURNS_DEEP_STUBS);
  underTest=new SendIssueNotificationsStep(issueCache,mock(RuleRepository.class),treeRootHolder,notifService,reportReader,newIssuesNotificationFactory);
  treeRootHolder.setRoot(ReportComponent.builder(Component.Type.PROJECT,1).setUuid(PROJECT_UUID).setKey(PROJECT_KEY).build());
  reportReader.setMetadata(BatchReport.Metadata.newBuilder().setRootComponentRef(1).build());
  reportReader.putComponent(BatchReport.Component.newBuilder().setRef(1).setType(Constants.ComponentType.PROJECT).setKey(PROJECT_KEY).setName("Project name").build());
}
