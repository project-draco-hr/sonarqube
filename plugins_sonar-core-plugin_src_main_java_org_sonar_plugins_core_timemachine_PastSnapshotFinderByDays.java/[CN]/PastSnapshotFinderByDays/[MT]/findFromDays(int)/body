{
  Date targetDate=DateUtils.addDays(projectSnapshot.getCreatedAt(),-days);
  String hql="from " + Snapshot.class.getSimpleName() + " where resourceId=:resourceId AND status=:status AND createdAt>=:from AND createdAt<:to order by createdAt asc";
  List<Snapshot> snapshots=session.createQuery(hql).setParameter("from",targetDate).setParameter("to",projectSnapshot.getCreatedAt()).setParameter("resourceId",projectSnapshot.getResourceId()).setParameter("status",Snapshot.STATUS_PROCESSED).setMaxResults(1).getResultList();
  if (snapshots.isEmpty()) {
    return null;
  }
  return new PastSnapshot(MODE,targetDate,snapshots.get(0)).setModeParameter(String.valueOf(days));
}
