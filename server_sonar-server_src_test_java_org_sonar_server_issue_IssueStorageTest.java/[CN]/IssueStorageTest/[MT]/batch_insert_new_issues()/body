{
  DbClient dbClient=new DbClient(dbTester.database(),dbTester.myBatis());
  FakeBatchSaver saver=new FakeBatchSaver(dbClient,new FakeRuleFinder());
  DefaultIssueComment comment=DefaultIssueComment.create("ABCDE","emmerik","the comment");
  comment.setKey("FGHIJ");
  Date date=DateUtils.parseDateTime("2013-05-18T12:00:00+0000");
  DefaultIssue issue=new DefaultIssue().setKey("ABCDE").setNew(true).setRuleKey(RuleKey.of("squid","AvoidCycle")).setLine(5000).setDebt(Duration.create(10L)).setReporter("emmerik").setResolution("OPEN").setStatus("OPEN").setSeverity("BLOCKER").setAttribute("foo","bar").addComment(comment).setCreationDate(date).setUpdateDate(date).setCloseDate(date).setComponentUuid("uuid-100").setProjectUuid("uuid-10").setComponentKey("struts:Action");
  saver.save(issue);
  checkTables("should_insert_new_issues",new String[]{"id","created_at","updated_at","issue_change_creation_date"},"issues","issue_changes");
}
