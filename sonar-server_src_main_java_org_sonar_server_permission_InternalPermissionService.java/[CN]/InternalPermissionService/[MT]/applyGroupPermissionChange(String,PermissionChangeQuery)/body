{
  Long componentId=getComponentId(permissionChangeQuery.component());
  checkProjectAdminPermission(componentId);
  List<String> existingPermissions=permissionFacade.selectGroupPermissions(permissionChangeQuery.group(),componentId);
  if (shouldSkipPermissionChange(operation,existingPermissions,permissionChangeQuery)) {
    LOG.info("Skipping permission change '{} {}' for group {} as it matches the current permission scheme",new String[]{operation,permissionChangeQuery.permission(),permissionChangeQuery.group()});
  }
 else {
    Long targetedGroup=getTargetedGroup(permissionChangeQuery.group());
    if (ADD.equals(operation)) {
      permissionFacade.insertGroupPermission(getComponentId(permissionChangeQuery.component()),targetedGroup,permissionChangeQuery.permission());
    }
 else {
      permissionFacade.deleteGroupPermission(getComponentId(permissionChangeQuery.component()),targetedGroup,permissionChangeQuery.permission());
    }
  }
}
