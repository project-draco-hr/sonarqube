{
  AuthorizationDao authorizationDao=mock(AuthorizationDao.class);
  ResourceDao resourceDao=mock(ResourceDao.class);
  UserSession session=new SpyUserSession("marius",authorizationDao,resourceDao).setUserId(1);
  when(resourceDao.getRootProjectByComponentKey("com.foo:Bar:BarFile.xoo")).thenReturn(new ResourceDto().setKey("com.foo:Bar"));
  when(authorizationDao.selectAuthorizedRootProjectsKeys(1,UserRole.USER)).thenReturn(newArrayList("com.foo:Bar"));
  session.checkComponentPermission(UserRole.USER,"com.foo:Bar:BarFile.xoo");
}
