{
  AuthorizationDao authorizationDao=mock(AuthorizationDao.class);
  UserSession session=new SpyUserSession("marius",authorizationDao).setUserId(1);
  when(authorizationDao.selectAuthorizedRootProjectsKeys(1,UserRole.USER)).thenReturn(newArrayList("com.foo:Bar"));
  assertThat(session.hasProjectPermission(UserRole.USER,"com.foo:Bar")).isTrue();
  assertThat(session.hasProjectPermission(UserRole.CODEVIEWER,"com.foo:Bar")).isFalse();
  assertThat(session.hasProjectPermission(UserRole.ADMIN,"com.foo:Bar")).isFalse();
}
