{
  Connection connection=db.getDataSource().getConnection();
  try {
    String driverVersion=connection.getMetaData().getDriverVersion();
    String[] parts=StringUtils.split(driverVersion,".");
    int intVersion=Integer.parseInt(parts[0]) * 100 + Integer.parseInt(parts[1]);
    if (intVersion < 1102) {
      throw new IllegalStateException(String.format("Unsupported Oracle JDBC driver version: %s. Minimal required version is 11.2.",driverVersion));
    }
  }
  finally {
    DbUtils.closeQuietly(connection);
  }
}
