{
  SnapshotDto snapshot=findFirstSnapshot(session,createCommonQuery(projectUuid).setCreatedBefore(analysisDate).setIsLast(true).setSort(BY_DATE,DESC));
  if (snapshot == null) {
    return null;
  }
  LOG.debug("Compare to previous analysis ({})",formatDate(snapshot.getCreatedAt()));
  return new Period(index,TIMEMACHINE_MODE_PREVIOUS_ANALYSIS,formatDate(snapshot.getCreatedAt()),snapshot.getCreatedAt(),snapshot.getUuid());
}
