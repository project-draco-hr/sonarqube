{
  Snapshot snapshot=snapshotsByResource.get(resource);
  if (snapshot == null) {
    snapshot=persist(project,resource,parent);
    addToCache(resource,snapshot);
  }
  return snapshot;
}
