{
  if (resource == null) {
    return null;
  }
  Snapshot snapshot=snapshotsByResource.get(resource);
  if (snapshot == null) {
    if (resource instanceof Project) {
      snapshot=doSaveProject((Project)resource);
    }
 else     if (resource instanceof Library) {
      snapshot=doSaveLibrary(project,(Library)resource);
    }
 else {
      snapshot=doSaveResource(project,resource);
    }
  }
  return snapshot;
}
