{
  if (snapshot != null) {
    snapshotsByResource.put(resource,snapshot);
    resourceCache.add(resource);
    if (!(resource instanceof Library)) {
      snapshotCache.put(resource.getEffectiveKey(),snapshot);
    }
  }
}
