{
  Integer subCharacteristicId=ruleDto.getSubCharacteristicId();
  Integer defaultSubCharacteristicId=ruleDto.getDefaultSubCharacteristicId();
  Integer effectiveSubCharacteristicId=subCharacteristicId != null ? subCharacteristicId : defaultSubCharacteristicId;
  Characteristic subCharacteristic=debtModel.characteristicById(effectiveSubCharacteristicId);
  if (subCharacteristic == null) {
    throw new IllegalStateException(String.format("Sub characteristic id '%s' on rule '%s' has not been found",effectiveSubCharacteristicId,ruleKey));
  }
  return subCharacteristic;
}
