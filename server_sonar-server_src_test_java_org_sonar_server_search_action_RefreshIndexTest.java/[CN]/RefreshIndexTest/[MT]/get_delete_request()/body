{
  RefreshIndex refreshAction=new RefreshIndex(TEST_INDEX.getIndexType());
  try {
    refreshAction.call();
    fail();
  }
 catch (  Exception e) {
    assertThat(e.getMessage()).isEqualTo(IndexAction.MISSING_INDEX_EXCEPTION);
  }
  try {
    refreshAction.getKey();
    fail();
  }
 catch (  Exception e) {
    assertThat(e.getMessage()).isEqualTo("Refresh Action has no key");
  }
  refreshAction.setIndex(index);
  List<RefreshRequest> requests=refreshAction.call();
  assertThat(requests).hasSize(1);
  RefreshRequest request=requests.get(0);
  assertThat(request.indices()).containsOnly(TEST_INDEX.getIndexName());
}
