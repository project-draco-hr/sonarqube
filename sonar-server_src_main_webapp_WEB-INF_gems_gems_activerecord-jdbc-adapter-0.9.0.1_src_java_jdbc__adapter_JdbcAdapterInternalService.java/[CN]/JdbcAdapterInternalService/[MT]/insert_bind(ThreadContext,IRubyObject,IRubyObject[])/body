{
  final Ruby runtime=recv.getRuntime();
  return withConnectionAndRetry(recv,new SQLBlock(){
    public IRubyObject call(    Connection c) throws SQLException {
      PreparedStatement ps=null;
      try {
        ps=c.prepareStatement(rubyApi.convertToRubyString(args[0]).toString(),Statement.RETURN_GENERATED_KEYS);
        setValuesOnPS(ps,runtime,context,args[1],args[2]);
        ps.executeUpdate();
        return unmarshal_id_result(runtime,ps.getGeneratedKeys());
      }
  finally {
        try {
          ps.close();
        }
 catch (        Exception e) {
        }
      }
    }
  }
);
}
