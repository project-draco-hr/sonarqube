{
  HttpRequestFactory requestFactory=new HttpRequestFactory(httpServer.url());
  httpServer.doReturnStatus(500);
  ActionPlanClient client=new DefaultActionPlanClient(requestFactory);
  try {
    client.delete("382f6f2e-ad9d-424a-b973-9b065e04348a");
    fail();
  }
 catch (  HttpException e) {
    assertThat(e.status()).isEqualTo(500);
    assertThat(e.url()).startsWith("http://localhost");
    assertThat(e.url()).endsWith("/api/action_plans/delete?key=382f6f2e-ad9d-424a-b973-9b065e04348a");
  }
}
