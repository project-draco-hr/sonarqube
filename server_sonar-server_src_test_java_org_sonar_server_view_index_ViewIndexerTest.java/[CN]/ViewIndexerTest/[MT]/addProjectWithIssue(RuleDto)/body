{
  ComponentDto project=ComponentTesting.newProjectDto();
  ComponentDto file=ComponentTesting.newFileDto(project);
  dbClient.componentDao().insert(dbSession,project,file);
  dbClient.roleDao().insertGroupRole(dbSession,new GroupRoleDto().setRole(UserRole.USER).setGroupId(null).setResourceId(project.getId()));
  IssueDto issue=IssueTesting.newDto(rule,file,project);
  dbClient.issueDao().insert(dbSession,issue);
  dbSession.commit();
  return project;
}
