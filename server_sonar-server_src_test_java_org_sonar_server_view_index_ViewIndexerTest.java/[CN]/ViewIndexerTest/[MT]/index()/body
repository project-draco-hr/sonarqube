{
  dbTester.prepareDbUnit(getClass(),"index.xml");
  indexer.index();
  List<ViewDoc> docs=esTester.getDocuments("views","view",ViewDoc.class);
  assertThat(docs).hasSize(4);
  Map<String,ViewDoc> viewsByUuid=Maps.uniqueIndex(docs,new Function<ViewDoc,String>(){
    @Override public String apply(    ViewDoc doc){
      return doc.uuid();
    }
  }
);
  assertThat(viewsByUuid.get("ABCD").projects()).containsOnly("BCDE");
  assertThat(viewsByUuid.get("EFGH").projects()).containsOnly("GHIJ","HIJK");
  assertThat(viewsByUuid.get("FGHI").projects()).containsOnly("HIJK");
  assertThat(viewsByUuid.get("IJKL").projects()).isEmpty();
}
