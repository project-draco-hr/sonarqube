{
  List<File> sourceDirs=InputFile.TYPE_MAIN.equals(type) ? fileSystem.sourceDirs() : fileSystem.testDirs();
  for (  File src : sourceDirs) {
    String sourceRelativePath=pathResolver.relativePath(src,file);
    if (sourceRelativePath != null) {
      set(attributes,DefaultInputFile.ATTRIBUTE_SOURCEDIR_PATH,PathUtils.canonicalPath(src));
      set(attributes,DefaultInputFile.ATTRIBUTE_SOURCE_RELATIVE_PATH,sourceRelativePath);
      if (Java.KEY.equals(lang)) {
        set(inputFile.attributes(),DefaultInputFile.ATTRIBUTE_COMPONENT_DEPRECATED_KEY,project.getEffectiveKey() + ":" + JavaFile.fromRelativePath(sourceRelativePath,false).getDeprecatedKey());
      }
 else {
        set(inputFile.attributes(),DefaultInputFile.ATTRIBUTE_COMPONENT_DEPRECATED_KEY,project.getEffectiveKey() + ":" + sourceRelativePath);
      }
      return;
    }
  }
}
