{
  Collection<File> files=FileUtils.listFiles(dirToIndex,FILE_FILTER,DIR_FILTER);
  for (  File sourceFile : files) {
    String path=pathResolver.relativePath(fileSystem.baseDir(),sourceFile);
    if (path == null) {
      LoggerFactory.getLogger(getClass()).warn(String.format(FILE_S_IS_NOT_DECLARED_IN_MODULE_BASEDIR_S,sourceFile.getAbsoluteFile(),fileSystem.baseDir()));
    }
 else {
      if (exclusionFilters.accept(sourceFile,path,InputFile.TYPE_MAIN)) {
        indexFile(inputFileBuilder,fileSystem,status,sourceFile,path,InputFile.TYPE_MAIN);
      }
      if (exclusionFilters.accept(sourceFile,path,InputFile.TYPE_TEST)) {
        indexFile(inputFileBuilder,fileSystem,status,sourceFile,path,InputFile.TYPE_TEST);
      }
    }
  }
}
