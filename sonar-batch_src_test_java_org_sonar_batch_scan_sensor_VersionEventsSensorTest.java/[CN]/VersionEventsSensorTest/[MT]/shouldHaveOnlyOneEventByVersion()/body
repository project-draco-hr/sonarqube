{
  Event sameVersionEvent=mockVersionEvent("1.5-SNAPSHOT");
  Event otherEvent=mockVersionEvent("1.4");
  Event anotherEvent=mockVersionEvent("1.3-SNAPSHOT");
  VersionEventsSensor sensor=new VersionEventsSensor(null);
  SensorContext context=mock(SensorContext.class);
  Project project=mock(Project.class);
  when(project.getAnalysisVersion()).thenReturn("1.5-SNAPSHOT");
  when(context.getEvents(project)).thenReturn(Lists.newArrayList(sameVersionEvent,otherEvent,anotherEvent));
  sensor.analyse(project,context);
  verify(context).deleteEvent(sameVersionEvent);
  verify(context).createEvent(eq(project),eq("1.5-SNAPSHOT"),(String)isNull(),eq(Event.CATEGORY_VERSION),(Date)isNull());
}
