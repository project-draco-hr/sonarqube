{
  if (!session.getClass().isAssignableFrom(BatchSession.class)) {
    LOGGER.warn("Synchronizer should only be used with BatchSession!");
  }
  try {
    DbSynchronizationHandler handler=getSynchronizationResultHandler(session,params);
    session.select(getSynchronizeStatementFQN(),getSynchronizationParams(date,params),handler);
    handler.enqueueCollected();
    session.enqueue(new RefreshIndex(this.getIndexType()));
    session.commit();
  }
 catch (  Exception e) {
    throw new IllegalStateException(e);
  }
}
