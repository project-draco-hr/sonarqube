{
  return new DbSynchronizationHandler(){
    private int count=0;
    @Override public void handleResult(    ResultContext resultContext){
      DTO dto=(DTO)resultContext.getResultObject();
      session.enqueue(new UpsertDto<DTO>(getIndexType(),dto,true));
      count++;
      if (count % 100000 == 0) {
        LOGGER.info(" - synchronized {} {}",count,getIndexType());
      }
    }
    @Override public void enqueueCollected(){
    }
  }
;
}
