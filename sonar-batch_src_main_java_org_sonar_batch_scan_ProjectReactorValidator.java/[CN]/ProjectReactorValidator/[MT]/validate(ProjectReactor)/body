{
  preventAutomaticProjectCreationIfNeeded(reactor);
  String branch=settings.getString(CoreProperties.PROJECT_BRANCH_PROPERTY);
  String rootProjectKey=ComponentKeys.createKey(reactor.getRoot().getKey(),branch);
  List<String> validationMessages=new ArrayList<String>();
  for (  ProjectDefinition moduleDef : reactor.getProjects()) {
    validateModule(moduleDef,validationMessages,branch,rootProjectKey);
  }
  validateBranch(validationMessages,branch);
  if (!validationMessages.isEmpty()) {
    throw new SonarException("Validation of project reactor failed:\n  o " + Joiner.on("\n  o ").join(validationMessages));
  }
}
