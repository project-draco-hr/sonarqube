{
  File pluginBasedir;
  if (toDir != null) {
    pluginBasedir=toDir;
    FileUtils.forceMkdir(pluginBasedir);
    File targetFile=new File(pluginBasedir,pluginFile.getName());
    FileUtils.copyFile(pluginFile,targetFile);
    metadata.addDeployedFile(targetFile);
  }
 else {
    pluginBasedir=pluginFile.getParentFile();
    metadata.addDeployedFile(pluginFile);
  }
  return pluginBasedir;
}
