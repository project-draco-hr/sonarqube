{
  try {
    WebService.Action action=getAction(controllerPath,actionKey);
    if (request instanceof ValidatingRequest) {
      ((ValidatingRequest)request).setAction(action);
      ((ValidatingRequest)request).setLocalConnector(this);
    }
    checkActionExtension(actionExtension);
    verifyRequest(action,request);
    action.handler().handle(request,response);
  }
 catch (  IllegalArgumentException e) {
    sendErrors(response,400,new Errors().add(Message.of(e.getMessage())));
  }
catch (  BadRequestException e) {
    sendErrors(response,400,e.errors());
  }
catch (  ServerException e) {
    sendErrors(response,e.httpCode(),new Errors().add(Message.of(e.getMessage())));
  }
catch (  Exception e) {
    Loggers.get(getClass()).error("Fail to process request " + request,e);
    sendErrors(response,500,new Errors().add(Message.of(e.getMessage())));
  }
}
