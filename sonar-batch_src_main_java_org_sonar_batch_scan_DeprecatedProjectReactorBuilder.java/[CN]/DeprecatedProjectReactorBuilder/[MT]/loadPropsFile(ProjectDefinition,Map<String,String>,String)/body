{
  File propertyFile=resolvePath(parentProject.getBaseDir(),moduleProps.get(PROPERTY_PROJECT_CONFIG_FILE));
  if (propertyFile.isFile()) {
    Properties propsFromFile=toProperties(propertyFile);
    for (    Entry<Object,Object> entry : propsFromFile.entrySet()) {
      moduleProps.put(entry.getKey().toString(),entry.getValue().toString());
    }
    File baseDir=null;
    if (moduleProps.containsKey(PROPERTY_PROJECT_BASEDIR)) {
      baseDir=resolvePath(propertyFile.getParentFile(),moduleProps.get(PROPERTY_PROJECT_BASEDIR));
    }
 else {
      baseDir=propertyFile.getParentFile();
    }
    setProjectBaseDir(baseDir,moduleProps,moduleId);
    return baseDir;
  }
 else {
    throw new IllegalStateException("The properties file of the module '" + moduleId + "' does not exist: "+ propertyFile.getAbsolutePath());
  }
}
