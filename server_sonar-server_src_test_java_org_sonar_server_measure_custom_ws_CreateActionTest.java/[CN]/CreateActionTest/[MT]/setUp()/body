{
  dbClient=new DbClient(db.database(),db.myBatis(),new CustomMeasureDao(),new MetricDao(),new ComponentDao());
  dbSession=dbClient.openSession(false);
  Durations durations=new Durations(mock(Settings.class),mock(I18n.class));
  TypeValidations typeValidations=new TypeValidations(Arrays.asList(new BooleanTypeValidation(),new IntegerTypeValidation(),new FloatTypeValidation(),new MetricLevelTypeValidation(),new MetricWorkDurationTypeValidation(durations)));
  ws=new WsTester(new CustomMeasuresWs(new CreateAction(dbClient,userSession,System2.INSTANCE,typeValidations,durations)));
  db.truncateTables();
  userSession.setGlobalPermissions(GlobalPermissions.SYSTEM_ADMIN);
}
