{
  Integer previousLine=oldIssue.line();
  if (previousLine == null) {
    return;
  }
  Collection<Integer> newLinesWithSameHash=sourceHashHolder.getNewLinesMatching(previousLine);
  if (newLinesWithSameHash.isEmpty()) {
    if (previousLine > sourceHashHolder.getHashedSource().length()) {
      newIssue.setLine(null);
      updater.setStatus(newIssue,Issue.STATUS_CLOSED,changeContext);
      updater.setResolution(newIssue,Issue.RESOLUTION_REMOVED,changeContext);
      updater.setPastLine(newIssue,previousLine);
      updater.setPastMessage(newIssue,oldIssue.message(),changeContext);
    }
  }
 else   if (newLinesWithSameHash.size() == 1) {
    Integer newLine=newLinesWithSameHash.iterator().next();
    newIssue.setLine(newLine);
    updater.setPastLine(newIssue,previousLine);
    updater.setPastMessage(newIssue,oldIssue.message(),changeContext);
  }
}
