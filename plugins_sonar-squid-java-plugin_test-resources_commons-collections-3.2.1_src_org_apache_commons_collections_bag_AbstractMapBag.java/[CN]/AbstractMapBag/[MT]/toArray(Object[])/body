{
  int size=size();
  if (array.length < size) {
    array=(Object[])Array.newInstance(array.getClass().getComponentType(),size);
  }
  int i=0;
  Iterator it=map.keySet().iterator();
  while (it.hasNext()) {
    Object current=it.next();
    for (int index=getCount(current); index > 0; index--) {
      array[i++]=current;
    }
  }
  if (array.length > size) {
    array[size]=null;
  }
  return array;
}
