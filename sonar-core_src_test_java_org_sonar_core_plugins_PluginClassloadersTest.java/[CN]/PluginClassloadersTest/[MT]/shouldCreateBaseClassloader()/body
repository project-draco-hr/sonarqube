{
  classloaders=new PluginClassloaders(getClass().getClassLoader());
  DefaultPluginMetadata checkstyle=DefaultPluginMetadata.create("checkstyle").setMainClass("org.sonar.plugins.checkstyle.CheckstylePlugin").addDeployedFile(getFile("sonar-checkstyle-plugin-2.8.jar"));
  Map<String,Plugin> map=classloaders.init(Arrays.<PluginMetadata>asList(checkstyle));
  Plugin checkstyleEntryPoint=map.get("checkstyle");
  ClassRealm checkstyleRealm=(ClassRealm)checkstyleEntryPoint.getClass().getClassLoader();
  assertThat(checkstyleRealm.getId()).isEqualTo("checkstyle");
}
