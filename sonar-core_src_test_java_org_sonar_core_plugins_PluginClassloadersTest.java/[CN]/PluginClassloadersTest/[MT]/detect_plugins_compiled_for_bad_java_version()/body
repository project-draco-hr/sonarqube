{
  thrown.expect(SonarException.class);
  thrown.expectMessage("The plugin checkstyle is not supported with Java 1.");
  ClassWorld world=mock(ClassWorld.class);
  when(world.newRealm(anyString(),any(ClassLoader.class))).thenThrow(new UnsupportedClassVersionError());
  classloaders=new PluginClassloaders(getClass().getClassLoader(),world);
  DefaultPluginMetadata checkstyle=DefaultPluginMetadata.create(null).setKey("checkstyle").setMainClass("org.sonar.plugins.checkstyle.CheckstylePlugin").addDeployedFile(getFile("sonar-checkstyle-plugin-2.8.jar"));
  classloaders.init(Arrays.<PluginMetadata>asList(checkstyle));
}
