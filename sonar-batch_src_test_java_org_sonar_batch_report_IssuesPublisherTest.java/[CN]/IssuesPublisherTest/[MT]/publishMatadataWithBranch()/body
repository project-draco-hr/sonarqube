{
  root.properties().put(CoreProperties.PROJECT_BRANCH_PROPERTY,"myBranch");
  p.setKey("foo:myBranch");
  p.setEffectiveKey("foo:myBranch");
  File outputDir=temp.newFolder();
  BatchReportWriter writer=new BatchReportWriter(outputDir);
  publisher.publish(writer);
  BatchReportReader reader=new BatchReportReader(outputDir);
  Metadata metadata=reader.readMetadata();
  assertThat(metadata.getAnalysisDate()).isEqualTo(1234567L);
  assertThat(metadata.getProjectKey()).isEqualTo("foo");
  assertThat(metadata.getBranch()).isEqualTo("myBranch");
  assertThat(metadata.getDeletedComponentsCount()).isEqualTo(0);
  assertThat(metadata.getSnapshotId()).isEqualTo(2);
}
