{
  ComponentDto projectDto=ComponentTesting.newProjectDto(PROJECT_UUID).setKey(PROJECT_KEY);
  dbClient.componentDao().insert(dbSession,projectDto);
  PermissionTemplateDto permissionTemplateDto=dbClient.permissionTemplateDao().insert(dbSession,newPermissionTemplateDto().setName("Default"));
  settings.setProperty("sonar.permission.template.default",permissionTemplateDto.getKee());
  dbClient.permissionTemplateDao().insertGroupPermission(permissionTemplateDto.getId(),null,UserRole.USER);
  dbSession.commit();
  Component project=ReportComponent.builder(Component.Type.PROJECT,1).setUuid(PROJECT_UUID).setKey(PROJECT_KEY).build();
  dbIdsRepository.setComponentId(project,projectDto.getId());
  treeRootHolder.setRoot(project);
  step.execute();
  dbSession.commit();
  assertThat(dbClient.componentDao().selectOrFailByKey(dbSession,PROJECT_KEY).getAuthorizationUpdatedAt()).isNotNull();
  assertThat(dbClient.roleDao().selectGroupPermissions(dbSession,DefaultGroups.ANYONE,projectDto.getId())).containsOnly(UserRole.USER);
}
