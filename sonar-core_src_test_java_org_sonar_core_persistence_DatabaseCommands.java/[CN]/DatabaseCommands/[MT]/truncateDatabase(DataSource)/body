{
  Connection connection=dataSource.getConnection();
  Statement statement=null;
  try {
    connection.setAutoCommit(false);
    statement=connection.createStatement();
    for (    String table : DatabaseVersion.TABLES) {
      try {
        statement.executeUpdate(getTruncateCommand(table));
        connection.commit();
      }
 catch (      Exception e) {
        connection.rollback();
      }
    }
  }
  finally {
    DbUtils.closeQuietly(connection);
    DbUtils.closeQuietly(statement);
  }
}
