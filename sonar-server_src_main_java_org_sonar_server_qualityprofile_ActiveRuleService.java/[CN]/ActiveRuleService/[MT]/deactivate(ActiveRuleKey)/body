{
  verifyPermission(UserSession.get());
  DbSession dbSession=db.openSession(false);
  List<ActiveRuleChange> changes=Lists.newArrayList();
  try {
    RuleActivationContext context=contextFactory.create(key,dbSession);
    ActiveRuleChange change;
    if (context.activeRule() == null) {
      return changes;
    }
    change=new ActiveRuleChange(ActiveRuleChange.Type.DEACTIVATED,key);
    changes.add(change);
    persist(changes,context,dbSession);
    dbSession.commit();
    return changes;
  }
  finally {
    dbSession.close();
  }
}
