{
  if (batchResource.snapshot() != null) {
    return;
  }
  BatchResource parentBatchResource=batchResource.parent();
  Snapshot s;
  if (parentBatchResource != null) {
    persist(parentBatchResource);
    s=persist(findModule(parentBatchResource),batchResource.resource(),parentBatchResource.resource());
  }
 else {
    s=persistProject((Project)batchResource.resource(),null);
  }
  batchResource.setSnapshot(s);
  if (ResourceUtils.isPersistable(batchResource.resource())) {
    scanGraph.completeComponent(batchResource.key(),batchResource.resource().getId(),s.getId());
  }
}
