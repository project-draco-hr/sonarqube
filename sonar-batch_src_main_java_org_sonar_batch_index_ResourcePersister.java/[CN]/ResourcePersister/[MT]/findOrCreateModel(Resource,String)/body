{
  ResourceModel model;
  try {
    model=session.getSingleResult(ResourceModel.class,"key",databaseKey);
    if (model == null) {
      model=createModel(resource,databaseKey);
    }
 else {
      mergeModel(model,resource);
    }
    return model;
  }
 catch (  NonUniqueResultException e) {
    throw new SonarException("The resource '" + databaseKey + "' is duplicated in database.");
  }
}
