{
  File propsFile=env.file("conf/sonar.properties");
  Properties p=new Properties();
  FileReader reader=null;
  try {
    reader=new FileReader(propsFile);
    p.load(reader);
    p.putAll(System.getenv());
    p.putAll(System.getProperties());
    p=ConfigurationUtils.interpolateEnvVariables(p);
    p=decrypt(p);
    System.setProperties(p);
    return new Props(p);
  }
 catch (  Exception e) {
    throw new IllegalStateException("File does not exist or can't be open: " + propsFile,e);
  }
 finally {
    IOUtils.closeQuietly(reader);
  }
}
