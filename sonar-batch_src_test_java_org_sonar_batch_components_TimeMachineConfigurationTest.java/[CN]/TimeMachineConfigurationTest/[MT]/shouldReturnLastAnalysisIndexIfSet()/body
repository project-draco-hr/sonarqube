{
  PropertiesConfiguration conf=new PropertiesConfiguration();
  TimeMachineConfiguration timeMachineConfiguration=new TimeMachineConfiguration(getSession(),new Project("my:project"),conf,mock(PastSnapshotFinder.class));
  assertThat(timeMachineConfiguration.getLastAnalysisPeriodIndex(),is(1));
  conf.setProperty(CoreProperties.TIMEMACHINE_PERIOD_PREFIX + 1,"Version 1");
  conf.setProperty(CoreProperties.TIMEMACHINE_PERIOD_PREFIX + 2,"Version 2");
  assertThat(timeMachineConfiguration.getLastAnalysisPeriodIndex(),is(nullValue()));
  conf.setProperty(CoreProperties.TIMEMACHINE_PERIOD_PREFIX + 4,CoreProperties.TIMEMACHINE_MODE_PREVIOUS_ANALYSIS);
  assertThat(timeMachineConfiguration.getLastAnalysisPeriodIndex(),is(4));
}
