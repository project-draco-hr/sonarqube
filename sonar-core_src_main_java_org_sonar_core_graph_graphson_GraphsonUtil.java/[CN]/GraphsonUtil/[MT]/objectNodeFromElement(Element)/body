{
  boolean isEdge=element instanceof Edge;
  boolean showTypes=mode == GraphonMode.EXTENDED;
  Set<String> propertyKeys=isEdge ? this.edgePropertyKeys : this.vertexPropertyKeys;
  ElementPropertiesRule elementPropertyConfig=isEdge ? this.edgePropertiesRule : this.vertexPropertiesRule;
  org.json.simple.JSONObject jsonElement=createJSONMap(createPropertyMap(element,propertyKeys,elementPropertyConfig),propertyKeys,showTypes);
  if ((isEdge && this.includeReservedEdgeId) || (!isEdge && this.includeReservedVertexId)) {
    putObject(jsonElement,GraphonTokens._ID,element.getId());
  }
  if (element instanceof Edge) {
    Edge edge=(Edge)element;
    if (this.includeReservedEdgeId) {
      putObject(jsonElement,GraphonTokens._ID,element.getId());
    }
    if (this.includeReservedEdgeType) {
      jsonElement.put(GraphonTokens._TYPE,GraphonTokens.EDGE);
    }
    if (this.includeReservedEdgeOutV) {
      putObject(jsonElement,GraphonTokens._OUT_V,edge.getVertex(Direction.OUT).getId());
    }
    if (this.includeReservedEdgeInV) {
      putObject(jsonElement,GraphonTokens._IN_V,edge.getVertex(Direction.IN).getId());
    }
    if (this.includeReservedEdgeLabel) {
      jsonElement.put(GraphonTokens._LABEL,edge.getLabel());
    }
  }
 else   if (element instanceof Vertex) {
    if (this.includeReservedVertexId) {
      putObject(jsonElement,GraphonTokens._ID,element.getId());
    }
    if (this.includeReservedVertexType) {
      jsonElement.put(GraphonTokens._TYPE,GraphonTokens.VERTEX);
    }
  }
  return jsonElement;
}
