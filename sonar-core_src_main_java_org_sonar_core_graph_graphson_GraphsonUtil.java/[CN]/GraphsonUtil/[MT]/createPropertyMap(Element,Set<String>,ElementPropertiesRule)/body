{
  Map map=new HashMap<>();
  if (propertyKeys == null) {
    for (    String key : element.getPropertyKeys()) {
      map.put(key,element.getProperty(key));
    }
  }
 else {
    if (rule == ElementPropertiesRule.INCLUDE) {
      for (      String key : propertyKeys) {
        Object valToPutInMap=element.getProperty(key);
        if (valToPutInMap != null) {
          map.put(key,valToPutInMap);
        }
      }
    }
 else {
      for (      String key : element.getPropertyKeys()) {
        if (!propertyKeys.contains(key)) {
          map.put(key,element.getProperty(key));
        }
      }
    }
  }
  return map;
}
