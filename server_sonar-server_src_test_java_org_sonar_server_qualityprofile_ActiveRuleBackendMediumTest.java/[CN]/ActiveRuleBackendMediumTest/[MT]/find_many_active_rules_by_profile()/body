{
  QualityProfileDto profileDto=QProfileTesting.newXooP1();
  db.qualityProfileDao().insert(dbSession,profileDto);
  int nb=100;
  for (int i=0; i < nb; i++) {
    RuleDto rule=newRuleDto(RuleKey.of("xoo","S00" + i));
    db.ruleDao().insert(dbSession,rule);
    ActiveRuleDto activeRule=ActiveRuleDto.createFor(profileDto,rule).setSeverity(Severity.MAJOR);
    db.activeRuleDao().insert(dbSession,activeRule);
  }
  dbSession.commit();
  dbSession.clearCache();
  Collection<ActiveRule> activeRules=index.findByProfile(profileDto.getKey());
  assertThat(activeRules).hasSize(nb);
}
