{
  DbSession session=dbClient.openSession(false);
  try {
    final String componentKey=request.mandatoryParam("key");
    final ComponentDto component=componentFinder.getByKey(session,componentKey);
    userSession.checkProjectUuidPermission(UserRole.USER,component.projectUuid());
    response.stream().setMediaType("text/plain");
    OutputStreamWriter writer=new OutputStreamWriter(response.stream().output(),StandardCharsets.UTF_8);
    try {
      HashFunction hashFunction=new HashFunction(writer,componentKey);
      dbClient.fileSourceDao().readLineHashesStream(session,component.uuid(),hashFunction);
      if (!hashFunction.hasData()) {
        response.noContent();
      }
    }
  finally {
      writer.close();
    }
  }
  finally {
    session.close();
  }
}
