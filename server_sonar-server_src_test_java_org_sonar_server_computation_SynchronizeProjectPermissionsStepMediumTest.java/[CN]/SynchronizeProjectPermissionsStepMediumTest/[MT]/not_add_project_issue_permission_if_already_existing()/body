{
  ComponentDto project=insertPermissionsForProject(DEFAULT_PROJECT_KEY);
  db.issueAuthorizationDao().synchronizeAfter(session,null,ImmutableMap.of(IssueAuthorizationDao.PROJECT_UUID,project.uuid()));
  tester.get(PermissionFacade.class).insertGroupPermission(project.getId(),DefaultGroups.USERS,UserRole.USER,session);
  queue.add(DEFAULT_PROJECT_KEY,123L);
  List<AnalysisReportDto> reports=queue.findByProjectKey(DEFAULT_PROJECT_KEY);
  getAndSetProjectStep.execute(session,reports.get(0));
  sut.execute(session,reports.get(0));
  IssueAuthorizationDoc issueAuthorizationIndex=tester.get(IssueAuthorizationIndex.class).getNullableByKey(project.uuid());
  assertThat(issueAuthorizationIndex).isNotNull();
  assertThat(issueAuthorizationIndex.groups()).containsExactly(DefaultGroups.ANYONE);
}
