{
  when(dao.selectEnabledCharacteristics(session)).thenReturn(newArrayList(new CharacteristicDto().setId(1).setKey("PORTABILITY").setName("Portability updated").setOrder(2),new CharacteristicDto().setId(2).setKey("COMPILER").setName("Compiler updated").setParentId(1)));
  when(ruleDao.selectEnabledAndNonManual(session)).thenReturn(newArrayList(new RuleDto().setId(1).setRepositoryKey("squid").setRuleKey("UselessImportCheck").setLanguage("java").setSubCharacteristicId(2).setRemediationFunction(DebtRemediationFunction.Type.CONSTANT_ISSUE.toString()).setRemediationOffset("15min"),new RuleDto().setId(2).setRepositoryKey("checkstyle").setLanguage("java2").setSubCharacteristicId(3).setRemediationFunction(DebtRemediationFunction.Type.LINEAR.toString()).setRemediationCoefficient("2h")));
  underTest.backup("java");
  verify(debtModelXMLExporter).export(any(DebtModel.class),ruleDebtListCaptor.capture());
  List<RuleDebt> rules=ruleDebtListCaptor.getValue();
  assertThat(rules).hasSize(1);
  RuleDebt rule=rules.get(0);
  assertThat(rule.ruleKey().repository()).isEqualTo("squid");
  assertThat(rule.ruleKey().rule()).isEqualTo("UselessImportCheck");
  assertThat(rule.subCharacteristicKey()).isEqualTo("COMPILER");
  assertThat(rule.function()).isEqualTo("CONSTANT_ISSUE");
  assertThat(rule.coefficient()).isNull();
  assertThat(rule.offset()).isEqualTo("15min");
}
