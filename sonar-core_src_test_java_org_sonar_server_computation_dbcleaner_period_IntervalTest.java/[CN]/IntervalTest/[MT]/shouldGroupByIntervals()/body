{
  List<PurgeableSnapshotDto> snapshots=Arrays.asList(DbCleanerTestUtils.createSnapshotWithDate(1L,"2011-04-03"),DbCleanerTestUtils.createSnapshotWithDate(2L,"2011-05-01"),DbCleanerTestUtils.createSnapshotWithDate(3L,"2011-05-19"),DbCleanerTestUtils.createSnapshotWithDate(4L,"2011-06-02"),DbCleanerTestUtils.createSnapshotWithDate(5L,"2011-06-20"),DbCleanerTestUtils.createSnapshotWithDate(6L,"2012-06-29"));
  List<Interval> intervals=Interval.group(snapshots,DateUtils.parseDate("2010-01-01"),DateUtils.parseDate("2011-12-31"),Calendar.MONTH);
  assertThat(intervals.size(),is(3));
  assertThat(intervals.get(0).count(),is(1));
  assertThat(calendarField(intervals.get(0),Calendar.MONTH),is(Calendar.APRIL));
  assertThat(intervals.get(1).count(),is(2));
  assertThat(calendarField(intervals.get(1),Calendar.MONTH),is(Calendar.MAY));
  assertThat(intervals.get(2).count(),is(2));
  assertThat(calendarField(intervals.get(2),Calendar.MONTH),is(Calendar.JUNE));
}
