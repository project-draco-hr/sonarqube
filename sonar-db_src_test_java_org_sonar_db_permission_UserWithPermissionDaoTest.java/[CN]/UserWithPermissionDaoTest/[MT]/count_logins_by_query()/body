{
  UserDto user1=userDb.insertUser(newUserDto());
  UserDto user2=userDb.insertUser(newUserDto());
  UserDto user3=userDb.insertUser(newUserDto());
  UserDto user4=userDb.insertUser(newUserDto());
  ComponentDto project=componentDb.insertComponent(newProjectDto());
  permissionDb.addGlobalPermissionToUser(SYSTEM_ADMIN,user1.getId());
  permissionDb.addGlobalPermissionToUser(SYSTEM_ADMIN,user2.getId());
  permissionDb.addGlobalPermissionToUser(SYSTEM_ADMIN,user3.getId());
  permissionDb.addGlobalPermissionToUser(PROVISIONING,user3.getId());
  permissionDb.addProjectPermissionToUser(USER,user4.getId(),project.getId());
  assertThat(countUsersByQuery(PermissionQuery.builder().build())).isEqualTo(4);
  assertThat(countUsersByQuery(PermissionQuery.builder().setPermission(PROVISIONING).build())).isEqualTo(1);
  assertThat(countUsersByQuery(PermissionQuery.builder().withPermissionOnly().setComponentUuid(project.uuid()).build())).isEqualTo(1);
}
