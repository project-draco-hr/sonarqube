{
  UserDto user=userDb.insertUser(newUserDto().setLogin("user-login"));
  UserDto anotherUser=userDb.insertUser(newUserDto().setLogin("another-login"));
  ComponentDto project=componentDb.insertComponent(newProjectDto());
  permissionDb.addProjectPermissionToUser(UserRole.ADMIN,user.getId(),project.getId());
  permissionDb.addProjectPermissionToUser(UserRole.ADMIN,anotherUser.getId(),project.getId());
  PermissionQuery.Builder dbQuery=PermissionQuery.builder().setComponentUuid(project.uuid()).setLogins(singletonList("user-login")).withPermissionOnly();
  List<UserPermissionDto> result=selectUserPermissionsByQuery(dbQuery);
  assertThat(result).hasSize(1);
  UserPermissionDto userPermission=result.get(0);
  assertThat(userPermission.getComponentId()).isEqualTo(project.getId());
  assertThat(userPermission.getPermission()).isEqualTo(UserRole.ADMIN);
  assertThat(userPermission.getUserId()).isEqualTo(user.getId());
}
