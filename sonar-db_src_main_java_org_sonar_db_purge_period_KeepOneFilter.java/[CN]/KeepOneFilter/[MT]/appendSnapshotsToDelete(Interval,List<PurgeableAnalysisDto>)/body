{
  if (interval.count() > 1) {
    List<PurgeableAnalysisDto> deletables=Lists.newArrayList();
    List<PurgeableAnalysisDto> toKeep=Lists.newArrayList();
    for (    PurgeableAnalysisDto snapshot : interval.get()) {
      if (isDeletable(snapshot)) {
        deletables.add(snapshot);
      }
 else {
        toKeep.add(snapshot);
      }
    }
    if (!toKeep.isEmpty()) {
      toDelete.addAll(deletables);
    }
 else     if (deletables.size() > 1) {
      toDelete.addAll(deletables.subList(0,deletables.size() - 1));
    }
  }
}
