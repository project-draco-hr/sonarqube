{
  List<DecoratorContext> childrenContexts=new ArrayList<DecoratorContext>();
  for (  Resource child : index.getChildren(resource)) {
    boolean isModule=(child instanceof Project);
    DefaultDecoratorContext childContext=(DefaultDecoratorContext)decorateResource(child,decorators,!isModule);
    childrenContexts.add(childContext.setReadOnly(true));
  }
  DefaultDecoratorContext context=new DefaultDecoratorContext(resource,index,childrenContexts,session);
  if (executeDecorators) {
    for (    Decorator decorator : decorators) {
      decorator.decorate(resource,context);
    }
  }
  return context;
}
