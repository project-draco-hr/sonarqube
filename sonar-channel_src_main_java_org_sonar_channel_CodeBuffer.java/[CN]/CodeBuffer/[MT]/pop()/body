{
  if (bufferPosition == bufferSize) {
    fillBuffer();
  }
  if (bufferSize == 0) {
    return -1;
  }
  int character=buffer[bufferPosition++];
  updateCursorPosition(character);
  if (recordingMode) {
    recordedCharacters.append((char)character);
  }
  lastChar=character;
  return character;
}
