{
  Issue issue=new DefaultIssue().setComponentKey("org/struts/Action.java").setKey("ABCDE");
  when(cache.componentIssue("org/struts/Action.java","ABCDE")).thenReturn(issue);
  Issue changed=changes.apply(issue,IssueChange.create().setLine(200).setResolution(Issue.RESOLUTION_FALSE_POSITIVE).setAttribute("JIRA","FOO-123").setManualSeverity(true).setSeverity(Severity.CRITICAL).setAssignee("arthur").setCost(4.2));
  verify(cache).addOrUpdate(issue);
  assertThat(changed.line()).isEqualTo(200);
  assertThat(changed.resolution()).isEqualTo(Issue.RESOLUTION_FALSE_POSITIVE);
  assertThat(changed.attribute("JIRA")).isEqualTo("FOO-123");
  assertThat(changed.severity()).isEqualTo(Severity.CRITICAL);
  assertThat(changed.assigneeLogin()).isEqualTo("arthur");
  assertThat(changed.cost()).isEqualTo(4.2);
  assertThat(changed.updatedAt()).isNotNull();
}
