{
  Issue issue=new DefaultIssue().setComponentKey("org/struts/Action.java").setKey("ABCDE");
  when(cache.componentIssue("org/struts/Action.java","ABCDE")).thenReturn(null);
  try {
    changes.apply(issue,IssueChange.create().setLine(200));
    fail();
  }
 catch (  IllegalStateException e) {
    assertThat(e).hasMessage("Bad API usage. Unregistered issues can't be changed.");
  }
}
