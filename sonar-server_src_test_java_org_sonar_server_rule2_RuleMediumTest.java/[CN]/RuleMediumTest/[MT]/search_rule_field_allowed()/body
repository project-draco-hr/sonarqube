{
  String lang="java";
  RuleDao dao=tester.get(RuleDao.class);
  dao.insert(newRuleDto(RuleKey.of("javascript","S001")).setLanguage(lang));
  RuleService service=tester.get(RuleService.class).refresh();
  RuleQuery query=service.newRuleQuery();
  QueryOptions options=new QueryOptions();
  options.getFieldsToReturn().add(RuleNormalizer.RuleField.LANGUAGE.key());
  Results results=service.search(query,options);
  assertThat(results.getTotal()).isEqualTo(1);
  assertThat(results.getHits()).hasSize(1);
  assertThat(Iterables.getFirst(results.getHits(),null).getFieldAsString("key")).isEqualTo("S001");
  assertThat(Iterables.getFirst(results.getHits(),null).getFieldAsString(RuleNormalizer.RuleField.LANGUAGE.key())).isNotNull();
  assertThat(Iterables.getFirst(results.getHits(),null).getFieldAsString(RuleNormalizer.RuleField.LANGUAGE.key())).isEqualTo(lang);
}
