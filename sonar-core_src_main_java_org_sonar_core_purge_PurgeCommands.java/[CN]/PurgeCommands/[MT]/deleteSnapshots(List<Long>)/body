{
  List<List<Long>> snapshotIdsPartition=Lists.partition(snapshotIds,MAX_SNAPSHOTS_PER_QUERY);
  deleteSnapshotDependencies(snapshotIdsPartition);
  deleteSnapshotDuplications(snapshotIdsPartition);
  profiler.start("deleteSnapshotEvents (events)");
  for (  List<Long> partSnapshotIds : snapshotIdsPartition) {
    purgeMapper.deleteSnapshotEvents(partSnapshotIds);
  }
  session.commit();
  profiler.stop();
  profiler.start("deleteSnapshotMeasureData (measure_data)");
  for (  List<Long> partSnapshotIds : snapshotIdsPartition) {
    purgeMapper.deleteSnapshotMeasureData(partSnapshotIds);
  }
  session.commit();
  profiler.stop();
  profiler.start("deleteSnapshotMeasures (project_measures)");
  for (  List<Long> partSnapshotIds : snapshotIdsPartition) {
    purgeMapper.deleteSnapshotMeasures(partSnapshotIds);
  }
  session.commit();
  profiler.stop();
  deleteSnapshotSources(snapshotIdsPartition);
  deleteSnapshotGraphs(snapshotIdsPartition);
  deleteSnapshotData(snapshotIdsPartition);
  profiler.start("deleteSnapshot (snapshots)");
  for (  List<Long> partSnapshotIds : snapshotIdsPartition) {
    purgeMapper.deleteSnapshot(partSnapshotIds);
  }
  session.commit();
  profiler.stop();
}
