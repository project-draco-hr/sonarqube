{
  deleteSnapshotDependencies(snapshotIds);
  deleteSnapshotDuplications(snapshotIds);
  profiler.start("deleteSnapshotEvents (events)");
  for (  Long snapshotId : snapshotIds) {
    purgeMapper.deleteSnapshotEvents(snapshotId);
  }
  session.commit();
  profiler.stop();
  profiler.start("deleteSnapshotMeasureData (measure_data)");
  for (  Long snapshotId : snapshotIds) {
    purgeMapper.deleteSnapshotMeasureData(snapshotId);
  }
  session.commit();
  profiler.stop();
  profiler.start("deleteSnapshotMeasures (project_measures)");
  for (  Long snapshotId : snapshotIds) {
    purgeMapper.deleteSnapshotMeasures(snapshotId);
  }
  session.commit();
  profiler.stop();
  deleteSnapshotSources(snapshotIds);
  deleteSnapshotGraphs(snapshotIds);
  deleteSnapshotData(snapshotIds);
  profiler.start("deleteSnapshot (snapshots)");
  for (  Long snapshotId : snapshotIds) {
    purgeMapper.deleteSnapshot(snapshotId);
  }
  session.commit();
  profiler.stop();
}
