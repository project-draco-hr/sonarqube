{
  profiler.start("deleteSnapshotViolations (rule_failures)");
  for (  Long snapshotId : snapshotIds) {
    purgeMapper.deleteSnapshotViolations(snapshotId);
  }
  session.commit();
  profiler.stop();
}
