{
  when(system2.now()).thenReturn(DateUtils.parseDate("2014-01-01").getTime());
  dbTester.prepareDbUnit(getClass(),"update.xml");
  RuleDto ruleToUpdate=new RuleDto().setId(1).setRuleKey("NewRuleKey").setRepositoryKey("plugin").setName("new name").setDescription("new description").setDescriptionFormat(Format.MARKDOWN).setStatus(RuleStatus.DEPRECATED).setConfigKey("NewConfigKey").setSeverity(Severity.INFO).setIsTemplate(true).setLanguage("dart").setTemplateId(3).setNoteData("My note").setNoteUserLogin("admin").setNoteCreatedAt(DateUtils.parseDate("2013-12-19")).setNoteUpdatedAt(DateUtils.parseDate("2013-12-20")).setSubCharacteristicId(100).setDefaultSubCharacteristicId(101).setRemediationFunction(DebtRemediationFunction.Type.LINEAR.toString()).setDefaultRemediationFunction(DebtRemediationFunction.Type.LINEAR_OFFSET.toString()).setRemediationCoefficient("1h").setDefaultRemediationCoefficient("5d").setRemediationOffset("5min").setDefaultRemediationOffset("10h").setEffortToFixDescription("squid.S115.effortToFix");
  dao.update(dbTester.getSession(),ruleToUpdate);
  dbTester.getSession().commit();
  dbTester.assertDbUnit(getClass(),"update-result.xml","rules");
}
