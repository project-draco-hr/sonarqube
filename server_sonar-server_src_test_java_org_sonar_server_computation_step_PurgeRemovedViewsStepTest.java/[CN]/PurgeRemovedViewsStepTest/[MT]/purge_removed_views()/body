{
  when(context.getProject()).thenReturn(ComponentTesting.newProjectDto("DBCA").setQualifier(Qualifiers.VIEW));
  esTester.putDocuments(ViewIndexDefinition.INDEX,ViewIndexDefinition.TYPE_VIEW,new ViewDoc().setUuid("ABCD").getFields(),new ViewDoc().setUuid("BCDE").getFields(),new ViewDoc().setUuid("CDEF").getFields());
  ComponentDto view=ComponentTesting.newProjectDto("ABCD").setQualifier(Qualifiers.VIEW);
  ComponentDto subView=ComponentTesting.newModuleDto("BCDE",view).setQualifier(Qualifiers.SUBVIEW);
  dbClient.componentDao().insert(session,view,subView);
  session.commit();
  step.execute(context);
  List<String> viewUuids=esTester.getDocumentFields(ViewIndexDefinition.INDEX,ViewIndexDefinition.TYPE_VIEW,ViewIndexDefinition.FIELD_UUID);
  assertThat(viewUuids).containsOnly("ABCD","BCDE");
}
