{
  File webDir=temp.newFolder("web");
  Tomcat tomcat=mock(Tomcat.class,RETURNS_DEEP_STUBS);
  when(tomcat.addContext("",webDir.getAbsolutePath())).thenThrow(new NullPointerException());
  try {
    Webapp.configure(tomcat,props);
    fail();
  }
 catch (  IllegalStateException e) {
    assertThat(e).hasMessage("Fail to configure webapp");
  }
}
