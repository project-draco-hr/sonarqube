{
  BoolFilterBuilder filter=activeRuleFilter(query);
  SearchRequestBuilder builder=index.client().prepareSearch(INDEX_RULES).setTypes(TYPE_ACTIVE_RULE).setFilter(filter);
  List<String> documentIds=index.findDocumentIds(builder,2);
  return newArrayList(Iterables.transform(documentIds,new Function<String,Integer>(){
    @Override public Integer apply(    @Nullable String input){
      return Integer.valueOf(input);
    }
  }
));
}
