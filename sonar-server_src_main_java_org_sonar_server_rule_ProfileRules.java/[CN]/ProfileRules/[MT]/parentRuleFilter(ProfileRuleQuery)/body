{
  BoolFilterBuilder result=boolFilter();
  if (StringUtils.isNotBlank(query.language())) {
    result.must(termFilter(RuleDocument.FIELD_LANGUAGE,query.language()));
  }
  addMustTermOrTerms(result,RuleDocument.FIELD_REPOSITORY_KEY,query.repositoryKeys());
  if (query.statuses().isEmpty()) {
    result.mustNot(termFilter(RuleDocument.FIELD_STATUS,Rule.STATUS_REMOVED));
  }
 else {
    addMustTermOrTerms(result,RuleDocument.FIELD_STATUS,query.statuses());
  }
  if (StringUtils.isNotBlank(query.nameOrKey())) {
    result.must(queryFilter(multiMatchQuery(query.nameOrKey(),RuleDocument.FIELD_NAME,RuleDocument.FIELD_KEY).operator(Operator.AND)));
  }
  return result;
}
