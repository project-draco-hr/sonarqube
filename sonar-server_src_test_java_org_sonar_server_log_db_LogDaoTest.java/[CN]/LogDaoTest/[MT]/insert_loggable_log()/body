{
  final String testKey="message";
  final String testValue="hello world";
  LogDto log=LogDto.createFor(new Loggable(){
    @Override public Map<String,String> getDetails(){
      return ImmutableMap.of(testKey,testValue);
    }
    @Override public int getExecutionTime(){
      return 12;
    }
  }
).setAuthor("jUnit").setType(Log.Type.ACTIVE_RULE);
  dao.insert(session,log);
  assertThat(dao.findAll(session)).hasSize(1);
  LogDto newDto=dao.getByKey(session,log.getKey());
  assertThat(newDto.getAuthor()).isEqualTo(log.getAuthor());
  assertThat(newDto.getExecutionTime()).isEqualTo(12);
  assertThat(newDto.getData()).isNotNull();
  Map<String,String> details=KeyValueFormat.parse(newDto.getData());
  assertThat(details.get(testKey)).isEqualTo(testValue);
}
