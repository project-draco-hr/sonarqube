{
  String query=request.param("q");
  String languageKey=request.param("language");
  int pageSize=request.mandatoryParamAsInt("ps");
  JsonWriter json=response.newJsonWriter().beginObject().name("repositories").beginArray();
  for (  Repository repo : listMatchingRepositories(query,languageKey,pageSize)) {
    json.beginObject().prop("key",repo.key()).prop("name",repo.name()).prop("language",repo.language()).endObject();
  }
  json.endArray().endObject().close();
}
