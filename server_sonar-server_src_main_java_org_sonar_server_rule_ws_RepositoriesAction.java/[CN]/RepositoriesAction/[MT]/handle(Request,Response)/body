{
  String query=request.param(Param.TEXT_QUERY);
  String languageKey=request.param(LANGUAGE);
  int pageSize=request.mandatoryParamAsInt("ps");
  JsonWriter json=response.newJsonWriter().beginObject().name("repositories").beginArray();
  for (  Repo repo : listMatchingRepositories(query,languageKey,pageSize)) {
    json.beginObject().prop("key",repo.key).prop("name",repo.name).prop(LANGUAGE,repo.language).endObject();
  }
  json.endArray().endObject().close();
}
