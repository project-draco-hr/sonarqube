{
  Pattern pattern=Pattern.compile(query == null ? MATCH_ALL : MATCH_ALL + query + MATCH_ALL,Pattern.CASE_INSENSITIVE);
  SortedMap<String,Repo> reposByName=Maps.newTreeMap();
  Collection<Repo> repos=listRepositories(languageKey);
  for (  Repo repo : repos) {
    if (pattern.matcher(repo.key).matches() || pattern.matcher(repo.name).matches()) {
      reposByName.put(repo.name + " -- " + repo.language,repo);
    }
  }
  List<Repo> result=Lists.newArrayList(reposByName.values());
  if (pageSize > 0 && pageSize < result.size()) {
    result=result.subList(0,pageSize);
  }
  return result;
}
