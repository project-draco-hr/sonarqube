{
  setupData("shared");
  RegisterRules task=new RegisterRules(getSessionFactory(),new RuleRepository[]{new FakeRepository()});
  task.start();
  List<Rule> result=getSession().getResults(Rule.class,"pluginName","fake");
  assertThat(result.size(),is(2));
  Rule first=result.get(0);
  assertThat(first.getKey(),is("rule1"));
  assertThat(first.getRepositoryKey(),is("fake"));
  assertThat(first.isEnabled(),is(true));
  assertThat(first.getParams().size(),is(2));
}
