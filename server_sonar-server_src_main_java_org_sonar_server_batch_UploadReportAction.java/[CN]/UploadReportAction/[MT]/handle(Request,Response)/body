{
  UserSession.get().checkGlobalPermission(GlobalPermissions.SCAN_EXECUTION);
  if (settings.getString("sonar.issues.use_es_backend") != null) {
    DbSession session=dbClient.openSession(false);
    try {
      String projectKey=request.mandatoryParam(PARAM_PROJECT);
      AuthorizedComponentDto project=dbClient.componentDao().getAuthorizedComponentByKey(projectKey,session);
      computationService.create(projectKey);
      if (index.get(IssueAuthorizationIndex.class).getNullableByKey(project.key()) == null) {
        permissionService.synchronizePermissions(session,project.key());
        session.commit();
      }
      dbClient.issueDao().synchronizeAfter(session,index.get(IssueIndex.class).getLastSynchronization(),ImmutableMap.of("project",project.key()));
      session.commit();
    }
  finally {
      MyBatis.closeQuietly(session);
    }
  }
}
