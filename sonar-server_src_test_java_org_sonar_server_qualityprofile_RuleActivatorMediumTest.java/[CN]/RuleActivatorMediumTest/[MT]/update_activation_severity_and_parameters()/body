{
  ActiveRuleKey activeRuleKey=ActiveRuleKey.of(XOO_PROFILE_KEY,XOO_RULE_1);
  RuleActivation activation=new RuleActivation(activeRuleKey);
  activation.setSeverity(Severity.BLOCKER);
  ruleActivator.activate(activation);
  RuleActivation update=new RuleActivation(activeRuleKey);
  update.setSeverity(Severity.CRITICAL);
  update.setParameter("max","42");
  List<ActiveRuleChange> changes=ruleActivator.activate(update);
  assertThat(countActiveRules(XOO_PROFILE_KEY)).isEqualTo(1);
  verifyHasActiveRule(activeRuleKey,Severity.CRITICAL,null,ImmutableMap.of("max","42"));
  assertThat(changes).hasSize(1);
  assertThat(changes.get(0).getType()).isEqualTo(ActiveRuleChange.Type.UPDATED);
}
