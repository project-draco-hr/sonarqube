{
  int bulkSize=QueryOptions.MAX_LIMIT + 10;
  for (int i=0; i < bulkSize; i++) {
    db.ruleDao().insert(dbSession,RuleDto.createFor(RuleKey.of("bulk","r_" + i)).setLanguage("xoo").setSeverity("BLOCKER").setStatus(RuleStatus.READY));
  }
  dbSession.commit();
  verifyZeroActiveRules(XOO_PROFILE_KEY);
  assertThat(tester.get(RuleIndex.class).search(new RuleQuery().setQueryText("bulk"),new QueryOptions()).getTotal()).isEqualTo(bulkSize);
  Multimap<String,String> result=ruleActivator.bulkActivate(new RuleQuery().setQueryText("bulk"),XOO_PROFILE_KEY,"MINOR");
  dbSession.clearCache();
  assertThat(db.activeRuleDao().findByProfileKey(dbSession,XOO_PROFILE_KEY)).hasSize(bulkSize);
  assertThat(index.findByProfile(XOO_PROFILE_KEY)).hasSize(bulkSize);
}
