{
  ignoreStartupFailure=settings.getBoolean(CoreProperties.CORE_AUTHENTICATOR_IGNORE_STARTUP_FAILURE);
  String realmName=settings.getString(REALM_PROPERTY);
  String className=settings.getString(CoreProperties.CORE_AUTHENTICATOR_CLASS);
  SecurityRealm selectedRealm=null;
  if (!StringUtils.isEmpty(realmName)) {
    selectedRealm=selectRealm(realms,realmName);
    if (selectedRealm == null) {
      throw new SonarException("Realm '" + realmName + "' not found. Please check the property '"+ REALM_PROPERTY+ "' in conf/sonar.properties");
    }
  }
  if (selectedRealm == null && !StringUtils.isEmpty(className)) {
    LoginPasswordAuthenticator authenticator=selectAuthenticator(authenticators,className);
    if (authenticator == null) {
      throw new SonarException("Authenticator '" + className + "' not found. Please check the property '"+ CoreProperties.CORE_AUTHENTICATOR_CLASS+ "' in conf/sonar.properties");
    }
    selectedRealm=new CompatibilityRealm(authenticator);
  }
  realm=selectedRealm;
}
