{
  boolean indexed=false;
  SqlSession session=mybatis.openSession(false);
  try {
    ResourceIndexerMapper mapper=session.getMapper(ResourceIndexerMapper.class);
    ResourceDto resource=mapper.selectResourceToIndex(id);
    if (resource != null) {
      Long rootId=resource.getRootId();
      if (rootId == null) {
        rootId=resource.getId();
      }
      indexed=indexResource(resource.getId(),resource.getName(),resource.getQualifier(),rootId,session,mapper);
    }
    return indexed;
  }
  finally {
    MyBatis.closeQuietly(session);
  }
}
