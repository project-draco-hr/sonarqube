{
  ResourceIndexerQuery query=ResourceIndexerQuery.create().setNonIndexedOnly(true).setQualifiers(NOT_RENAMABLE_QUALIFIERS).setScopes(NOT_RENAMABLE_SCOPES).setRootProjectId(rootProjectId);
  session.select(SELECT_RESOURCES,query,new ResultHandler(){
    public void handleResult(    ResultContext context){
      ResourceDto resource=(ResourceDto)context.getResultObject();
      doIndex(resource,mapper);
    }
  }
);
  query=ResourceIndexerQuery.create().setNonIndexedOnly(false).setQualifiers(RENAMABLE_QUALIFIERS).setScopes(RENAMABLE_SCOPES).setRootProjectId(rootProjectId);
  session.select(SELECT_RESOURCES,query,new ResultHandler(){
    public void handleResult(    ResultContext context){
      ResourceDto resource=(ResourceDto)context.getResultObject();
      mapper.deleteByResourceId(resource.getId());
      doIndex(resource,mapper);
    }
  }
);
}
