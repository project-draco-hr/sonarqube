{
  ResourceIndexerFilter filter=ResourceIndexerFilter.create().setNonIndexedOnly(true).setQualifiers(NOT_RENAMABLE_QUALIFIERS).setScopes(NOT_RENAMABLE_SCOPES).setRootProjectId(rootProjectId);
  session.select("selectResources",filter,new ResultHandler(){
    public void handleResult(    ResultContext context){
      ResourceDto resource=(ResourceDto)context.getResultObject();
      doIndex(resource,mapper);
    }
  }
);
  filter=ResourceIndexerFilter.create().setNonIndexedOnly(false).setQualifiers(RENAMABLE_QUALIFIERS).setScopes(RENAMABLE_SCOPES).setRootProjectId(rootProjectId);
  session.select("selectResources",filter,new ResultHandler(){
    public void handleResult(    ResultContext context){
      ResourceDto resource=(ResourceDto)context.getResultObject();
      mapper.deleteByResourceId(resource.getId());
      doIndex(resource,mapper);
    }
  }
);
}
