{
  if (currentVersion == null) {
    return null;
  }
  List<SnapshotDto> snapshotDtos=dbClient.snapshotDao().selectPreviousVersionSnapshots(session,projectUuid,currentVersion);
  if (snapshotDtos.isEmpty()) {
    return findByFirstAnalysis(index);
  }
  SnapshotDto snapshotDto=snapshotDtos.get(0);
  LOG.debug("Compare to previous version ({})",formatDate(snapshotDto.getCreatedAt()));
  return new Period(index,TIMEMACHINE_MODE_PREVIOUS_VERSION,snapshotDto.getVersion(),snapshotDto.getCreatedAt(),snapshotDto.getUuid());
}
