{
  PluginInfo info=new PluginInfo("foo");
  PluginRepository pluginRepository=mock(PluginRepository.class);
  when(pluginRepository.getPluginInfos()).thenReturn(newArrayList(info));
  InstalledPluginReferentialFactory factory=new InstalledPluginReferentialFactory(pluginRepository);
  assertThat(factory.getInstalledPluginReferential()).isNull();
  factory.start();
  assertThat(factory.getInstalledPluginReferential()).isNotNull();
  assertThat(factory.getInstalledPluginReferential().getPlugins()).hasSize(1);
}
