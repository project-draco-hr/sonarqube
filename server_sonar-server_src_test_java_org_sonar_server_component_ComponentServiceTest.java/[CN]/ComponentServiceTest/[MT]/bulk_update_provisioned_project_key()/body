{
  ComponentDto provisionedProject=ComponentTesting.newProjectDto().setKey("provisionedProject");
  dbClient.componentDao().insert(session,provisionedProject);
  session.commit();
  userSessionRule.login("john").addProjectUuidPermissions(UserRole.ADMIN,provisionedProject.uuid());
  service.bulkUpdateKey(provisionedProject.key(),"provisionedProject","provisionedProject2");
  session.commit();
  assertThat(service.getNullableByKey(provisionedProject.key())).isNull();
  assertThat(service.getNullableByKey("provisionedProject2")).isNotNull();
}
