{
  for (  SyntaxHighlightingRule sortedRule : highlightingPerFile.get(file).syntaxHighlightingRuleSet()) {
    if (sortedRule.getStartPosition() <= charIndex && sortedRule.getEndPosition() > charIndex) {
      return HighlightingBuilder.TypeOfText.forCssClass(sortedRule.getTextType());
    }
  }
  return null;
}
