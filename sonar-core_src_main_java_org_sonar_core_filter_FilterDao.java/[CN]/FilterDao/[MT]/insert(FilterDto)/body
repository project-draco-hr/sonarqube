{
  SqlSession session=mybatis.openSession();
  FilterMapper filterMapper=session.getMapper(FilterMapper.class);
  CriterionMapper criteriaMapper=session.getMapper(CriterionMapper.class);
  FilterColumnMapper columnMapper=session.getMapper(FilterColumnMapper.class);
  try {
    filterMapper.insert(filterDto);
    for (    CriterionDto criteriaDto : filterDto.getCriteria()) {
      criteriaDto.setFilterId(filterDto.getId());
      criteriaMapper.insert(criteriaDto);
    }
    for (    FilterColumnDto filterColumnDto : filterDto.getColumns()) {
      filterColumnDto.setFilterId(filterDto.getId());
      columnMapper.insert(filterColumnDto);
    }
    session.commit();
  }
  finally {
    MyBatis.closeQuietly(session);
  }
}
