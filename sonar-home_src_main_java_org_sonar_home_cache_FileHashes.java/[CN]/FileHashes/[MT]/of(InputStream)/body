{
  DigestInputStream digestInputStream=null;
  try {
    MessageDigest digest=MessageDigest.getInstance("MD5");
    byte[] hash=digest(input,digest);
    return toHex(hash);
  }
 catch (  Exception e) {
    throw new IllegalStateException("Fail to compute hash",e);
  }
 finally {
    IOUtils.closeQuietly(digestInputStream);
    IOUtils.closeQuietly(input);
  }
}
