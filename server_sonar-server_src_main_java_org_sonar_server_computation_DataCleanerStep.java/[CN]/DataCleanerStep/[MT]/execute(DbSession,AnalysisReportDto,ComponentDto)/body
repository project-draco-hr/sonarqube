{
  Long projectId=project.getId();
  Settings settings=projectSettingsFactory.newProjectSettings(session,projectId);
  PurgeConfiguration purgeConfiguration=newDefaultPurgeConfiguration(settings,projectId);
  List<String> fileUuidsToDisable=purgeTask.findUuidsToDisable(session,projectId);
  purgeTask.purge(session,purgeConfiguration,settings);
  if (purgeConfiguration.maxLiveDateOfClosedIssues() != null) {
    issueIndex.deleteClosedIssuesOfProjectBefore(project.uuid(),purgeConfiguration.maxLiveDateOfClosedIssues());
    sourceLineIndexer.deleteByFiles(fileUuidsToDisable);
  }
}
