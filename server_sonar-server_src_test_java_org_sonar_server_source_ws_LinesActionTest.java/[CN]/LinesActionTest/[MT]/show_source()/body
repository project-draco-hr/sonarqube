{
  String componentUuid="efgh";
  Date updatedAt=new Date();
  String scmDate="2014-01-01T12:34:56.789Z";
  SourceLineDoc line1=new SourceLineDoc(ImmutableMap.<String,Object>builder().put(SourceLineIndexDefinition.FIELD_PROJECT_UUID,"abcd").put(SourceLineIndexDefinition.FIELD_FILE_UUID,"efgh").put(SourceLineIndexDefinition.FIELD_LINE,1).put(SourceLineIndexDefinition.FIELD_SCM_REVISION,"cafebabe").put(SourceLineIndexDefinition.FIELD_SCM_DATE,scmDate).put(SourceLineIndexDefinition.FIELD_SCM_AUTHOR,"polop").put(SourceLineIndexDefinition.FIELD_SOURCE,"class Polop {").put(SourceLineIndexDefinition.FIELD_HIGHLIGHTING,"h1").put(BaseNormalizer.UPDATED_AT_FIELD,updatedAt).build());
  SourceLineDoc line2=new SourceLineDoc(ImmutableMap.<String,Object>builder().put(SourceLineIndexDefinition.FIELD_PROJECT_UUID,"abcd").put(SourceLineIndexDefinition.FIELD_FILE_UUID,"efgh").put(SourceLineIndexDefinition.FIELD_LINE,2).put(SourceLineIndexDefinition.FIELD_SCM_REVISION,"cafebabe").put(SourceLineIndexDefinition.FIELD_SCM_DATE,scmDate).put(SourceLineIndexDefinition.FIELD_SCM_AUTHOR,"polop").put(SourceLineIndexDefinition.FIELD_SOURCE,"  // Empty").put(SourceLineIndexDefinition.FIELD_HIGHLIGHTING,"h2").put(BaseNormalizer.UPDATED_AT_FIELD,updatedAt).build());
  SourceLineDoc line3=new SourceLineDoc(ImmutableMap.<String,Object>builder().put(SourceLineIndexDefinition.FIELD_PROJECT_UUID,"abcd").put(SourceLineIndexDefinition.FIELD_FILE_UUID,"efgh").put(SourceLineIndexDefinition.FIELD_LINE,3).put(SourceLineIndexDefinition.FIELD_SCM_REVISION,"cafebabe").put(SourceLineIndexDefinition.FIELD_SCM_DATE,scmDate).put(SourceLineIndexDefinition.FIELD_SCM_AUTHOR,"polop").put(SourceLineIndexDefinition.FIELD_SOURCE,"}").put(SourceLineIndexDefinition.FIELD_HIGHLIGHTING,"h3").put(BaseNormalizer.UPDATED_AT_FIELD,updatedAt).build());
  when(sourceLineIndex.getLines(eq(componentUuid),anyInt(),anyInt())).thenReturn(newArrayList(line1,line2,line3));
  WsTester.TestRequest request=tester.newGetRequest("api/sources","lines").setParam("uuid",componentUuid);
  request.execute().assertJson(getClass(),"show_source.json",false);
}
