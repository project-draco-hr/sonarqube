{
  tester=new WsTester(new SourcesWs(mock(ShowAction.class),mock(RawAction.class),mock(ScmAction.class),new LinesAction(sourceLineIndex,htmlSourceDecorator),mock(HashAction.class)));
  when(htmlSourceDecorator.getDecoratedSourceAsHtml(anyString(),anyString())).thenAnswer(new Answer<String>(){
    @Override public String answer(    InvocationOnMock invocation) throws Throwable {
      return "<span class=\"" + invocation.getArguments()[1] + "\">"+ StringEscapeUtils.escapeHtml((String)invocation.getArguments()[0])+ "</span>";
    }
  }
);
}
