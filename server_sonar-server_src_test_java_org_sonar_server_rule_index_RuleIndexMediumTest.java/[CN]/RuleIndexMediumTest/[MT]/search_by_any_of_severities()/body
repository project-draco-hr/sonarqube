{
  dao.insert(dbSession,RuleTesting.newDto(RuleKey.of("java","S001")).setSeverity(Severity.BLOCKER));
  dao.insert(dbSession,RuleTesting.newDto(RuleKey.of("java","S002")).setSeverity(Severity.INFO));
  dbSession.commit();
  RuleQuery query=new RuleQuery().setSeverities(Arrays.asList(Severity.INFO,Severity.MINOR));
  Result<Rule> results=index.search(query,new QueryContext(userSessionRule));
  assertThat(results.getHits()).hasSize(1);
  assertThat(Iterables.getFirst(results.getHits(),null).key().rule()).isEqualTo("S002");
  query=new RuleQuery().setSeverities(Arrays.asList(Severity.MINOR));
  assertThat(index.search(query,new QueryContext(userSessionRule)).getHits()).isEmpty();
  query=new RuleQuery().setSeverities(Collections.<String>emptyList());
  assertThat(index.search(query,new QueryContext(userSessionRule)).getHits()).hasSize(2);
  query=new RuleQuery().setSeverities(null);
  assertThat(index.search(query,new QueryContext(userSessionRule)).getHits()).hasSize(2);
}
