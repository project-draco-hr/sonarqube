{
  CharacteristicDto char1=DebtTesting.newCharacteristicDto("c1").setEnabled(true).setName("char1");
  db.debtCharacteristicDao().insert(char1,dbSession);
  dbSession.commit();
  CharacteristicDto char11=DebtTesting.newCharacteristicDto("c11").setEnabled(true).setName("char11").setParentId(char1.getId());
  db.debtCharacteristicDao().insert(char11,dbSession);
  dao.insert(dbSession,RuleTesting.newDto(RuleKey.of("findbugs","S001")).setSubCharacteristicId(null).setRemediationFunction(null).setDefaultSubCharacteristicId(char11.getId()).setDefaultRemediationFunction("LINEAR").setDefaultRemediationCoefficient("2h"));
  dao.insert(dbSession,RuleTesting.newDto(RuleKey.of("pmd","S002")).setSubCharacteristicId(char11.getId()).setRemediationFunction("LINEAR").setRemediationCoefficient("2h").setDefaultSubCharacteristicId(null).setDefaultRemediationFunction(null));
  dbSession.commit();
  assertThat(index.search(new RuleQuery(),new QueryOptions()).getTotal()).isEqualTo(2);
  assertThat(db.debtCharacteristicDao().selectCharacteristics()).hasSize(2);
  assertThat(index.search(new RuleQuery().setHasDebtCharacteristic(true),new QueryOptions()).getTotal()).isEqualTo(2);
}
