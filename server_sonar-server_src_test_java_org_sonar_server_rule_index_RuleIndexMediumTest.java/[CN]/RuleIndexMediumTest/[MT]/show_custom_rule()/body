{
  RuleDto templateRule=RuleTesting.newDto(RuleKey.of("java","S001")).setIsTemplate(true);
  dao.insert(dbSession,templateRule);
  dao.insert(dbSession,RuleTesting.newDto(RuleKey.of("java","S001_MY_CUSTOM")).setTemplateId(templateRule.getId()));
  dbSession.commit();
  RuleQuery query=new RuleQuery();
  Result<Rule> results=index.search(query,new QueryContext());
  assertThat(results.getHits()).hasSize(2);
  assertThat(index.getByKey(RuleKey.of("java","S001_MY_CUSTOM")).templateKey()).isEqualTo(RuleKey.of("java","S001"));
}
