{
  String dirName=settings.getString(DatabaseProperties.PROP_EMBEDDED_DATA_DIR);
  if (StringUtils.isBlank(dirName)) {
    File sonarHome=new File(settings.getString(CoreProperties.SONAR_HOME));
    if (!sonarHome.isDirectory() || !sonarHome.exists()) {
      throw new ServerStartException("Sonar home directory does not exist");
    }
    return new File(sonarHome,"data");
  }
  return new File(dirName);
}
