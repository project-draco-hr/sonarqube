{
  String dirName=settings.getString(DatabaseProperties.PROP_EMBEDDED_DATA_DIR);
  if (!StringUtils.isBlank(dirName)) {
    return new File(dirName);
  }
  File sonarHome=new File(settings.getString(CoreProperties.SONAR_HOME));
  if (sonarHome.isDirectory() && sonarHome.exists()) {
    return new File(sonarHome,"data");
  }
  throw new IllegalStateException("Sonar home directory does not exist");
}
