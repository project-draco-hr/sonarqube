{
  Snapshot snapshot=resourcePersister.getSnapshotOrFail(resource);
  if (isCached(snapshot)) {
    throw new DuplicatedSourceException(resource);
  }
  SnapshotSourceDto dto=new SnapshotSourceDto();
  dto.setSnapshotId(snapshot.getId().longValue());
  dto.setData(source);
  sourceDao.insert(dto);
  addToCache(snapshot);
}
