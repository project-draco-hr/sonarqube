{
  String[] result=new String[file.lines()];
  if (highlighting == null) {
    return result;
  }
  Iterable<SyntaxHighlightingRule> rules=highlighting.syntaxHighlightingRuleSet();
  int currentLineIdx=1;
  StringBuilder[] highlightingPerLine=new StringBuilder[file.lines()];
  for (  SyntaxHighlightingRule rule : rules) {
    while (currentLineIdx < file.lines() && rule.getStartPosition() >= file.originalLineOffsets()[currentLineIdx]) {
      currentLineIdx++;
    }
    writeDataPerLine(file.originalLineOffsets(),rule,rule.getStartPosition(),rule.getEndPosition(),highlightingPerLine,currentLineIdx,new RuleItemWriter());
  }
  for (int i=0; i < file.lines(); i++) {
    result[i]=highlightingPerLine[i] != null ? highlightingPerLine[i].toString() : null;
  }
  return result;
}
