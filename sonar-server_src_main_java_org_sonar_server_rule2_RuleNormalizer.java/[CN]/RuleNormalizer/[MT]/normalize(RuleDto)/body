{
  XContentBuilder document=jsonBuilder().startObject();
  indexField(RuleField.KEY.key(),rule.getRuleKey(),document);
  indexField(RuleField.REPOSITORY.key(),rule.getRepositoryKey(),document);
  indexField(RuleField.NAME.key(),rule.getName(),document);
  indexField(RuleField.CREATED_AT.key(),rule.getCreatedAt(),document);
  indexField(RuleField.UPDATED_AT.key(),rule.getUpdatedAt(),document);
  indexField(RuleField.DESCRIPTION.key(),rule.getDescription(),document);
  indexField(RuleField.SEVERITY.key(),rule.getSeverityString(),document);
  indexField(RuleField.STATUS.key(),rule.getStatus(),document);
  indexField(RuleField.LANGUAGE.key(),rule.getLanguage(),document);
  indexField(RuleField.INTERNAL_KEY.key(),rule.getConfigKey(),document);
  indexField(RuleField.TEMPLATE.key(),rule.getCardinality() == Cardinality.MULTIPLE,document);
  List<RuleRuleTagDto> tags=ruleDao.selectTagsByRuleId(rule.getId());
  if (!tags.isEmpty()) {
    XContentBuilder sysTags=document.startArray(RuleField.SYSTEM_TAGS.key());
    XContentBuilder adminTags=document.startArray(RuleField.TAGS.key());
    for (    RuleRuleTagDto tag : tags) {
switch (tag.getType()) {
case SYSTEM:
        sysTags.startObject(tag.getTag()).endObject();
      break;
case ADMIN:
    adminTags.startObject(tag.getTag()).endObject();
  break;
}
}
sysTags.endArray();
adminTags.endArray();
}
List<RuleParamDto> params=ruleDao.selectParametersByRuleId(rule.getId());
document.startArray(RuleField.PARAMS.key());
if (!params.isEmpty()) {
for (RuleParamDto param : params) {
document.startObject();
indexField(RuleParamField.NAME.key(),param.getName(),document);
indexField(RuleParamField.TYPE.key(),param.getType(),document);
indexField(RuleParamField.DESCRIPTION.key(),param.getDescription(),document);
indexField(RuleParamField.DEFAULT_VALUE.key(),param.getDefaultValue(),document);
document.endObject();
}
}
document.endArray();
return document.endObject();
}
