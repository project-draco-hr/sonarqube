{
  Version adjustedSonarVersion=getAdjustedSonarVersion();
  List<PluginUpdate> availables=Lists.newArrayList();
  for (  Plugin plugin : center.getPlugins()) {
    if (!installedPlugins.containsKey(plugin) && !isAlreadyDownloaded(plugin)) {
      Release release=plugin.getLastCompatibleRelease(adjustedSonarVersion);
      if (release != null) {
        availables.add(PluginUpdate.createWithStatus(release,PluginUpdate.Status.COMPATIBLE));
      }
 else {
        release=plugin.getLastCompatibleReleaseIfUpgrade(adjustedSonarVersion);
        if (release != null) {
          availables.add(PluginUpdate.createWithStatus(release,PluginUpdate.Status.REQUIRE_SONAR_UPGRADE));
        }
      }
    }
  }
  return availables;
}
