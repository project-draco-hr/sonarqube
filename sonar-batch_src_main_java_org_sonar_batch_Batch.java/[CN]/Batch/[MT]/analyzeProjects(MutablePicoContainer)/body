{
  MutablePicoContainer batchContainer=container.makeChildContainer();
  batchContainer.as(Characteristics.CACHE).addComponent(ServerMetadata.class);
  batchContainer.as(Characteristics.CACHE).addComponent(ProjectTree.class);
  batchContainer.as(Characteristics.CACHE).addComponent(DefaultResourceCreationLock.class);
  batchContainer.as(Characteristics.CACHE).addComponent(DefaultIndex.class);
  batchContainer.as(Characteristics.CACHE).addComponent(DefaultPersistenceManager.class);
  batchContainer.as(Characteristics.CACHE).addComponent(DependencyPersister.class);
  batchContainer.as(Characteristics.CACHE).addComponent(EventPersister.class);
  batchContainer.as(Characteristics.CACHE).addComponent(LinkPersister.class);
  batchContainer.as(Characteristics.CACHE).addComponent(MeasurePersister.class);
  batchContainer.as(Characteristics.CACHE).addComponent(DefaultResourcePersister.class);
  batchContainer.as(Characteristics.CACHE).addComponent(SourcePersister.class);
  batchContainer.as(Characteristics.CACHE).addComponent(ViolationPersister.class);
  batchContainer.as(Characteristics.CACHE).addComponent(JpaPluginDao.class);
  batchContainer.as(Characteristics.CACHE).addComponent(BatchPluginRepository.class);
  batchContainer.as(Characteristics.CACHE).addComponent(Plugins.class);
  batchContainer.as(Characteristics.CACHE).addComponent(ServerHttpClient.class);
  batchContainer.as(Characteristics.CACHE).addComponent(HttpDownloader.class);
  batchContainer.as(Characteristics.CACHE).addComponent(MeasuresDao.class);
  batchContainer.as(Characteristics.CACHE).addComponent(CacheRuleFinder.class);
  batchContainer.as(Characteristics.CACHE).addComponent(CacheMetricFinder.class);
  batchContainer.start();
  ProjectTree projectTree=batchContainer.getComponent(ProjectTree.class);
  DefaultIndex index=batchContainer.getComponent(DefaultIndex.class);
  analyzeProject(batchContainer,index,projectTree.getRootProject());
}
