{
  Date snapshotDate=new Date(getSnapshotDate());
  if (StringUtils.equals(mode,CoreProperties.TIMEMACHINE_MODE_VERSION)) {
    String label=String.format("Compare to version %s",modeParameter);
    if (targetDate != null) {
      label+=String.format(" (%s)",DateUtils.formatDate(snapshotDate));
    }
    return label;
  }
  if (StringUtils.equals(mode,CoreProperties.TIMEMACHINE_MODE_DAYS)) {
    return String.format("Compare over %s days (%s, analysis of %s)",modeParameter,formatDate(),DateUtils.formatDate(snapshotDate));
  }
  if (StringUtils.equals(mode,CoreProperties.TIMEMACHINE_MODE_PREVIOUS_ANALYSIS)) {
    return String.format("Compare to previous analysis (%s)",DateUtils.formatDate(snapshotDate));
  }
  if (StringUtils.equals(mode,CoreProperties.TIMEMACHINE_MODE_PREVIOUS_VERSION)) {
    return String.format("Compare to previous version (%s)",DateUtils.formatDate(snapshotDate));
  }
  if (StringUtils.equals(mode,CoreProperties.TIMEMACHINE_MODE_DATE)) {
    return String.format("Compare to date %s (analysis of %s)",formatDate(),DateUtils.formatDate(snapshotDate));
  }
  return ReflectionToStringBuilder.toString(this);
}
