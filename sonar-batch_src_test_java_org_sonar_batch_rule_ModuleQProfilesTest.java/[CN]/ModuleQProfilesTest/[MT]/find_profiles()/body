{
  setupData("shared");
  QualityProfileDao dao=new QualityProfileDao(getMyBatis());
  QProfilesReferential ref=new DefaultQProfileReferential(dao);
  settings.setProperty("sonar.profile.java","Java One");
  settings.setProperty("sonar.profile.abap","Abap One");
  settings.setProperty("sonar.profile.php","Php One");
  ModuleQProfiles moduleQProfiles=new ModuleQProfiles(settings,languages,ref);
  List<QProfile> qProfiles=Lists.newArrayList(moduleQProfiles.findAll());
  assertThat(qProfiles).hasSize(2);
  assertThat(moduleQProfiles.findByLanguage("java")).isNotNull();
  assertThat(moduleQProfiles.findByLanguage("php")).isNotNull();
  assertThat(moduleQProfiles.findByLanguage("abap")).isNull();
  QProfile javaProfile=qProfiles.get(0);
  assertThat(javaProfile.key()).isEqualTo("java-one");
  assertThat(javaProfile.name()).isEqualTo("Java One");
  assertThat(javaProfile.language()).isEqualTo("java");
  QProfile phpProfile=qProfiles.get(1);
  assertThat(phpProfile.key()).isEqualTo("php-one");
  assertThat(phpProfile.name()).isEqualTo("Php One");
  assertThat(phpProfile.language()).isEqualTo("php");
}
