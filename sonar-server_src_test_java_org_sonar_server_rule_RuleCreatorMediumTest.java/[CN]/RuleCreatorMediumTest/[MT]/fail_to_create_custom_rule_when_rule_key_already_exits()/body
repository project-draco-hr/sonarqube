{
  RuleDto templateRule=createTemplateRule();
  NewRule newRule=new NewRule().setRuleKey("CUSTOM_RULE").setName("My custom").setTemplateKey(templateRule.getKey()).setHtmlDescription("Some description").setSeverity(Severity.MAJOR).setStatus(RuleStatus.READY).setParameters(ImmutableMap.of("regex","a.*"));
  creator.create(newRule);
  try {
    newRule=new NewRule().setRuleKey("CUSTOM_RULE").setName("My another custom").setTemplateKey(templateRule.getKey()).setHtmlDescription("Some description").setSeverity(Severity.MAJOR).setStatus(RuleStatus.READY).setParameters(ImmutableMap.of("regex","a.*"));
    creator.create(newRule);
    fail();
  }
 catch (  Exception e) {
    assertThat(e).isInstanceOf(IllegalArgumentException.class).hasMessage("A rule with the key 'CUSTOM_RULE' already exits");
  }
}
