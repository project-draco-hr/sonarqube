{
  Tomcat tomcat=mock(Tomcat.class,Mockito.RETURNS_DEEP_STUBS);
  Props props=new Props(new Properties());
  Env env=mock(Env.class);
  when(env.file(Logging.ACCESS_RELATIVE_PATH)).thenReturn(temp.newFile("logback-access.xml"));
  Logging.configure(tomcat,env,props);
  verify(tomcat.getHost().getPipeline()).addValve(argThat(new ArgumentMatcher<Valve>(){
    @Override public boolean matches(    Object o){
      LogbackValve v=(LogbackValve)o;
      String confFile=v.getFilename();
      return confFile.endsWith("logback-access.xml");
    }
  }
));
}
