{
  FakeSaver saver=new FakeSaver(getMyBatis(),new FakeRuleFinder());
  DefaultIssueComment comment=DefaultIssueComment.create("emmerik","the comment");
  comment.setKey("FGHIJ");
  Date date=DateUtils.parseDate("2013-05-18");
  DefaultIssue issue=new DefaultIssue();
  issue.setKey("ABCDE");
  issue.setRuleKey(RuleKey.of("squid","AvoidCycle"));
  issue.setLine(5000);
  issue.setNew(true);
  issue.setUserLogin("emmerik");
  issue.setResolution("OPEN").setStatus("OPEN").setSeverity("BLOCKER");
  issue.setAttribute("foo","bar");
  issue.addComment(comment);
  issue.setCreationDate(date);
  issue.setUpdateDate(date);
  issue.setCloseDate(date);
  saver.save(issue);
  checkTables("should_insert_new_issues",new String[]{"id","created_at","updated_at"},"issues","issue_changes");
}
