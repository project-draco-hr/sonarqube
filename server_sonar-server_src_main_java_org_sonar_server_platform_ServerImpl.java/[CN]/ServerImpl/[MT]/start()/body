{
  try {
    String startedAtString=settings.getString(PROPERTY_SONAR_CORE_STARTED_AT);
    checkState(startedAtString != null,"property %s must be set",PROPERTY_SONAR_CORE_STARTED_AT);
    startedAt=new Date(Long.valueOf(startedAtString));
    id=new SimpleDateFormat("yyyyMMddHHmmss").format(startedAt);
    version=readVersion(versionPath);
    implementationBuild=read(buildProperties).getProperty("Implementation-Build");
    sonarHome=new File(settings.getString(ProcessProperties.PATH_HOME));
    if (!sonarHome.isDirectory()) {
      throw new IllegalStateException("SonarQube home directory is not valid");
    }
    contextPath=StringUtils.defaultIfBlank(settings.getString(PROPERTY_CONTEXT),"").replaceFirst("(\\/+)$","");
    LOG.info("SonarQube {}",Joiner.on(" / ").skipNulls().join("Server",version,implementationBuild));
  }
 catch (  IOException e) {
    throw new IllegalStateException("Can not load metadata",e);
  }
}
