{
  userSession.checkGlobalPermission(GlobalPermissions.SCAN_EXECUTION);
  String effectiveProjectKey=ComponentKeys.createKey(projectKey,projectBranch);
  ComponentDto project=componentService.getNullableByKey(effectiveProjectKey);
  if (project == null) {
    NewComponent newProject=new NewComponent(projectKey,StringUtils.defaultIfBlank(projectName,projectKey));
    newProject.setBranch(projectBranch);
    newProject.setQualifier(Qualifiers.PROJECT);
    project=componentService.create(newProject);
    permissionService.applyDefaultPermissionTemplate(project.getKey());
  }
  CeTaskSubmit.Builder submit=queue.prepareSubmit();
  reportFiles.save(submit.getUuid(),reportInput);
  submit.setType(CeTaskTypes.REPORT);
  submit.setComponentUuid(project.uuid());
  submit.setSubmitterLogin(userSession.getLogin());
  return queue.submit(submit.build());
}
