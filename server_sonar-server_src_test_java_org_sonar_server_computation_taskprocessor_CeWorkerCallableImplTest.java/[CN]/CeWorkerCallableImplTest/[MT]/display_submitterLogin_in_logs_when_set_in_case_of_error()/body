{
  CeTask ceTask=createCeTask("FooBar");
  when(queue.peek()).thenReturn(Optional.of(ceTask));
  taskProcessorRepository.setProcessorForTask(ceTask.getType(),taskProcessor);
  makeTaskProcessorFail(ceTask);
  underTest.call();
  List<String> logs=logTester.logs(LoggerLevel.INFO);
  assertThat(logs).hasSize(2);
  for (int i=0; i < 2; i++) {
    assertThat(logs.get(i)).contains(" | submitter=FooBar");
  }
  logs=logTester.logs(LoggerLevel.ERROR);
  assertThat(logs).hasSize(3);
  for (int i=0; i < 3; i++) {
    String log=logs.get(i);
    assertThat(log.contains(" | submitter=FooBar | time=") || log.equals("Failed to execute task " + ceTask.getUuid())).isTrue();
  }
}
