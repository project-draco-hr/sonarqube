{
  final Date now=new Date(system.now());
  Connection connection=null;
  PreparedStatement pstmt=null;
  try {
    connection=openConnection();
    pstmt=connection.prepareStatement("SELECT p.uuid as uuid FROM projects p WHERE p.kee=?");
    MassUpdate massUpdate=context.prepareMassUpdate();
    massUpdate.select("SELECT f.id, f.data FROM issue_filters f WHERE f.data like '%componentRoots=%'");
    massUpdate.update("UPDATE issue_filters SET data=?, updated_at=? WHERE id=?");
    final PreparedStatement finalPstmt=pstmt;
    massUpdate.execute(new MassUpdate.Handler(){
      @Override public boolean handle(      Select.Row row,      SqlStatement update) throws SQLException {
        Long id=row.getNullableLong(1);
        String data=row.getNullableString(2);
        if (data == null) {
          return false;
        }
        update.setString(1,convertData(finalPstmt,data));
        update.setDate(2,now);
        update.setLong(3,id);
        return true;
      }
    }
);
  }
  finally {
    DbUtils.closeQuietly(connection);
    DbUtils.closeQuietly(pstmt);
  }
}
