{
  DefaultIssue issue=new DefaultIssue().setKey("200").setComponentKey("struts:/src/main/java/org/apache/struts/Action.java").setRuleKey(RuleKey.of("squid","AvoidCycles")).setMessage("There are 2 cycles").setSeverity("MINOR").setStatus(Issue.STATUS_OPEN).setResolution(null).setLine(1).setEffortToFix(3.14).setReporter("julien").setAssignee("simon").setCreationDate(SIMPLE_DATE_FORMAT.parse("2013-04-24")).setUpdateDate(SIMPLE_DATE_FORMAT.parse("2013-04-25")).setNew(false);
  when(ruleFinder.findByKey(RuleKey.of("squid","AvoidCycles"))).thenReturn(new Rule().setName("Avoid Cycles"));
  when(jsonReport.getIssues()).thenReturn(Lists.<DefaultIssue>newArrayList(issue));
  DefaultUser user1=new DefaultUser().setLogin("julien").setName("Julien");
  DefaultUser user2=new DefaultUser().setLogin("simon").setName("Simon");
  when(userFinder.findByLogins(eq(Arrays.asList("julien","simon")))).thenReturn(Lists.<User>newArrayList(user1,user2));
  StringWriter writer=new StringWriter();
  jsonReport.writeJson(writer);
  JSONAssert.assertEquals(TestUtils.getResourceContent("/org/sonar/batch/scan/report/JsonReportTest/report.json"),writer.toString(),false);
}
