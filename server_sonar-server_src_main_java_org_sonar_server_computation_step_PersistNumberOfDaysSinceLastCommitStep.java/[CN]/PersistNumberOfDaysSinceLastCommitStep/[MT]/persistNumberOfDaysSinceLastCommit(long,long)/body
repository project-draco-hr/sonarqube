{
  long numberOfDaysSinceLastCommit=(system.now() - lastCommitTimestamp) / MILLISECONDS_PER_DAY;
  DbSession dbSession=dbClient.openSession(true);
  try {
    dbClient.measureDao().insert(dbSession,new MeasureDto().setValue((double)numberOfDaysSinceLastCommit).setMetricId(metricRepository.getByKey(CoreMetrics.DAYS_SINCE_LAST_COMMIT_KEY).getId()).setSnapshotId(projectSnapshotId));
    dbSession.commit();
  }
  finally {
    MyBatis.closeQuietly(dbSession);
  }
}
