{
  if (!pastViolationsByRule.containsKey(violation.getRule())) {
    return null;
  }
  Collection<RuleFailureModel> pastViolations=pastViolationsByRule.get(violation.getRule());
  RuleFailureModel found=selectPastViolationUsingLine(violation,pastViolations);
  if (found == null) {
    found=selectPastViolationUsingChecksum(violation,pastViolations);
  }
  return found;
}
