{
  Collection<RuleFailureModel> pastViolations=pastViolationsByRule.get(violation.getRule());
  if (pastViolations == null || pastViolations.isEmpty()) {
    return null;
  }
  String dbFormattedMessage=RuleFailureModel.abbreviateMessage(violation.getMessage());
  RuleFailureModel found=selectPastViolationUsingLine(violation,dbFormattedMessage,pastViolations);
  if (found == null) {
    found=selectPastViolationUsingChecksum(violation,dbFormattedMessage,pastViolations);
  }
  return found;
}
