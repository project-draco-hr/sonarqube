{
  when(issueFilterDao.selectByUser(eq("john"))).thenReturn(Collections.emptyList());
  when(issueFilterDao.selectSharedFilters()).thenReturn(newArrayList(new IssueFilterDto().setId(1L).setName("My Issue").setUserLogin("henry").setShared(true)));
  IssueFilterDto issueFilter=new IssueFilterDto().setName("My Issue").setShared(true);
  try {
    underTest.save(issueFilter,userSession);
    fail();
  }
 catch (  Exception e) {
    assertThat(e).isInstanceOf(BadRequestException.class).hasMessage("Other users already share filters with the same name");
  }
  verify(issueFilterDao,never()).insert(any(IssueFilterDto.class));
}
