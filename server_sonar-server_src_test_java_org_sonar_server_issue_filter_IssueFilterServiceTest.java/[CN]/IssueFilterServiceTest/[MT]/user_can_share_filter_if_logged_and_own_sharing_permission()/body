{
  when(permissionDao.selectGlobalPermissions("john")).thenReturn(newArrayList(GlobalPermissions.DASHBOARD_SHARING));
  UserSession userSession=new MockUserSession("john");
  assertThat(underTest.canShareFilter(userSession)).isTrue();
  assertThat(underTest.canShareFilter(new AnonymousMockUserSession())).isFalse();
  when(permissionDao.selectGlobalPermissions("john")).thenReturn(Collections.<String>emptyList());
  userSession=new MockUserSession("john");
  assertThat(underTest.canShareFilter(userSession)).isFalse();
}
