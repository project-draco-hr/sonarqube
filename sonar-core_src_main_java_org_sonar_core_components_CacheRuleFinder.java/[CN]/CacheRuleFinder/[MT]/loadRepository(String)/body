{
  Map<String,Rule> repository=rulesByKey.get(repositoryKey);
  if (repository == null) {
    repository=Maps.newHashMap();
    rulesByKey.put(repositoryKey,repository);
    for (    Rule rule : findAll(RuleQuery.create().withRepositoryKey(repositoryKey))) {
      repository.put(rule.getKey(),rule);
      rulesById.put(rule.getId(),rule);
    }
  }
  return repository;
}
