{
  ESNode node=new ESNode(fs,new Settings());
  node.start();
  node.client().admin().indices().prepareCreate("polop").addMapping("type1","{\"type1\": {\"properties\": {\"value\": {\"type\": \"string\"}}}}").execute().actionGet();
  node.client().admin().cluster().prepareHealth("polop").setWaitForYellowStatus().get(TimeValue.timeValueMillis(1000));
  try {
    node.client().prepareIndex("polop","type1","666").setSource(XContentFactory.jsonBuilder().startObject().field("unknown","plouf").endObject()).get();
  }
  finally {
    node.stop();
  }
}
