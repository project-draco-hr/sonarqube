{
  ESNode node=new ESNode(fs,new Settings());
  node.start();
  node.client().admin().indices().prepareCreate("polop").addMapping("type1","{\"type1\": {\"properties\": {\"value\": {\"type\": \"string\"}}}}").execute().actionGet();
  node.client().admin().cluster().prepareHealth("polop").setWaitForYellowStatus().get(TimeValue.timeValueMillis(1000));
  assertThat(node.client().admin().indices().prepareAnalyze("polop","This Is A Wonderful Text").setAnalyzer("sortable").get().getTokens().get(0).getTerm()).isEqualTo("this is a ");
  AnalyzeResponse response=node.client().admin().indices().prepareAnalyze("polop","he.llo w@rl#d").setAnalyzer("string_gram").get();
  assertThat(response.getTokens()).hasSize(10);
  assertThat(response.getTokens().get(0).getTerm()).isEqualTo("he");
  assertThat(response.getTokens().get(7).getTerm()).isEqualTo("w@rl");
  response=node.client().admin().indices().prepareAnalyze("polop","/temp/65236/test path/MyFile.java").setAnalyzer("path_analyzer").get();
  assertThat(response.getTokens()).hasSize(4);
  assertThat(response.getTokens().get(0).getTerm()).isEqualTo("/temp");
  assertThat(response.getTokens().get(1).getTerm()).isEqualTo("/temp/65236");
  assertThat(response.getTokens().get(2).getTerm()).isEqualTo("/temp/65236/test path");
  assertThat(response.getTokens().get(3).getTerm()).isEqualTo("/temp/65236/test path/MyFile.java");
}
