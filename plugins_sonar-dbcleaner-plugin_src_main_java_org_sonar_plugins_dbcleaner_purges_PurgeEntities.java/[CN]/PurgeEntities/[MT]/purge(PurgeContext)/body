{
  int minimumPeriodInHours=PurgeUtils.getMinimumPeriodInHours(configuration);
  final Date beforeDate=DateUtils.addHours(new Date(),-minimumPeriodInHours);
  Logs.INFO.info("Deleting files data before " + beforeDate);
  Query query=getSession().createQuery("SELECT s.id FROM " + Snapshot.class.getSimpleName() + " s WHERE s.last=:last AND scope=:scope AND s.createdAt<:date");
  query.setParameter("scope",Scopes.FILE);
  query.setParameter("date",beforeDate);
  query.setParameter("last",Boolean.FALSE);
  List<Integer> snapshotIds=query.getResultList();
  PurgeUtils.deleteSnapshotsData(getSession(),snapshotIds);
}
