{
  MeasureFilterContext context=new MeasureFilterContext();
  context.setUserId(userId);
  context.setData(String.format("{%s}",Joiner.on('|').withKeyValueSeparator("=").join(filterMap)));
  try {
    long start=System.currentTimeMillis();
    MeasureFilter filter=factory.create(filterMap);
    List<MeasureFilterRow> rows=executor.execute(filter,context);
    log(context,rows,(System.currentTimeMillis() - start),logger);
    return rows;
  }
 catch (  Exception e) {
    throw new IllegalStateException("Fail to execute filter: " + context,e);
  }
}
