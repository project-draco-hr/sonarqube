{
  List<String> input=Arrays.asList("foo","bar","3requests","baz");
  BulkIndexRequestIterator.InputConverter converter=new BulkIndexRequestIterator.InputConverter<String>(){
    @Override public List<ActionRequest> convert(    String input){
      if ("3requests".equals(input)) {
        return Collections.nCopies(3,(ActionRequest)new IndexRequest(input));
      }
      return Arrays.asList((ActionRequest)new IndexRequest(input));
    }
  }
;
  BulkIndexRequestIterator<String> it=new BulkIndexRequestIterator<String>(input,converter);
  assertThat(it.hasNext()).isTrue();
  assertIndex(it.next(),"foo");
  assertThat(it.hasNext()).isTrue();
  assertIndex(it.next(),"bar");
  assertThat(it.hasNext()).isTrue();
  assertIndex(it.next(),"3requests");
  assertThat(it.hasNext()).isTrue();
  assertIndex(it.next(),"3requests");
  assertThat(it.hasNext()).isTrue();
  assertIndex(it.next(),"3requests");
  assertThat(it.hasNext()).isTrue();
  assertIndex(it.next(),"baz");
  assertThat(it.hasNext()).isFalse();
  try {
    it.next();
    fail();
  }
 catch (  NoSuchElementException e) {
  }
}
