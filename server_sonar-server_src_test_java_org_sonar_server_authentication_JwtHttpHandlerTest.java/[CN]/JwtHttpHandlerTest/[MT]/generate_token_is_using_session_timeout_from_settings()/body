{
  int sessionTimeoutInHours=10;
  settings.setProperty("sonar.auth.sessionTimeoutInHours",sessionTimeoutInHours);
  underTest=new JwtHttpHandler(system2,dbClient,server,settings,jwtSerializer,jwtCsrfVerifier,threadLocalUserSession);
  underTest.generateToken(userDto,response);
  verify(jwtSerializer).encode(jwtArgumentCaptor.capture());
  verifyToken(jwtArgumentCaptor.getValue(),sessionTimeoutInHours * 60 * 60,NOW);
}
