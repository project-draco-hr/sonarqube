{
  final int pageSize=10;
  final int pageIndex=2;
  Rule rule=ruleBuilder.build();
  when(rules.find(any(RuleQuery.class))).thenReturn(new PagedResult<Rule>(ImmutableList.of(rule),PagingResult.create(pageSize,pageIndex,1)));
  Language lang=mock(Language.class);
  when(lang.getName()).thenReturn("Java");
  when(languages.get("java")).thenReturn(lang);
  MockUserSession.set();
  WsTester.TestRequest request=tester.newRequest("list").setParam("ps","10").setParam("p","2");
  request.execute().assertJson("{'more':false,'total':1,'results':[" + "{'key':'squid:AvoidCycle','name':'Avoid cycle','language':'Java'}" + "]}");
}
