{
  ComponentDto project=ComponentTesting.newProjectDto();
  userSessionRule.logon("john").setGlobalPermissions(GlobalPermissions.PREVIEW_EXECUTION).addProjectUuidPermissions(UserRole.USER,project.uuid());
  tester.get(DbClient.class).componentDao().insert(dbSession,project);
  addDefaultProfile();
  tester.get(DbClient.class).propertiesDao().setProperty(new PropertyDto().setKey("sonar.jira.project.key").setValue("SONAR").setResourceId(project.getId()),dbSession);
  tester.get(DbClient.class).propertiesDao().setProperty(new PropertyDto().setKey("sonar.jira.login.secured").setValue("john").setResourceId(project.getId()),dbSession);
  dbSession.commit();
  ProjectRepositories ref=loader.load(ProjectRepositoryQuery.create().setModuleKey(project.key()).setPreview(true));
  Map<String,String> projectSettings=ref.settings(project.key());
  assertThat(projectSettings).isEqualTo(ImmutableMap.of("sonar.jira.project.key","SONAR"));
}
