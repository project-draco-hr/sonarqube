{
  double total=0.0;
  int totalFiles=0;
  List<DecoratorContext> children=context.getChildren();
  boolean hasLcom4=false;
  for (  DecoratorContext child : children) {
    int files=MeasureUtils.getValue(child.getMeasure(CoreMetrics.FILES),0.0).intValue();
    totalFiles+=files;
    Measure childSuspectDensity=child.getMeasure(CoreMetrics.SUSPECT_LCOM4_DENSITY);
    if (childSuspectDensity != null && childSuspectDensity.getValue() != null) {
      hasLcom4=true;
      total+=childSuspectDensity.getValue() * files;
    }
  }
  if (hasLcom4 && totalFiles > 0) {
    context.saveMeasure(CoreMetrics.SUSPECT_LCOM4_DENSITY,total / totalFiles);
  }
}
