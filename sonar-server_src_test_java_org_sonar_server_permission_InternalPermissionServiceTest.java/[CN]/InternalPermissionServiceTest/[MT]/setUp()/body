{
  MockUserSession.set().setLogin("admin").setPermissions(Permissions.SYSTEM_ADMIN);
  UserDto targetedUser=new UserDto().setId(2L).setLogin("user").setActive(true);
  GroupDto targetedGroup=new GroupDto().setId(2L).setName("group");
  roleDao=mock(RoleDao.class);
  when(roleDao.selectUserPermissions("user")).thenReturn(Lists.newArrayList(Permissions.QUALITY_PROFILE_ADMIN));
  when(roleDao.selectGroupPermissions("group")).thenReturn(Lists.newArrayList(Permissions.QUALITY_PROFILE_ADMIN));
  userDao=mock(UserDao.class);
  when(userDao.selectActiveUserByLogin("user")).thenReturn(targetedUser);
  when(userDao.selectGroupByName("group")).thenReturn(targetedGroup);
  service=new InternalPermissionService(roleDao,userDao);
}
