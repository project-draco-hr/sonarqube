{
  final String componentKey="component";
  final long componentId=1234l;
  final String qualifier=Qualifiers.PROJECT;
  ComponentDto mockComponent=mock(ComponentDto.class);
  when(mockComponent.getId()).thenReturn(componentId);
  when(mockComponent.qualifier()).thenReturn(qualifier);
  MockUserSession.set().setLogin("admin").addProjectPermissions(UserRole.ADMIN,componentKey);
  when(resourceDao.findByKey(componentKey)).thenReturn(mockComponent);
  service.applyDefaultPermissionTemplate(componentKey);
  verify(resourceDao).findByKey(componentKey);
  verify(permissionFacade).grantDefaultRoles(componentId,componentKey,qualifier);
}
