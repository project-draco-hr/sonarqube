{
  ComponentDto c1=mock(ComponentDto.class);
  when(c1.getId()).thenReturn(1L);
  when(resourceDao.findByKey("org.sample.Sample1")).thenReturn(c1);
  ComponentDto c2=mock(ComponentDto.class);
  when(c2.getId()).thenReturn(2L);
  when(resourceDao.findByKey("org.sample.Sample2")).thenReturn(c2);
  ComponentDto c3=mock(ComponentDto.class);
  when(c3.getId()).thenReturn(3L);
  when(resourceDao.findByKey("org.sample.Sample3")).thenReturn(c3);
  params=Maps.newHashMap();
  params.put("template_key","my_template_key");
  params.put("components","org.sample.Sample1,org.sample.Sample2,org.sample.Sample3");
  service.applyPermissionTemplate(params);
  verify(permissionFacade).applyPermissionTemplate("my_template_key",1L);
  verify(permissionFacade).applyPermissionTemplate("my_template_key",2L);
  verify(permissionFacade).applyPermissionTemplate("my_template_key",3L);
}
