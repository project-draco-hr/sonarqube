{
  dataDir=temp.newFolder();
  settings.setProperty(ProcessProperties.PATH_DATA,dataDir.getAbsolutePath());
  when(system.now()).thenReturn(NOW);
  dbClient=new DbClient(db.database(),db.myBatis(),new ComponentDao(),new AnalysisReportDao(system));
  sut=new ReportQueue(dbClient,settings);
  session=dbClient.openSession(false);
  dbClient.componentDao().insert(session,ComponentTesting.newProjectDto().setKey("P1"));
  dbClient.componentDao().insert(session,ComponentTesting.newProjectDto().setKey("P2"));
  dbClient.componentDao().insert(session,ComponentTesting.newProjectDto().setKey("P3"));
  session.commit();
}
