{
  dataDir=temp.newFolder();
  settings.setProperty(ProcessProperties.PATH_DATA,dataDir.getAbsolutePath());
  when(system.now()).thenReturn(NOW);
  DbClient dbClient=new DbClient(db.database(),db.myBatis(),new ComponentDao(system),new AnalysisReportDao(system));
  sut=new ReportQueue(dbClient,settings);
  try (DbSession session=dbClient.openSession(false)){
    dbClient.componentDao().insert(session,ComponentTesting.newProjectDto().setKey("P1"));
    dbClient.componentDao().insert(session,ComponentTesting.newProjectDto().setKey("P2"));
    dbClient.componentDao().insert(session,ComponentTesting.newProjectDto().setKey("P3"));
    session.commit();
  }
 }
