{
  InputStream is=getResourceAsStream("org/sonar/batch/bootstrap/JdbcLeakPrevention.class");
  byte[] classBytes=new byte[2048];
  int offset=0;
  try {
    int read=is.read(classBytes,offset,classBytes.length - offset);
    while (read > -1) {
      offset+=read;
      if (offset == classBytes.length) {
        byte[] tmp=new byte[classBytes.length * 2];
        System.arraycopy(classBytes,0,tmp,0,classBytes.length);
        classBytes=tmp;
      }
      read=is.read(classBytes,offset,classBytes.length - offset);
    }
    Class<?> lpClass=defineClass("org.sonar.batch.bootstrap.JdbcLeakPrevention",classBytes,0,offset,this.getClass().getProtectionDomain());
    Object obj=lpClass.newInstance();
    List<String> driverNames=(List<String>)obj.getClass().getMethod("clearJdbcDriverRegistrations").invoke(obj);
    for (    String name : driverNames) {
      LOG.debug("To prevent a memory leak, the JDBC Driver [{}] has been forcibly deregistered",name);
    }
  }
 catch (  Exception e) {
    LOG.warn("JDBC driver deregistration failed",e);
  }
 finally {
    if (is != null) {
      try {
        is.close();
      }
 catch (      IOException ioe) {
        LOG.warn(ioe.getMessage(),ioe);
      }
    }
  }
}
