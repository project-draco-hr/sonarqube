{
  if (!userSession.isLoggedIn()) {
    throw new IllegalStateException("User is not logged in");
  }
  if (!authorizationDao.isAuthorizedComponentId(findRootProject(issue.componentKey()).getId(),userSession.userId(),requiredRole)) {
    throw new IllegalStateException("User does not have the required role");
  }
}
