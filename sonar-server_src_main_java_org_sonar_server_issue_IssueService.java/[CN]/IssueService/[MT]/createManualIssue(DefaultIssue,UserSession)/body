{
  checkAuthorization(userSession,issue,UserRole.USER);
  if (!"manual".equals(issue.ruleKey().repository())) {
    throw new IllegalArgumentException("Issues can be created only on rules marked as 'manual': " + issue.ruleKey());
  }
  Rule rule=ruleFinder.findByKey(issue.ruleKey());
  if (rule == null) {
    throw new IllegalArgumentException("Unknown rule: " + issue.ruleKey());
  }
  Component component=resourceDao.findByKey(issue.componentKey());
  if (component == null) {
    throw new IllegalArgumentException("Unknown component: " + issue.componentKey());
  }
  Date now=new Date();
  issue.setCreationDate(now);
  issue.setUpdateDate(now);
  issueStorage.save(issue);
  return issue;
}
