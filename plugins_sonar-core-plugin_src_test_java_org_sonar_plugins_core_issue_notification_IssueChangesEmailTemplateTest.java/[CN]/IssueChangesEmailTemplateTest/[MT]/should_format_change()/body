{
  Notification notification=new Notification("issue-changes").setFieldValue("projectName","Struts").setFieldValue("projectKey","org.apache:struts").setFieldValue("key","ABCDE").setFieldValue("ruleName","Avoid Cycles").setFieldValue("message","Has 3 cycles").setFieldValue("old.assignee","simon").setFieldValue("new.assignee","louis").setFieldValue("new.resolution","FALSE-POSITIVE").setFieldValue("new.status","RESOLVED");
  EmailMessage message=template.format(notification);
  assertThat(message.getMessageId()).isEqualTo("issue-changes/ABCDE");
  assertThat(message.getSubject()).isEqualTo("Issue #ABCDE");
  assertThat(message.getMessage()).contains("Rule: Avoid Cycles");
  assertThat(message.getMessage()).contains("Message: Has 3 cycles");
  assertThat(message.getMessage()).contains("Assignee: louis (was simon)");
  assertThat(message.getMessage()).contains("Resolution: FALSE-POSITIVE");
  assertThat(message.getMessage()).contains("See it in Sonar: http://nemo.sonarsource.org/issue/show/ABCDE");
  assertThat(message.getFrom()).isNull();
}
