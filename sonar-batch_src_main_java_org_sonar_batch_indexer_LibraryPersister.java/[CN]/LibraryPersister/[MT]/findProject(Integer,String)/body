{
  Query query=getSession().createQuery("from " + Snapshot.class.getSimpleName() + " s WHERE s.resourceId=:resourceId AND s.version=:version AND s.scope=:scope AND s.qualifier<>:qualifier AND s.last=:last");
  query.setParameter("resourceId",resourceId);
  query.setParameter("version",version);
  query.setParameter("scope",Resource.SCOPE_SET);
  query.setParameter("qualifier",Resource.QUALIFIER_LIB);
  query.setParameter("last",Boolean.TRUE);
  List<Snapshot> snapshots=query.getResultList();
  if (snapshots.isEmpty()) {
    return null;
  }
  return snapshots.get(0);
}
