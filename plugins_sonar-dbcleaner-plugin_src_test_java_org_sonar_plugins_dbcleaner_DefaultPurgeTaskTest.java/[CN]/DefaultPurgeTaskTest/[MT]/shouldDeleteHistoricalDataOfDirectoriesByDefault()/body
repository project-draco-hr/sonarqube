{
  PurgeDao purgeDao=mock(PurgeDao.class);
  Settings settings=new Settings(new PropertyDefinitions(DbCleanerPlugin.class));
  DefaultPurgeTask task=new DefaultPurgeTask(purgeDao,settings,mock(DefaultPeriodCleaner.class),mock(PurgeProfiler.class));
  task.purge(1L);
  verify(purgeDao).purge(argThat(new ArgumentMatcher<PurgeConfiguration>(){
    @Override public boolean matches(    Object o){
      PurgeConfiguration conf=(PurgeConfiguration)o;
      return conf.rootProjectId() == 1L && conf.scopesWithoutHistoricalData().length == 2 && conf.scopesWithoutHistoricalData()[0].equals(Scopes.DIRECTORY) && conf.scopesWithoutHistoricalData()[1].equals(Scopes.FILE);
    }
  }
));
}
