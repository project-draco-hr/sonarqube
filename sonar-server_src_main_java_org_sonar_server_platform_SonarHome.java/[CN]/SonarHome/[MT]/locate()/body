{
  String value=System.getProperty(SONAR_HOME);
  if (StringUtils.isBlank(value)) {
    value=System.getenv(SONAR_HOME);
  }
  if (StringUtils.isBlank(value)) {
    throw new IllegalStateException("The system property or env variable " + SONAR_HOME + " is not set");
  }
  File dir=new File(value);
  if (!dir.isDirectory() || !dir.exists()) {
    throw new IllegalStateException(SONAR_HOME + " is not valid: " + value+ ". Please fix the env variable/system "+ "property "+ SONAR_HOME);
  }
  return dir;
}
