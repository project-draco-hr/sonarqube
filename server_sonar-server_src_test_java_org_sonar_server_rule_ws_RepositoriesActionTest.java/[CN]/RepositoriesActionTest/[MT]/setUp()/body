{
  tester=new WsTester(new RulesWs(new RepositoriesAction(repositories)));
  RuleRepositories.Repository repo1=mock(RuleRepositories.Repository.class);
  when(repo1.key()).thenReturn("xoo");
  when(repo1.name()).thenReturn("SonarQube");
  when(repo1.language()).thenReturn("xoo");
  RuleRepositories.Repository repo2=mock(RuleRepositories.Repository.class);
  when(repo2.key()).thenReturn("squid");
  when(repo2.name()).thenReturn("SonarQube");
  when(repo2.language()).thenReturn("ws");
  RuleRepositories.Repository repo3=mock(RuleRepositories.Repository.class);
  when(repo3.key()).thenReturn("common-ws");
  when(repo3.name()).thenReturn("SonarQube Common");
  when(repo3.language()).thenReturn("ws");
  when(repositories.repositories()).thenReturn(ImmutableList.of(repo1,repo2,repo3));
  when(repositories.repositoriesForLang("xoo")).thenReturn(ImmutableList.of(repo1));
  when(repositories.repositoriesForLang("ws")).thenReturn(ImmutableList.of(repo2,repo3));
}
