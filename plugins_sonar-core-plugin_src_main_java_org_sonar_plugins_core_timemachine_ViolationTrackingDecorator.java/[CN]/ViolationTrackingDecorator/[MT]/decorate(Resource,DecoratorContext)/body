{
  LOG.debug("ViolationTracking : " + resource);
  referenceViolationsMap.clear();
  ViolationQuery violationQuery=ViolationQuery.create().forResource(resource).setSwitchMode(ViolationQuery.SwitchMode.BOTH);
  if (context.getViolations(violationQuery).isEmpty()) {
    return;
  }
  String source=index.getSource(resource);
  List<Violation> newViolations=prepareNewViolations(context,source);
  List<RuleFailureModel> referenceViolations=lastSnapshots.getViolations(resource);
  mapViolations(newViolations,referenceViolations,source,resource);
}
