{
  referenceViolationsMap.clear();
  ViolationQuery violationQuery=ViolationQuery.create().forResource(resource).setSwitchMode(ViolationQuery.SwitchMode.BOTH);
  if (!context.getViolations(violationQuery).isEmpty()) {
    List<Violation> newViolations=prepareNewViolations(context);
    List<RuleFailureModel> referenceViolations=referenceAnalysis.getViolations(resource);
    mapViolations(newViolations,referenceViolations);
  }
}
