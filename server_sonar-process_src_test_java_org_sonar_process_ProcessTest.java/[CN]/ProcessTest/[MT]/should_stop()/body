{
  Properties properties=new Properties();
  properties.setProperty(Process.NAME_PROPERTY,"TEST");
  Props props=Props.create(properties);
  process=new TestProcess(props);
  MBeanServer mbeanServer=ManagementFactory.getPlatformMBeanServer();
  final ProcessMXBean processMXBean=JMX.newMBeanProxy(mbeanServer,process.getObjectName(),ProcessMXBean.class);
  Thread procThread=new Thread(new Runnable(){
    @Override public void run(){
      process.start();
    }
  }
);
  assertThat(processMXBean.isReady()).isFalse();
  procThread.start();
  Thread.sleep(200);
  assertThat(procThread.isAlive()).isTrue();
  assertThat(processMXBean.isReady()).isTrue();
  processMXBean.stop();
  Thread.sleep(200);
  assertThat(procThread.isAlive()).isFalse();
}
