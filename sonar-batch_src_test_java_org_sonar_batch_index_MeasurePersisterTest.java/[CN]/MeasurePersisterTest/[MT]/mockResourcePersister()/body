{
  setupData("shared");
  resourcePersister=mock(ResourcePersister.class);
  projectSnapshot=getSession().getSingleResult(Snapshot.class,"id",3001);
  packageSnapshot=getSession().getSingleResult(Snapshot.class,"id",3002);
  ncloc=getSession().getSingleResult(Metric.class,"key","ncloc");
  coverage=getSession().getSingleResult(Metric.class,"key","coverage");
  when(resourcePersister.saveResource((Project)anyObject(),eq(project))).thenReturn(projectSnapshot);
  when(resourcePersister.saveResource((Project)anyObject(),eq(aPackage))).thenReturn(packageSnapshot);
  measurePersister=new MeasurePersister(getSession(),resourcePersister);
}
