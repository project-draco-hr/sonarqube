{
  if (resource.getId() != null) {
    Collection<ReviewDto> openReviews=reviewDao.selectOpenByResourceId(resource.getId(),ReviewPredicates.status(ReviewDto.STATUS_OPEN),ReviewPredicates.manualViolation());
    for (    ReviewDto openReview : openReviews) {
      if (openReview.getRuleId() == null) {
        LoggerFactory.getLogger(getClass()).warn("No rule is defined on the review with id: " + openReview.getId());
      }
      if (openReview.getViolationPermanentId() == null) {
        LoggerFactory.getLogger(getClass()).warn("Permanent id of manual violation is missing on the review with id: " + openReview.getId());
      }
      Violation violation=Violation.create(ruleFinder.findById(openReview.getRuleId()),resource);
      violation.setManual(true);
      violation.setLineId(openReview.getLine());
      violation.setPermanentId(openReview.getViolationPermanentId());
      violation.setSwitchedOff(false);
      violation.setCreatedAt(openReview.getCreatedAt());
      violation.setMessage(openReview.getTitle());
      violation.setSeverity(RulePriority.valueOf(openReview.getSeverity()));
      context.saveViolation(violation);
    }
  }
}
