{
  if (resource.getId() != null) {
    ReviewQuery query=ReviewQuery.create().setManualViolation(true).setResourceId(resource.getId()).setStatus(Review.STATUS_OPEN);
    List<Review> reviews=reviewDao.selectByQuery(query);
    for (    Review review : reviews) {
      if (review.getRuleId() == null) {
        LoggerFactory.getLogger(getClass()).warn("No rule is defined on the review with id: " + review.getId());
      }
      if (review.getViolationPermanentId() == null) {
        LoggerFactory.getLogger(getClass()).warn("Permanent id of manual violation is missing on the review with id: " + review.getId());
      }
      Violation violation=Violation.create(ruleFinder.findById(review.getRuleId()),resource);
      violation.setManual(true);
      violation.setLineId(review.getLine());
      violation.setPermanentId(review.getViolationPermanentId());
      violation.setSwitchedOff(false);
      violation.setCreatedAt(review.getCreatedAt());
      violation.setMessage(review.getTitle());
      violation.setSeverity(RulePriority.valueOf(review.getSeverity()));
      context.saveViolation(violation);
    }
  }
}
