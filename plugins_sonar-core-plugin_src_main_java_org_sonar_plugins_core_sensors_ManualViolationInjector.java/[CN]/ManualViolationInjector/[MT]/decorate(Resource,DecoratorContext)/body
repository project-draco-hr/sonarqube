{
  if (resource.getId() != null) {
    ReviewQuery query=ReviewQuery.create().setManualViolation(true).setResourceId(resource.getId()).setStatus(ReviewDto.STATUS_OPENED);
    List<ReviewDto> reviewDtos=reviewDao.selectByQuery(query);
    for (    ReviewDto reviewDto : reviewDtos) {
      if (reviewDto.getRuleId() == null) {
        LoggerFactory.getLogger(getClass()).warn("No rule is defined on the review with id: " + reviewDto.getId());
      }
      if (reviewDto.getViolationPermanentId() == null) {
        LoggerFactory.getLogger(getClass()).warn("Permanent id of manual violation is missing on the review with id: " + reviewDto.getId());
      }
      Violation violation=Violation.create(ruleFinder.findById(reviewDto.getRuleId()),resource);
      violation.setManual(true);
      violation.setLineId(reviewDto.getLine());
      violation.setPermanentId(reviewDto.getViolationPermanentId());
      violation.setSwitchedOff(false);
      violation.setCreatedAt(reviewDto.getCreatedAt());
      violation.setMessage(reviewDto.getTitle());
      violation.setSeverity(RulePriority.valueOf(reviewDto.getSeverity()));
      context.saveViolation(violation);
    }
  }
}
