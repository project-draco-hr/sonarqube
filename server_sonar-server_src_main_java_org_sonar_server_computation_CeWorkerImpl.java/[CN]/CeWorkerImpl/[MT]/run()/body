{
  CeTask task;
  try {
    Optional<CeTask> taskOpt=queue.peek();
    if (!taskOpt.isPresent()) {
      return;
    }
    task=taskOpt.get();
  }
 catch (  Exception e) {
    LOG.error("Failed to pop the queue of analysis reports",e);
    return;
  }
  ceLogging.initForTask(task);
  Profiler profiler=Profiler.create(LOG).startInfo(format("Analysis of project %s (report %s)",task.getComponentKey(),task.getUuid()));
  try {
    reportTaskProcessor.process(task);
    queue.remove(task,CeActivityDto.Status.SUCCESS);
  }
 catch (  Throwable e) {
    LOG.error(format("Failed to process task %s",task.getUuid()),e);
    queue.remove(task,CeActivityDto.Status.FAILED);
  }
 finally {
    profiler.stopInfo();
    ceLogging.clearForTask();
  }
}
