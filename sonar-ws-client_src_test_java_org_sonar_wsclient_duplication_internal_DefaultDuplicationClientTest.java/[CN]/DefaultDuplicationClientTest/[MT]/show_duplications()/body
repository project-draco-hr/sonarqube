{
  HttpRequestFactory requestFactory=new HttpRequestFactory(httpServer.url());
  httpServer.stubResponseBody(Resources.toString(Resources.getResource(this.getClass(),"DefaultDuplicationClientTest/show_duplications.json"),Charsets.UTF_8));
  DuplicationClient client=new DefaultDuplicationClient(requestFactory);
  Duplications result=client.show("MyFile");
  assertThat(httpServer.requestedPath()).isEqualTo("/api/duplications/show?key=MyFile");
  List<Duplication> duplications=result.duplications();
  assertThat(duplications).hasSize(1);
  Duplication duplication=duplications.get(0);
  assertThat(duplication.blocks()).hasSize(2);
  Block block=duplication.blocks().get(0);
  assertThat(block.fileRef()).isEqualTo("1");
  assertThat(block.from()).isEqualTo(94);
  assertThat(block.size()).isEqualTo(101);
  List<File> files=result.files();
  assertThat(files).hasSize(2);
  File file=result.fileByRef("1");
  assertThat(file.key()).isEqualTo("org.codehaus.sonar:sonar-plugin-api:src/main/java/org/sonar/api/utils/command/CommandExecutor.java");
  assertThat(file.name()).isEqualTo("CommandExecutor");
  assertThat(file.projectName()).isEqualTo("SonarQube");
}
