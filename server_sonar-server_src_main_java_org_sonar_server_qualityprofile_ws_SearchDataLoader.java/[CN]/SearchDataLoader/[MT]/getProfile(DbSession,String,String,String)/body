{
  QualityProfileDto profileDto=profileName != null ? profileFactory.getByNameAndLanguage(dbSession,profileName,languageKey) : null;
  if (profileDto == null && projectKey != null) {
    profileDto=profileFactory.getByProjectAndLanguage(dbSession,projectKey,languageKey);
  }
  profileDto=profileDto != null ? profileDto : profileFactory.getDefault(dbSession,languageKey);
  checkState(profileDto != null,format("No quality profile can been found on language '%s' for project '%s'",languageKey,projectKey));
  return profileDtoToQProfile(profileDto);
}
