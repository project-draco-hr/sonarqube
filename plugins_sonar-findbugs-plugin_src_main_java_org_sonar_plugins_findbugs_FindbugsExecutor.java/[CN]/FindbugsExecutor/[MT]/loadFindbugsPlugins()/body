{
  ClassLoader contextClassLoader=Thread.currentThread().getContextClassLoader();
  List<String> pluginJarPathList=Lists.newArrayList();
  try {
    Enumeration<URL> urls=contextClassLoader.getResources("findbugs.xml");
    while (urls.hasMoreElements()) {
      URL url=urls.nextElement();
      pluginJarPathList.add(StringUtils.removeStart(StringUtils.substringBefore(url.toString(),"!"),"jar:file:"));
    }
  }
 catch (  IOException e) {
    throw new SonarException(e);
  }
  List<Plugin> customPluginList=Lists.newArrayList();
  for (  String path : pluginJarPathList) {
    try {
      Plugin plugin=Plugin.addCustomPlugin(new File(path).toURI(),contextClassLoader);
      if (plugin != null) {
        customPluginList.add(plugin);
        LOG.info("Found findbugs plugin: " + path);
      }
    }
 catch (    PluginException e) {
      LOG.warn("Failed to load plugin for custom detector: " + path);
    }
catch (    DuplicatePluginIdException e) {
      if (!FINDBUGS_CORE_PLUGIN_ID.equals(e.getPluginId())) {
        LOG.debug("Plugin already loaded: exception ignored: " + e.getMessage());
      }
    }
  }
  return customPluginList;
}
