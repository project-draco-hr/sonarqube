{
  Reader reader=new InputStreamReader(classloader.getResourceAsStream(xmlClassPath),Charset.forName(CharEncoding.UTF_8));
  try {
    ValidationMessages validation=ValidationMessages.create();
    ProfilePrototype profile=XMLProfileImporter.create().importProfile(reader,validation);
    profile.setName(name);
    profile.setLanguage(language);
    if (validation.hasErrors()) {
      throw new SonarException("Fail to parse the file: " + xmlClassPath);
    }
    return profile;
  }
  finally {
    IOUtils.closeQuietly(reader);
  }
}
