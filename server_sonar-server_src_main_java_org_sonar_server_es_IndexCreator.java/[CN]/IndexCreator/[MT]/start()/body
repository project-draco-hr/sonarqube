{
  for (  IndexRegistry.Index index : registry.getIndices().values()) {
    boolean exists=client.prepareExists(index.getName()).get().isExists();
    if (exists) {
      if (needsToDeleteIndex(index)) {
        LOGGER.info(String.format("Delete index %s (settings changed)",index.getName()));
        deleteIndex(index.getName());
        exists=false;
      }
    }
    if (!exists) {
      createIndex(index);
    }
  }
}
