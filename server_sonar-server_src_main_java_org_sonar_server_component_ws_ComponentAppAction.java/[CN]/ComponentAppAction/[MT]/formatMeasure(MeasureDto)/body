{
  if (measure != null) {
    Metric metric=CoreMetrics.getMetric(measure.getKey().metricKey());
    Metric.ValueType metricType=metric.getType();
    Double value=measure.getValue();
    String data=measure.getData();
    if (BooleanUtils.isTrue(metric.isOptimizedBestValue()) && value == null) {
      value=metric.getBestValue();
    }
    if (metricType.equals(Metric.ValueType.FLOAT) && value != null) {
      return i18n.formatDouble(UserSession.get().locale(),value);
    }
    if (metricType.equals(Metric.ValueType.INT) && value != null) {
      return i18n.formatInteger(UserSession.get().locale(),value.intValue());
    }
    if (metricType.equals(Metric.ValueType.PERCENT) && value != null) {
      return i18n.formatDouble(UserSession.get().locale(),value) + "%";
    }
    if (metricType.equals(Metric.ValueType.WORK_DUR) && value != null) {
      return durations.format(UserSession.get().locale(),durations.create(value.longValue()),Durations.DurationFormat.SHORT);
    }
    if ((metricType.equals(Metric.ValueType.STRING) || metricType.equals(Metric.ValueType.RATING)) && data != null) {
      return data;
    }
  }
  return null;
}
