{
  UserSession.get().checkProjectPermission(UserRole.ADMIN,projectKey);
  DbSession session=dbClient.openSession(false);
  try {
    AuthorizedComponentDto project=getByKey(projectKey);
    resourceKeyUpdaterDao.bulkUpdateKey(project.getId(),stringToReplace,replacementString);
    session.commit();
    AuthorizedComponentDto newProject=dbClient.componentDao().getNullableAuthorizedComponentById(project.getId(),session);
    updateIssuesIndex(session,projectKey,newProject.key());
    previewCache.reportResourceModification(newProject.key());
    session.commit();
  }
  finally {
    session.close();
  }
}
