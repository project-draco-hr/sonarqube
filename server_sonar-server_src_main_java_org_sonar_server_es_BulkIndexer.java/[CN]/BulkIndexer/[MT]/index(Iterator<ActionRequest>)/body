{
  BulkRequest bulkRequest=client.prepareBulk().request();
  while (requests.hasNext()) {
    ActionRequest request=requests.next();
    bulkRequest.add(request);
    if (bulkRequest.estimatedSizeInBytes() >= FLUSH_BYTE_SIZE) {
      executeBulk(bulkRequest);
      bulkRequest=client.prepareBulk().request();
    }
  }
  if (bulkRequest.numberOfActions() > 0) {
    executeBulk(bulkRequest);
  }
}
