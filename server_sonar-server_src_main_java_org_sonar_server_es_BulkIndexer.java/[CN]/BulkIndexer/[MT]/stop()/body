{
  try {
    if (bulkRequest.numberOfActions() > 0) {
      executeBulk(bulkRequest);
    }
  }
  finally {
    progress.stop();
  }
  client.prepareRefresh(indexName).get();
  if (large) {
    client.prepareOptimize(indexName).get();
    updateSettings(largeInitialSettings);
  }
  bulkRequest=null;
}
