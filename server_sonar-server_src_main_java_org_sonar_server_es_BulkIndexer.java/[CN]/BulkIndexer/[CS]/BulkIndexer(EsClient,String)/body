{
  this.client=client;
  this.indexName=indexName;
  this.progress=new ProgressLogger(format("Progress[BulkIndexer[%s]]",indexName),counter,LOGGER).setPluralLabel("requests");
  this.concurrentRequests=Math.max(1,Runtime.getRuntime().availableProcessors() / 5);
  this.semaphore=new Semaphore(concurrentRequests);
}
