{
  underTest.setSessionImpl(123,"karadoc","Karadoc",newArrayList("sonar-users"),"fr");
  UserSession session=threadLocalUserSession.get();
  assertThat(session).isNotNull();
  assertThat(session.login()).isEqualTo("karadoc");
  assertThat(session.name()).isEqualTo("Karadoc");
  assertThat(session.userId()).isEqualTo(123);
  assertThat(session.userGroups()).containsOnly("sonar-users","Anyone");
  assertThat(session.isLoggedIn()).isTrue();
  assertThat(session.locale()).isEqualTo(Locale.FRENCH);
}
