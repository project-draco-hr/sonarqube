{
  underTest.setSessionImpl(123,"karadoc","Karadoc",newArrayList("sonar-users"),"fr");
  UserSession session=threadLocalUserSession.get();
  assertThat(session).isNotNull();
  assertThat(session.getLogin()).isEqualTo("karadoc");
  assertThat(session.getName()).isEqualTo("Karadoc");
  assertThat(session.getUserId()).isEqualTo(123);
  assertThat(session.getUserGroups()).containsOnly("sonar-users","Anyone");
  assertThat(session.isLoggedIn()).isTrue();
  assertThat(session.locale()).isEqualTo(Locale.FRENCH);
}
