{
  StringBuilder hql=newResourceQuery().append(" and qualifier = '").append(Qualifiers.DIRECTORY).append("'");
  List<ResourceModel> resources=session.createQuery(hql.toString()).setParameter("rootId",moduleId).getResultList();
  for (  ResourceModel resourceModel : resources) {
    String oldEffectiveKey=resourceModel.getKey();
    if (deprecatedDirectoryKeyMapper.containsKey(oldEffectiveKey)) {
      String newEffectiveKey=deprecatedDirectoryKeyMapper.get(oldEffectiveKey);
      resourceModel.setKey(newEffectiveKey);
      resourceModel.setDeprecatedKey(oldEffectiveKey);
      logger.info(COMPONENT_CHANGED_TO,oldEffectiveKey,newEffectiveKey);
    }
 else {
      logger.warn(UNABLE_TO_UPDATE_COMPONENT_NO_MATCH_WAS_FOUND,oldEffectiveKey);
    }
  }
}
