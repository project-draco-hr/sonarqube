{
  Collection<String> qProfileKeys=getKeys(qProfiles);
  Map<RuleKey,LoadedActiveRule> loadedRulesByKey=new HashMap<>();
  try {
    for (    String qProfileKey : qProfileKeys) {
      Collection<LoadedActiveRule> qProfileRules;
      qProfileRules=load(loader,qProfileKey,fromCache);
      for (      LoadedActiveRule r : qProfileRules) {
        if (!loadedRulesByKey.containsKey(r.getRuleKey())) {
          loadedRulesByKey.put(r.getRuleKey(),r);
        }
      }
    }
  }
 catch (  IOException e) {
    throw new IllegalStateException("Error loading active rules",e);
  }
  return transform(loadedRulesByKey.values());
}
