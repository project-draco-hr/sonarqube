{
  Measure previousMeasure=new Measure(CoreMetrics.QUALITY_PROFILES,"[" + JAVA_V1_JSON + "]");
  Measure newMeasure=new Measure(CoreMetrics.QUALITY_PROFILES,"[" + JAVA_V2_JSON + "]");
  when(timeMachine.getMeasures(any(TimeMachineQuery.class))).thenReturn(Arrays.asList(previousMeasure));
  when(decoratorContext.getMeasure(CoreMetrics.QUALITY_PROFILES)).thenReturn(newMeasure);
  when(languages.get("java")).thenReturn(Java.INSTANCE);
  decorator.decorate(project,decoratorContext);
  verify(eventPersister).saveEvent(any(Resource.class),argThat(new BaseMatcher<Event>(){
    @Override public void describeTo(    Description description){
    }
    @Override public boolean matches(    Object item){
      Event event=(Event)item;
      return event.getCategory().equals(Event.CATEGORY_PROFILE) && "Changes in 'Java One' (Java)".equals(event.getName()) && "from=2014-01-15T12:00:01+0000;key=J1;to=2014-02-20T12:00:01+0000".equals(event.getData());
    }
  }
));
}
