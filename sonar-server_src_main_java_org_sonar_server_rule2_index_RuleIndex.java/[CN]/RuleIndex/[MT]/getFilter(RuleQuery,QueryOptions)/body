{
  BoolFilterBuilder fb=FilterBuilders.boolFilter();
  this.addTermFilter(RuleNormalizer.RuleField.LANGUAGE.key(),query.getLanguages(),fb);
  this.addTermFilter(RuleNormalizer.RuleField.REPOSITORY.key(),query.getRepositories(),fb);
  this.addTermFilter(RuleNormalizer.RuleField.SEVERITY.key(),query.getSeverities(),fb);
  this.addTermFilter(RuleNormalizer.RuleField.KEY.key(),query.getKey(),fb);
  this.addMultiFieldTermFilter(query.getTags(),fb,RuleNormalizer.RuleField.TAGS.key(),RuleNormalizer.RuleField.SYSTEM_TAGS.key());
  if (query.getStatuses() != null && !query.getStatuses().isEmpty()) {
    Collection<String> stringStatus=new ArrayList<String>();
    for (    RuleStatus status : query.getStatuses()) {
      stringStatus.add(status.name());
    }
    this.addTermFilter(RuleNormalizer.RuleField.STATUS.key(),stringStatus,fb);
  }
  if ((query.getLanguages() != null && !query.getLanguages().isEmpty()) || (query.getRepositories() != null && !query.getRepositories().isEmpty()) || (query.getSeverities() != null && !query.getSeverities().isEmpty())|| (query.getTags() != null && !query.getTags().isEmpty())|| (query.getStatuses() != null && !query.getStatuses().isEmpty())|| (query.getKey() != null && !query.getKey().isEmpty())) {
    return fb;
  }
 else {
    return FilterBuilders.matchAllFilter();
  }
}
