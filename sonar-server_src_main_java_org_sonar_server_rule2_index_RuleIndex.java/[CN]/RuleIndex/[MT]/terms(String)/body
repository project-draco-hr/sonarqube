{
  Set<String> tags=new HashSet<String>();
  String key="_ref";
  SearchRequestBuilder request=this.getClient().prepareSearch(this.getIndexName()).setQuery(QueryBuilders.matchAllQuery()).addAggregation(AggregationBuilders.terms(key).field(fields).size(Integer.MAX_VALUE).minDocCount(1));
  SearchResponse esResponse=request.get();
  Terms aggregation=(Terms)esResponse.getAggregations().get(key);
  for (  Terms.Bucket value : aggregation.getBuckets()) {
    tags.add(value.getKey());
  }
  return tags;
}
