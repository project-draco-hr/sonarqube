{
  XContentBuilder mapping=jsonBuilder().startObject().startObject(this.indexDefinition.getIndexType()).field("dynamic",true).startObject("_id").field("path",RuleNormalizer.RuleField.KEY).endObject().startObject("properties");
  addMatchField(mapping,RuleNormalizer.RuleField.REPOSITORY.key(),"string");
  addMatchField(mapping,RuleNormalizer.RuleField.SEVERITY.key(),"string");
  addMatchField(mapping,RuleNormalizer.RuleField.STATUS.key(),"string");
  mapping.startObject(RuleNormalizer.RuleField.CREATED_AT.key()).field("type","date").field("format","date_time").endObject();
  mapping.startObject(RuleNormalizer.RuleField.UPDATED_AT.key()).field("type","date").field("format","date_time").endObject();
  mapping.startObject(RuleNormalizer.RuleField.KEY.key()).field("type","multi_field").startObject("fields").startObject(RuleNormalizer.RuleField.KEY.key()).field("type","string").field("index","analyzed").endObject().startObject("search").field("type","string").field("index","analyzed").field("index_analyzer","rule_name").field("search_analyzer","standard").endObject().endObject().endObject();
  mapping.startObject(RuleNormalizer.RuleField.NAME.key()).field("type","multi_field").startObject("fields").startObject(RuleNormalizer.RuleField.NAME.key()).field("type","string").field("index","analyzed").endObject().startObject("search").field("type","string").field("index","analyzed").field("index_analyzer","rule_name").field("search_analyzer","standard").endObject().endObject().endObject();
  mapping.startObject(RuleNormalizer.RuleField.ACTIVE.key()).field("type","nested").field("dynamic",true).endObject();
  mapping.startObject(RuleNormalizer.RuleField.PARAMS.key()).field("type","nested").field("dynamic",true).endObject();
  return mapping.endObject().endObject().endObject();
}
