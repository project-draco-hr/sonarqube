{
  String fileKey=request.mandatoryParam("key");
  DbSession session=dbClient.openSession(false);
  try {
    dbClient.componentDao().getByKey(session,fileKey);
    List<String> lines=sourceService.getLinesAsTxt(session,fileKey);
    if (lines.isEmpty()) {
      throw new NotFoundException("File '" + fileKey + "' has no sources");
    }
    response.newTxtWriter().values(lines).close();
  }
  finally {
    session.close();
  }
}
