{
  JMXServiceURL jmxUrl=JmxUtils.serviceUrl(LoopbackAddress.get(),command.getJmxPort());
  while (ProcessUtils.isAlive(process)) {
    try {
      JMXConnector jmxConnector=JMXConnectorFactory.connect(jmxUrl,null);
      MBeanServerConnection mBeanServer=jmxConnector.getMBeanServerConnection();
      return JMX.newMBeanProxy(mBeanServer,JmxUtils.objectName(command.getKey()),ProcessMXBean.class);
    }
 catch (    Exception e) {
      latestException=new IllegalStateException(String.format("Fail to connect to JMX bean of %s [%s] ",command.getKey(),jmxUrl),e);
    }
    Thread.sleep(300L);
  }
  return null;
}
