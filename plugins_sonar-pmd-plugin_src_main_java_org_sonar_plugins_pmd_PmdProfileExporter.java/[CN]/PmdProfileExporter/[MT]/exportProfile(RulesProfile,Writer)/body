{
  try {
    PmdRuleset tree=buildModuleTree(profile.getActiveRulesByRepository(PmdConstants.REPOSITORY_KEY),profile.getName());
    String xmlModules=buildXmlFromModuleTree(tree);
    writer.append(xmlModules);
  }
 catch (  IOException e) {
    throw new SonarException("Fail to export the profile " + profile,e);
  }
}
