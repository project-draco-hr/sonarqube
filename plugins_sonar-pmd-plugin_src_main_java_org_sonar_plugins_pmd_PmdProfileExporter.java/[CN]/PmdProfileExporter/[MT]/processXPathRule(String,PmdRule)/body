{
  if (PmdConstants.XPATH_CLASS.equals(rule.getRef())) {
    rule.setRef(null);
    PmdProperty xpathMessage=rule.getProperty(PmdConstants.XPATH_MESSAGE_PARAM);
    if (xpathMessage == null) {
      throw new SonarException("Property '" + PmdConstants.XPATH_MESSAGE_PARAM + "' should be set for PMD rule "+ sonarRuleKey);
    }
    rule.setMessage(xpathMessage.getValue());
    rule.removeProperty(PmdConstants.XPATH_MESSAGE_PARAM);
    PmdProperty xpathExp=rule.getProperty(PmdConstants.XPATH_EXPRESSION_PARAM);
    if (xpathExp == null) {
      throw new SonarException("Property '" + PmdConstants.XPATH_EXPRESSION_PARAM + "' should be set for PMD rule "+ sonarRuleKey);
    }
    xpathExp.setCdataValue(xpathExp.getValue());
    rule.setClazz(PmdConstants.XPATH_CLASS);
    rule.setName(sonarRuleKey);
  }
}
