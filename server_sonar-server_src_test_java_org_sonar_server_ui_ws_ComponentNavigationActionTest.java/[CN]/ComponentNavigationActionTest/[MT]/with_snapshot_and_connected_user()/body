{
  Date snapshotDate=DateUtils.parseDateTime("2015-04-22T11:44:00+0200");
  int userId=42;
  ComponentDto project=ComponentTesting.newProjectDto("abcd").setKey("polop").setName("Polop");
  dbClient.componentDao().insert(session,project);
  dbClient.snapshotDao().insert(session,new SnapshotDto().setCreatedAt(snapshotDate.getTime()).setVersion("3.14").setLast(true).setQualifier(project.qualifier()).setComponentId(project.getId()).setRootProjectId(project.getId()).setScope(project.scope()));
  session.commit();
  userSessionRule.login("obiwan").setUserId(userId).addProjectUuidPermissions(UserRole.USER,"abcd");
  wsTester=new WsTester(new NavigationWs(new ComponentNavigationAction(dbClient,activeDashboardDao,new Views(userSessionRule),i18n,resourceTypes,userSessionRule)));
  wsTester.newGetRequest("api/navigation","component").setParam("componentKey","polop").execute().assertJson(getClass(),"with_snapshot_and_connected_user.json");
}
