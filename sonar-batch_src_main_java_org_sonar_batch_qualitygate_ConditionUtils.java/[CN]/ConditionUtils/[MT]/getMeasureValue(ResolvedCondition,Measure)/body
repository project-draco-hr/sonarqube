{
  Metric metric=condition.metric();
  if (isADouble(metric)) {
    return getValue(condition,measure);
  }
  if (isAInteger(metric)) {
    return parseInteger(condition,measure);
  }
  if (isAWorkDuration(metric)) {
    return parseLong(condition,measure);
  }
  if (condition.period() == null) {
    return getMeasureValueForStringOrBoolean(metric,measure);
  }
  throw new NotImplementedException(metric.getType().toString());
}
