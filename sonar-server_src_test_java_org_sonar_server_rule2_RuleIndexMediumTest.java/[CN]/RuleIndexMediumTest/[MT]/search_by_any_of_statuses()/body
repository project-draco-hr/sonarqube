{
  dao.insert(newRuleDto(RuleKey.of("java","S001")).setStatus(RuleStatus.BETA.name()),dbSession);
  dao.insert(newRuleDto(RuleKey.of("java","S002")).setStatus(RuleStatus.READY.name()),dbSession);
  dbSession.commit();
  index.refresh();
  RuleQuery query=new RuleQuery().setStatuses(Arrays.asList(RuleStatus.DEPRECATED,RuleStatus.READY));
  Result<Rule> results=index.search(query,new QueryOptions());
  assertThat(results.getHits()).hasSize(1);
  assertThat(Iterables.getFirst(results.getHits(),null).key().rule()).isEqualTo("S002");
  query=new RuleQuery().setStatuses(Arrays.asList(RuleStatus.DEPRECATED));
  assertThat(index.search(query,new QueryOptions()).getHits()).isEmpty();
  query=new RuleQuery().setStatuses(Collections.<RuleStatus>emptyList());
  assertThat(index.search(query,new QueryOptions()).getHits()).hasSize(2);
  query=new RuleQuery().setStatuses(null);
  assertThat(index.search(query,new QueryOptions()).getHits()).hasSize(2);
}
