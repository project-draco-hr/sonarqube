{
  server.enqueue(new MockResponse().setResponseCode(500));
  try (DefaultProcessCommands processCommands=DefaultProcessCommands.secondary(ipcSharedDir,ProcessId.COMPUTE_ENGINE.getIpcIndex())){
    processCommands.setUp();
    processCommands.setSystemInfoUrl(format("http://%s:%d",server.getHostName(),server.getPort()));
  }
   expectedException.expect(IllegalStateException.class);
  expectedException.expectMessage("Can not get system info of process " + ProcessId.COMPUTE_ENGINE);
  underTest.connect(ProcessId.COMPUTE_ENGINE);
}
