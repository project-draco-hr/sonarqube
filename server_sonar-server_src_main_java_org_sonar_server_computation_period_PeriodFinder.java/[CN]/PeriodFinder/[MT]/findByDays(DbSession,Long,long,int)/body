{
  List<SnapshotDto> snapshots=dbClient.snapshotDao().selectSnapshotsByQuery(session,createCommonQuery(projectId).setCreatedBefore(analysisDate).setSort(BY_DATE,ASC));
  long targetDate=DateUtils.addDays(new Date(analysisDate),-days).getTime();
  SnapshotDto snapshot=findNearestSnapshotToTargetDate(snapshots,targetDate);
  if (snapshot == null) {
    return null;
  }
  return new Period(CoreProperties.TIMEMACHINE_MODE_DAYS,targetDate,snapshot).setModeParameter(String.valueOf(days));
}
