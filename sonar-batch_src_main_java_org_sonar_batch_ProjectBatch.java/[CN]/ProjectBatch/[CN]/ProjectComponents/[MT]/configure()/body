{
  ProjectDefinition projectDefinition=getComponent(ProjectTree.class).getProjectDefinition(project.getKey());
  addComponent(projectDefinition);
  for (  Object component : projectDefinition.getContainerExtensions()) {
    addComponent(component);
    if (component instanceof MavenProject) {
      MavenProject pom=(MavenProject)component;
      project.setPom(pom);
      project.setPackaging(pom.getPackaging());
    }
  }
  addComponent(project);
  addComponent(DefaultProjectClasspath.class);
  addComponent(DefaultProjectFileSystem2.class);
  addComponent(project.getConfiguration());
  getComponent(BatchPluginRepository.class).registerPlugins(getContainer());
  addComponent(DaoFacade.class);
  addComponent(RulesDao.class);
  addComponent(getComponent(DefaultResourcePersister.class).getSnapshot(project));
  addComponent(org.sonar.api.database.daos.MeasuresDao.class);
  addComponent(ProfilesDao.class);
  addComponent(AsyncMeasuresDao.class);
  addComponent(AsyncMeasuresService.class);
  addComponent(DefaultRulesManager.class);
  addComponent(DefaultSensorContext.class);
  addComponent(Languages.class);
  addComponent(BatchExtensionDictionnary.class);
  addComponent(DefaultTimeMachine.class);
  addComponent(ViolationFilters.class);
  addComponent(ResourceFilters.class);
  addComponent(DefaultModelFinder.class);
  addComponent(TimeMachineConfiguration.class);
  addComponent(PastViolationsLoader.class);
  addComponent(ProfileLoader.class,DefaultProfileLoader.class);
  addAdapter(new ProfileProvider());
  addAdapter(new CheckProfileProvider());
}
