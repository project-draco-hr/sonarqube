{
  try {
    List<URL> resources=Lists.newArrayList();
    List<URL> others=Lists.newArrayList();
    for (    URL url : urls) {
      if (isResource(url)) {
        resources.add(url);
      }
 else {
        others.add(url);
      }
    }
    ClassLoader parent;
    if (resources.isEmpty()) {
      parent=baseClassLoader;
    }
 else {
      parent=new ResourcesClassLoader(resources,baseClassLoader);
    }
    final ClassRealm realm;
    if (childFirst) {
      ClassRealm parentRealm=world.newRealm(key + "-parent",parent);
      realm=parentRealm.createChildRealm(key);
    }
 else {
      realm=world.newRealm(key,parent);
    }
    for (    URL url : others) {
      realm.addConstituent(url);
    }
    return realm.getClassLoader();
  }
 catch (  DuplicateRealmException e) {
    throw new SonarException(e);
  }
}
