{
  Metric metric=mock(Metric.class);
  when(metric.getId()).thenReturn(42);
  when(metric.getKey()).thenReturn("metric");
  when(metric.getName()).thenReturn("Metric");
  when(metric.getType()).thenReturn(ValueType.BOOL);
  when(metric.getDomain()).thenReturn("General");
  Collection<Metric> metrics=ImmutableList.of(metric);
  when(qGates.gateMetrics()).thenReturn(metrics);
  tester.newRequest("metrics").execute().assertJson("{'metrics':[{'id':42,'key':'metric','name':'Metric','type':'BOOL','domain':'General'}]}");
}
