{
  int days=project.getConfiguration().getInt(CoreProperties.CORE_TENDENCY_DEPTH_PROPERTY,CoreProperties.CORE_TENDENCY_DEPTH_DEFAULT_VALUE);
  List<Metric> metrics=new ArrayList<Metric>();
  for (  Metric metric : measuresDao.getMetrics()) {
    if (metric.isNumericType()) {
      metrics.add(metric);
    }
  }
  query=new TimeMachineQuery(null).setFrom(DateUtils.addDays(project.getAnalysisDate(),-days)).setToCurrentAnalysis(true).setMetrics(metrics);
  return query;
}
