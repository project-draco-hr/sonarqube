{
  ListMultimap<RulePriority,Issue> issuesPerSeverities=ArrayListMultimap.create();
  for (  Issue issue : issues) {
    issuesPerSeverities.put(RulePriority.valueOf(issue.severity()),issue);
  }
  for (  RulePriority severity : RulePriority.values()) {
    Metric metric=severityToMetric(severity);
    Measure measure=new Measure(metric);
    for (    PastSnapshot pastSnapshot : timeMachineConfiguration.getProjectPastSnapshots()) {
      int variationIndex=pastSnapshot.getIndex();
      int count=countIssues(issuesPerSeverities.get(severity),pastSnapshot.getTargetDate());
      Collection<Measure> children=context.getChildrenMeasures(MeasuresFilters.metric(metric));
      double sum=MeasureUtils.sumOnVariation(true,variationIndex,children) + count;
      measure.setVariation(variationIndex,sum);
    }
    context.saveMeasure(measure);
  }
}
