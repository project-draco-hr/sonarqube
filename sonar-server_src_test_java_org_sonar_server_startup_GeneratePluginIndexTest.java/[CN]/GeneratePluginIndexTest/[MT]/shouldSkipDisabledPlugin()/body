{
  DefaultServerPluginRepository repository=mock(DefaultServerPluginRepository.class);
  PluginMetadata sqale=newMetadata("sqale");
  PluginMetadata checkstyle=newMetadata("checkstyle");
  when(repository.getMetadata()).thenReturn(Arrays.asList(sqale,checkstyle));
  when(repository.isDisabled("checkstyle")).thenReturn(true);
  new GeneratePluginIndex(fileSystem,repository).start();
  List<String> lines=FileUtils.readLines(index);
  assertThat(lines.size(),Is.is(1));
  assertThat(lines.get(0),containsString("sqale"));
}
