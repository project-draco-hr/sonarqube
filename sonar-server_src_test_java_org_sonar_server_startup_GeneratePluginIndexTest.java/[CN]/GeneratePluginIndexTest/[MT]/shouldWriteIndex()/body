{
  PluginRepository repository=mock(PluginRepository.class);
  PluginMetadata sqale=newMetadata("sqale");
  PluginMetadata checkstyle=newMetadata("checkstyle");
  when(repository.getMetadata()).thenReturn(Arrays.asList(sqale,checkstyle));
  new GeneratePluginIndex(fileSystem,repository).start();
  List<String> lines=FileUtils.readLines(index);
  assertThat(lines.size(),Is.is(2));
  assertThat(lines.get(0),containsString("sqale"));
  assertThat(lines.get(1),containsString("checkstyle"));
}
