{
  ComponentDto project=new ComponentDto().setId(1L).setUuid("ABCD").setRootUuid("ABCD").setKey("org.codehaus.sonar:sonar").setName("SonarQube").setLongName("SonarQube").setQualifier("TRK").setScope("TRK").setEnabled(true);
  db.componentDao().insert(session,project);
  QualityProfileDto profile1=QProfileTesting.newXooP1();
  QualityProfileDto profile2=QProfileTesting.newXooP2();
  db.qualityProfileDao().insert(session,profile1,profile2);
  db.qualityProfileDao().insertProjectProfileAssociation(project.uuid(),profile1.getKey(),session);
  session.commit();
  wsTester.newPostRequest(QProfilesWs.API_ENDPOINT,"add_project").setParam("profileKey",profile2.getKee()).setParam("projectUuid",project.uuid()).execute().assertNoContent();
  assertThat(tester.get(QProfileFactory.class).getByProjectAndLanguage(session,project.getKey(),"xoo").getKee()).isEqualTo(profile2.getKee());
}
