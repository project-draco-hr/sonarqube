{
  logInit(flags);
  Set<String> errors=new LinkedHashSet<>();
  List<ColumnDef> columns=select(connection,ColumnDef.SELECT_COLUMNS + "FROM [INFORMATION_SCHEMA].[COLUMNS] " + "WHERE collation_name is not null "+ "ORDER BY table_name,column_name",ColumnDef.ColumnDefRowConverter.INSTANCE);
  for (  ColumnDef column : from(columns).filter(ColumnDef.IsInSonarQubeTablePredicate.INSTANCE)) {
    if (!containsIgnoreCase(column.getCollation(),CASE_SENSITIVE_ACCENT_SENSITIVE)) {
      if (flags.contains(AUTO_REPAIR_COLLATION)) {
        repairColumnCollation(connection,column);
      }
 else {
        errors.add(format("%s.%s",column.getTable(),column.getColumn()));
      }
    }
  }
  if (!errors.isEmpty()) {
    throw MessageException.of(format("Case-sensitive and accent-sensitive collation is required for database columns [%s]",Joiner.on(", ").join(errors)));
  }
}
