{
  super.close();
  source.setStatus(httpStatus);
  source.setContentType(mediaType);
  ServletOutputStream stream=null;
  try {
    stream=source.getOutputStream();
    IOUtils.copy(new ByteArrayInputStream(toString().getBytes(Charsets.UTF_8)),stream);
    stream.flush();
  }
 catch (  IOException e) {
    throw new IllegalStateException("Fail to flush buffer",e);
  }
 finally {
    IOUtils.closeQuietly(stream);
  }
}
