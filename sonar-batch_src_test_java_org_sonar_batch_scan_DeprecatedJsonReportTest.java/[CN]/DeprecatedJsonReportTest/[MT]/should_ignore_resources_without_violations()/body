{
  when(server.getVersion()).thenReturn("3.4");
  doReturn(Arrays.<DefaultIssue>asList()).when(deprecatedJsonReport).getIssues(resource);
  StringWriter output=new StringWriter();
  deprecatedJsonReport.writeJson(ImmutableSet.of(resource),output);
  String json=output.toString();
  assertThat(json).isEqualTo("{\"version\":\"3.4\",\"violations_per_resource\":{}}");
}
