{
  ChannelDispatcher<StringBuilder> dispatcher=ChannelDispatcher.builder().addChannel(new MyLiteralChannel()).build();
  StringBuilder output=new StringBuilder();
  CodeReaderConfiguration codeReaderConfiguration=new CodeReaderConfiguration();
  codeReaderConfiguration.setBufferCapacity(2);
  int literalLength=100000;
  String veryLongLiteral=String.format(String.format("%%0%dd",literalLength),0).replace("0","a");
  assertThat(veryLongLiteral.length(),is(100000));
  dispatcher.consume(new CodeReader("\">" + veryLongLiteral + "<\"",codeReaderConfiguration),output);
  assertThat(output.toString(),is("<literal>\">" + veryLongLiteral + "<\"</literal>"));
}
