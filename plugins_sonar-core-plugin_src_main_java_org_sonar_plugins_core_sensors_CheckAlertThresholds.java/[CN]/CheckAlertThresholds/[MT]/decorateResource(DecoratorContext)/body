{
  Metric.Level globalLevel=Metric.Level.OK;
  List<String> labels=Lists.newArrayList();
  for (  final Alert alert : profile.getAlerts()) {
    Measure measure=context.getMeasure(alert.getMetric());
    if (measure != null) {
      Metric.Level level=AlertUtils.getLevel(alert,measure);
      measure.setAlertStatus(level);
      String text=getText(alert,level);
      if (!StringUtils.isBlank(text)) {
        measure.setAlertText(text);
        labels.add(text);
      }
      context.saveMeasure(measure);
      if (Metric.Level.WARN == level && globalLevel != Metric.Level.ERROR) {
        globalLevel=Metric.Level.WARN;
      }
 else       if (Metric.Level.ERROR == level) {
        globalLevel=Metric.Level.ERROR;
      }
    }
  }
  Measure globalMeasure=new Measure(CoreMetrics.ALERT_STATUS,globalLevel);
  globalMeasure.setAlertStatus(globalLevel);
  globalMeasure.setAlertText(StringUtils.join(labels,", "));
  context.saveMeasure(globalMeasure);
}
