{
  ResultSetMetaData metaData=resultSet.getMetaData();
  int colCount=metaData.getColumnCount();
  List<Map<String,Object>> rows=newArrayList();
  while (resultSet.next()) {
    Map<String,Object> columns=newHashMap();
    for (int i=1; i <= colCount; i++) {
      Object value=resultSet.getObject(i);
      if (value instanceof Clob) {
        value=IOUtils.toString(((Clob)value).getAsciiStream());
      }
 else       if (value instanceof BigDecimal) {
        value=((BigDecimal)value).longValue();
      }
 else       if (value instanceof Integer) {
        value=((Integer)value).longValue();
      }
      columns.put(metaData.getColumnLabel(i),value);
    }
    rows.add(columns);
  }
  return rows;
}
