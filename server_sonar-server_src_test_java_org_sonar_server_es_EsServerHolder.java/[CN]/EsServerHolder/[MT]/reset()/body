{
  TransportClient client=new TransportClient(ImmutableSettings.settingsBuilder().put("node.name",nodeName).put("network.bind_host","localhost").put("cluster.name",clusterName).build());
  client.addTransportAddress(new InetSocketTransportAddress(LoopbackAddress.get().getHostAddress(),port));
  client.admin().cluster().prepareHealth().setWaitForGreenStatus().get();
  DeleteIndexResponse response=client.admin().indices().prepareDelete("_all").get();
  if (!response.isAcknowledged()) {
    throw new IllegalStateException("Fail to delete all indices");
  }
  client.close();
}
