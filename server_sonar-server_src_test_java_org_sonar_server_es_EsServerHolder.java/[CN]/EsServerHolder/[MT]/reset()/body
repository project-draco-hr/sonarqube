{
  TransportClient client=TransportClient.builder().settings(Settings.builder().put("network.bind_host","localhost").put("cluster.name",clusterName).build()).build();
  client.addTransportAddress(new InetSocketTransportAddress(LoopbackAddress.get(),port));
  client.admin().cluster().prepareHealth().setWaitForGreenStatus().get();
  DeleteIndexResponse response=client.admin().indices().prepareDelete("_all").get();
  if (!response.isAcknowledged()) {
    throw new IllegalStateException("Fail to delete all indices");
  }
  client.close();
}
