{
  if (HOLDER == null) {
    File homeDir=TestUtils.newTempDir("tmp-es-");
    homeDir.delete();
    homeDir.mkdir();
    String clusterName="testCluster";
    String nodeName="test";
    String hostName="127.0.0.1";
    int port=NetworkUtils.freePort();
    Properties properties=new Properties();
    properties.setProperty(ProcessProperties.CLUSTER_NAME,clusterName);
    properties.setProperty(ProcessProperties.CLUSTER_NODE_NAME,nodeName);
    properties.setProperty(ProcessProperties.SEARCH_PORT,String.valueOf(port));
    properties.setProperty(ProcessProperties.SEARCH_HOST,hostName);
    properties.setProperty(ProcessProperties.PATH_HOME,homeDir.getAbsolutePath());
    properties.setProperty(ProcessEntryPoint.PROPERTY_SHARED_PATH,homeDir.getAbsolutePath());
    SearchServer server=new SearchServer(new Props(properties));
    server.start();
    HOLDER=new EsServerHolder(server,clusterName,nodeName,port,hostName,homeDir);
  }
  HOLDER.reset();
  return HOLDER;
}
