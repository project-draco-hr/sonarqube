{
  Issue issue=createIssue("rule1","repo1").setDebt(ONE_DAY_DEBT);
  when(issuable.issues()).thenReturn(newArrayList(issue));
  DefaultCharacteristic parentCharacteristic=new DefaultCharacteristic().setKey("parentCharacteristic");
  DefaultCharacteristic characteristic=new DefaultCharacteristic().setKey("characteristic").setParent(parentCharacteristic);
  RuleKey ruleKey=RuleKey.of("repo1","rule1");
  DefaultRequirement requirement=new DefaultRequirement().setCharacteristic(characteristic).setRuleKey(ruleKey);
  when(defaultTechnicalDebtModel.requirementsByRule(ruleKey)).thenReturn(requirement);
  doReturn(newArrayList(requirement)).when(defaultTechnicalDebtModel).requirements();
  decorator.decorate(resource,context);
  verify(context).saveMeasure(CoreMetrics.TECHNICAL_DEBT,ONE_DAY_DEBT.doubleValue());
  verify(context).saveMeasure(argThat(new IsCharacteristicMeasure(CoreMetrics.TECHNICAL_DEBT,parentCharacteristic,ONE_DAY_DEBT.doubleValue())));
  verify(context).saveMeasure(argThat(new IsCharacteristicMeasure(CoreMetrics.TECHNICAL_DEBT,characteristic,ONE_DAY_DEBT.doubleValue())));
  verify(context).saveMeasure(argThat(new IsCharacteristicMeasure(CoreMetrics.TECHNICAL_DEBT,requirement,ONE_DAY_DEBT.doubleValue())));
}
