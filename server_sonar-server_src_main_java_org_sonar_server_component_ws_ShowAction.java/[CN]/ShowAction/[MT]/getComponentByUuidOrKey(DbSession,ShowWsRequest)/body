{
  ComponentDto component=componentFinder.getByUuidOrKey(dbSession,request.getId(),request.getKey(),ParamNames.ID_AND_KEY);
  String projectUuid=firstNonNull(component.projectUuid(),component.uuid());
  if (!userSession.hasGlobalPermission(GlobalPermissions.SYSTEM_ADMIN) && !userSession.hasProjectPermissionByUuid(UserRole.ADMIN,projectUuid) && !userSession.hasProjectPermissionByUuid(UserRole.USER,projectUuid)) {
    throw insufficientPrivilegesException();
  }
  return component;
}
