{
  TimeProfiler profiler=new TimeProfiler();
  DatabaseSession session=sessionFactory.getSession();
  RulesByRepository existingRules=new RulesByRepository(findAllRules(session));
  List<Rule> registeredRules=registerRules(existingRules,profiler,session);
  disableDeprecatedRules(existingRules,registeredRules,session);
  disableDeprecatedRepositories(existingRules,session);
  session.commit();
  notifyForRemovedRules(existingRules);
}
