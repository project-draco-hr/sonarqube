{
  TimeProfiler profiler=new TimeProfiler();
  DatabaseSession session=sessionFactory.getSession();
  RulesByRepository existingRules=new RulesByRepository(findAllRules(session));
  registerRules(existingRules,profiler,session);
  disableDeprecatedRepositories(existingRules,repositories,session);
  disableDeprecatedUserRules(profiler,session);
  session.commit();
}
