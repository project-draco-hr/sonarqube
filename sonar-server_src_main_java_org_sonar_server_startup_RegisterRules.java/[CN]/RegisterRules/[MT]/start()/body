{
  DatabaseSession session=sessionFactory.getSession();
  RulesByRepository existingRules=new RulesByRepository(findAllRules(session));
  List<Rule> registeredRules=registerRules(existingRules,session);
  LOG.info("Removing deprecated rules");
  disableDeprecatedRules(existingRules,registeredRules,session);
  disableDeprecatedRepositories(existingRules,session);
  session.commit();
}
