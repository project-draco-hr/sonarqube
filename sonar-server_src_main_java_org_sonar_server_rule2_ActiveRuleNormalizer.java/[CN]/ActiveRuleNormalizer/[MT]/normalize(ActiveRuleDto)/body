{
  XContentBuilder document=jsonBuilder().startObject();
  document.startObject(RuleNormalizer.RuleField.ACTIVE.key());
  document.startObject(rule.getKey().toString());
  indexField(ActiveRuleField.OVERRIDE.key(),rule.doesOverride(),document);
  indexField(ActiveRuleField.INHERITANCE.key(),rule.getInheritance(),document);
  indexField(ActiveRuleField.PROFILE_ID.key(),rule.getProfileId(),document);
  indexField(ActiveRuleField.SEVERITY.key(),rule.getSeverityString(),document);
  indexField(ActiveRuleField.PARENT_ID.key(),rule.getParentId(),document);
  document.endObject();
  document.endObject();
  UpdateRequest request=new UpdateRequest().doc(document);
  request.docAsUpsert(true);
  return request;
}
