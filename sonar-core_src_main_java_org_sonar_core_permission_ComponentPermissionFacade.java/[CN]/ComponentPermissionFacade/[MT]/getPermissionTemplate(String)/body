{
  PermissionTemplateDto permissionTemplateDto=permissionDao.selectTemplateByKey(templateKey);
  if (permissionTemplateDto == null) {
    throw new IllegalArgumentException("Could not retrieve permission template with key " + templateKey);
  }
  PermissionTemplateDto templateWithPermissions=permissionDao.selectPermissionTemplate(permissionTemplateDto.getName());
  if (templateWithPermissions == null) {
    throw new IllegalArgumentException("Could not retrieve permissions for template with key " + templateKey);
  }
  return templateWithPermissions;
}
