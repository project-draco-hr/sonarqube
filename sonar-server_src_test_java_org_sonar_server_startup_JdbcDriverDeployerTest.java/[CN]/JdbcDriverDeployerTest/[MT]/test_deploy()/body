{
  DefaultServerFileSystem fs=mock(DefaultServerFileSystem.class);
  File initialDriver=new File(Resources.getResource(getClass(),"JdbcDriverDeployerTest/deploy/my-driver.jar").toURI());
  when(fs.getJdbcDriver()).thenReturn(initialDriver);
  File deployDir=temp.newFolder("deploy");
  when(fs.getDeployDir()).thenReturn(deployDir);
  File deployedIndex=new File(deployDir,"jdbc-driver.txt");
  File deployedFile=new File(deployDir,"my-driver.jar");
  assertThat(deployedIndex).doesNotExist();
  assertThat(deployedFile).doesNotExist();
  when(fs.getDeployedJdbcDriverIndex()).thenReturn(deployedIndex);
  new JdbcDriverDeployer(fs).start();
  assertThat(deployedIndex).exists();
  assertThat(deployedFile).exists();
  assertThat(deployedFile).hasSize(initialDriver.length());
  assertThat(Files.toString(deployedIndex,Charsets.UTF_8)).isEqualTo("my-driver.jar|02b97f7bc37b2b68fc847fcc3fc1c156");
}
