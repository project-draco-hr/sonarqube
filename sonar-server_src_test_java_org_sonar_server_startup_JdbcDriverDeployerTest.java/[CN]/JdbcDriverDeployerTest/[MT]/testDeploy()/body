{
  DefaultServerFileSystem fs=mock(DefaultServerFileSystem.class);
  File initialDriver=TestUtils.getResource(getClass(),"deploy/my-driver.jar");
  when(fs.getJdbcDriver()).thenReturn(initialDriver);
  File deployDir=TestUtils.getTestTempDir(getClass(),"deploy",true);
  when(fs.getDeployDir()).thenReturn(deployDir);
  File deployedIndex=new File(deployDir,"jdbc-driver.txt");
  File deployedFile=new File(deployDir,"my-driver.jar");
  assertThat(deployedIndex).doesNotExist();
  assertThat(deployedFile).doesNotExist();
  when(fs.getDeployedJdbcDriverIndex()).thenReturn(deployedIndex);
  JdbcDriverDeployer deployer=new JdbcDriverDeployer(fs);
  deployer.start();
  assertThat(deployedIndex).exists();
  assertThat(deployedFile).exists();
  assertThat(deployedFile.length(),is(initialDriver.length()));
  assertThat(FileUtils.readFileToString(deployedIndex)).isEqualTo("my-driver.jar|02b97f7bc37b2b68fc847fcc3fc1c156");
}
