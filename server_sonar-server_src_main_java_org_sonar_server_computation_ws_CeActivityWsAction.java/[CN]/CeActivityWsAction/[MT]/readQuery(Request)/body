{
  CeActivityQuery query=new CeActivityQuery();
  query.setType(wsRequest.param(PARAM_TYPE));
  query.setOnlyCurrents(wsRequest.mandatoryParamAsBoolean(PARAM_ONLY_CURRENTS));
  String status=wsRequest.param(PARAM_STATUS);
  if (status != null) {
    query.setStatus(CeActivityDto.Status.valueOf(status));
  }
  String componentId=wsRequest.param(PARAM_COMPONENT_ID);
  if (componentId == null) {
    userSession.checkGlobalPermission(UserRole.ADMIN);
  }
 else {
    userSession.checkProjectUuidPermission(UserRole.ADMIN,componentId);
    query.setComponentUuid(componentId);
  }
  return query;
}
