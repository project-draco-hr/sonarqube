{
  Snapshot snapshot=resourcePersister.getSnapshotOrFail(resource);
  if (measure.getId() != null) {
    return update(measure,snapshot);
  }
  if (shouldPersistMeasure(resource,measure)) {
    MeasureModel insert=insert(measure,snapshot);
    measure.setId(insert.getId());
    return insert;
  }
  return null;
}
