{
  Snapshot snapshot=resourcePersister.getSnapshotOrFail(resource);
  if (measure.getId() != null) {
    return update(measure,snapshot);
  }
  if (shouldPersistMeasure(resource,measure)) {
    return insert(measure,snapshot);
  }
  return null;
}
