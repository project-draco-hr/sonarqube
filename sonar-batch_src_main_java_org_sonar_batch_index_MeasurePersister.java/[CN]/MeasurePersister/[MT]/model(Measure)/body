{
  MeasureModel model=new MeasureModel();
  model.setMetricId(measure.getMetric().getId());
  model.setDescription(measure.getDescription());
  model.setData(measure.getData());
  model.setAlertStatus(measure.getAlertStatus());
  model.setAlertText(measure.getAlertText());
  model.setTendency(measure.getTendency());
  model.setVariationValue1(measure.getVariation1());
  model.setVariationValue2(measure.getVariation2());
  model.setVariationValue3(measure.getVariation3());
  model.setVariationValue4(measure.getVariation4());
  model.setVariationValue5(measure.getVariation5());
  model.setUrl(measure.getUrl());
  if (measure.getCharacteristic() != null) {
    model.setCharacteristicId(measure.getCharacteristic().id());
  }
 else   if (measure.getRequirement() != null) {
    model.setCharacteristicId(measure.getRequirement().id());
  }
  model.setPersonId(measure.getPersonId());
  if (measure.getValue() != null) {
    model.setValue(measure.getValue().doubleValue());
  }
 else {
    model.setValue(null);
  }
  if (measure instanceof RuleMeasure) {
    RuleMeasure ruleMeasure=(RuleMeasure)measure;
    model.setRulePriority(ruleMeasure.getSeverity());
    if (ruleMeasure.getRule() != null) {
      Rule ruleWithId=ruleFinder.findByKey(ruleMeasure.getRule().getRepositoryKey(),ruleMeasure.getRule().getKey());
      if (ruleWithId == null) {
        throw new SonarException("Can not save a measure with unknown rule " + ruleMeasure);
      }
      model.setRuleId(ruleWithId.getId());
    }
  }
  return model;
}
