{
  MeasuresDao measuresDao=new MeasuresDao(getSession());
  Collection<Metric> oldMetrics=createMetrics();
  measuresDao.registerMetrics(oldMetrics);
  MetricsBackup metricsBackup=new MetricsBackup(getSession());
  SonarConfig sonarConfig=new SonarConfig();
  Collection<Metric> importedMetrics=createNewMetrics();
  sonarConfig.setMetrics(importedMetrics);
  metricsBackup.importXml(sonarConfig);
  Collection<Metric> allMetrics=measuresDao.getMetrics();
  assertThat(allMetrics.size(),is(4));
  Collection<Metric> enabledMetrics=measuresDao.getEnabledMetrics();
  assertThat(enabledMetrics.size(),is(3));
}
