{
  db.truncateTables();
  dbClient=new DbClient(db.database(),db.myBatis(),new MeasureDao());
  sourceLineIndex=mock(SourceLineIndex.class);
  metricCache=mock(MetricCache.class);
  projectSettings=new Settings();
  when(metricCache.get(anyString())).thenReturn(new MetricDto().setId(10));
  dbComponentsRefCache=new DbComponentsRefCache();
  dir=temp.newFolder();
  sut=new PersistNumberOfDaysSinceLastCommitStep(System2.INSTANCE,dbClient,sourceLineIndex,metricCache,dbComponentsRefCache);
}
