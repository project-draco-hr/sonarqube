{
  ComponentDto project=newProjectDto().setKey("project-key").setUuid("project-uuid");
  SnapshotDto projectSnapshot=componentDb.insertProjectAndSnapshot(project);
  for (int i=1; i <= 9; i++) {
    componentDb.insertComponentAndSnapshot(newFileDto(project,"file-uuid-" + i),projectSnapshot);
  }
  db.commit();
  componentDb.indexProjects();
  ComponentTreeQuery query=newTreeQuery(projectSnapshot).setPage(2).setPageSize(3).setAsc(false).build();
  List<ComponentDto> result=underTest.selectDirectChildren(dbSession,query);
  int count=underTest.countDirectChildren(dbSession,query);
  assertThat(count).isEqualTo(9);
  assertThat(result).extracting("uuid").containsExactly("file-uuid-6","file-uuid-5","file-uuid-4");
}
