{
  if (!IssueChangeNotification.TYPE.equals(notif.getType())) {
    return null;
  }
  StringBuilder sb=new StringBuilder();
  appendHeader(notif,sb);
  sb.append(NEW_LINE);
  appendChanges(notif,sb);
  sb.append(NEW_LINE);
  appendFooter(sb,notif);
  String projectName=notif.getFieldValue("projectName");
  String issueKey=notif.getFieldValue("key");
  String author=notif.getFieldValue("changeAuthor");
  EmailMessage message=new EmailMessage().setMessageId("issue-changes/" + issueKey).setSubject(projectName + ", change on issue #" + issueKey).setMessage(sb.toString());
  if (author != null) {
    message.setFrom(getUserFullName(author));
  }
  return message;
}
