{
  String componentKey="project:src/File.xoo";
  String uuid="polop";
  ComponentDto component=new ComponentDto().setUuid(uuid);
  String hashes="polop\n" + "\n" + "pilip";
  MockUserSession.set().setLogin("polop").addComponentPermission(UserRole.CODEVIEWER,"palap",componentKey);
  when(componentDao.getByKey(any(DbSession.class),eq(componentKey))).thenReturn(component);
  when(fileSourceDao.selectLineHashes(eq(uuid),any(DbSession.class))).thenReturn(hashes);
  WsTester.TestRequest request=tester.newGetRequest("api/sources","hash").setParam("key",componentKey);
  assertThat(request.execute().outputAsString()).isEqualTo(hashes);
}
