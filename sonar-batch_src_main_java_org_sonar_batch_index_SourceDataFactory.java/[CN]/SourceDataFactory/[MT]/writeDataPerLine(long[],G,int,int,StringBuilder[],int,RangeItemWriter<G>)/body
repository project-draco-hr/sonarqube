{
  int currentLineIdx=startLine;
  long ruleStartOffsetCurrentLine=globalStartOffset;
  while (currentLineIdx < originalLineOffsets.length && globalEndOffset >= originalLineOffsets[currentLineIdx]) {
    writeItem(item,dataPerLine,currentLineIdx,ruleStartOffsetCurrentLine - originalLineOffsets[currentLineIdx - 1],originalLineOffsets[currentLineIdx] - originalLineOffsets[currentLineIdx - 1],writer);
    currentLineIdx++;
    ruleStartOffsetCurrentLine=originalLineOffsets[currentLineIdx - 1];
  }
  writeItem(item,dataPerLine,currentLineIdx,ruleStartOffsetCurrentLine - originalLineOffsets[currentLineIdx - 1],globalEndOffset - originalLineOffsets[currentLineIdx - 1],writer);
}
