{
  Map<String,String> props=new HashMap<>();
  props.put(CoreProperties.ANALYSIS_MODE,CoreProperties.ANALYSIS_MODE_ISSUES);
  GlobalProperties globalProps=new GlobalProperties(props);
  props.put("sonar.scanChangedFilesOnly","true");
  AnalysisProperties analysisProps=new AnalysisProperties(props);
  DefaultAnalysisMode mode=new DefaultAnalysisMode(globalProps,analysisProps);
  assertThat(mode.onlyAnalyzeChanged()).isTrue();
  props.put(CoreProperties.ANALYSIS_MODE,CoreProperties.ANALYSIS_MODE_PUBLISH);
  analysisProps=new AnalysisProperties(props);
  mode=new DefaultAnalysisMode(globalProps,analysisProps);
  assertThat(mode.onlyAnalyzeChanged()).isFalse();
}
