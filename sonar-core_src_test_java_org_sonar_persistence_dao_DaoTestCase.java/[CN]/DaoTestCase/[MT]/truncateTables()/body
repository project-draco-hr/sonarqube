{
  List<String> tables=listTables();
  Connection connection=myBatis.openSession().getConnection();
  Statement statement=connection.createStatement();
  for (  String table : tables) {
    String truncateCommand=databaseCommands.truncate(table);
    LoggerFactory.getLogger(getClass()).info("Execute: " + truncateCommand);
    statement.executeUpdate(truncateCommand);
    connection.commit();
    try {
      statement.executeUpdate(databaseCommands.resetPrimaryKey(table));
      connection.commit();
    }
 catch (    Exception e) {
      connection.rollback();
    }
  }
  statement.close();
  connection.commit();
  connection.close();
}
