{
  Connection connection=myBatis.openSession().getConnection();
  Statement statement=connection.createStatement();
  LoggerFactory.getLogger(getClass()).info("Truncate tables and reset primary keys");
  for (  String table : DatabaseUtils.TABLE_NAMES) {
    String truncateCommand=databaseCommands.truncate(table);
    statement.executeUpdate(truncateCommand);
    connection.commit();
    try {
      statement.executeUpdate(databaseCommands.resetPrimaryKey(table));
      connection.commit();
    }
 catch (    Exception e) {
      connection.rollback();
    }
  }
  statement.close();
  connection.commit();
  connection.close();
}
