{
  String queryText=query.getQueryText();
  if (queryText == null || queryText.isEmpty()) {
    return QueryBuilders.matchAllQuery();
  }
  BoolQueryBuilder qb=QueryBuilders.boolQuery();
  String queryString=query.getQueryText();
  qb.should(QueryBuilders.simpleQueryStringQuery(query.getQueryText()).field(RuleIndexDefinition.FIELD_RULE_NAME + "." + BaseIndex.SEARCH_WORDS_SUFFIX,20f).field(RuleIndexDefinition.FIELD_RULE_HTML_DESCRIPTION + "." + BaseIndex.SEARCH_WORDS_SUFFIX,3f).defaultOperator(SimpleQueryStringBuilder.Operator.AND)).boost(20f);
  qb.should(this.termQuery(RuleIndexDefinition.FIELD_RULE_KEY,queryString,15f));
  qb.should(this.termQuery(RuleIndexDefinition.FIELD_RULE_KEY_AS_LIST,queryString,35f));
  qb.should(this.termQuery(RuleIndexDefinition.FIELD_RULE_LANGUAGE,queryString,3f));
  qb.should(this.termQuery(RuleIndexDefinition.FIELD_RULE_ALL_TAGS,queryString,10f));
  qb.should(this.termAnyQuery(RuleIndexDefinition.FIELD_RULE_ALL_TAGS,queryString,1f));
  return qb;
}
