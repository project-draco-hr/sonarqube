{
  Project project=new Project("key");
  Decorator metric1Decorator=new Metric1Decorator();
  BatchExtensionDictionnary batchExtDictionnary=newBatchDictionnary(withFormula1,metric1Decorator);
  Collection<Decorator> decorators=new DecoratorsSelector(batchExtDictionnary).select(project);
  Decorator firstDecorator=Iterables.get(decorators,0);
  Decorator secondDecorator=Iterables.get(decorators,1);
  assertThat(firstDecorator).isInstanceOf(Metric1Decorator.class);
  assertThat(secondDecorator).isInstanceOf(FormulaDecorator.class);
  FormulaDecorator formulaDecorator=(FormulaDecorator)secondDecorator;
  assertThat(formulaDecorator.dependsUponDecorators()).hasSize(1);
  assertThat(Iterables.get(formulaDecorator.dependsUponDecorators(),0)).isEqualTo(firstDecorator);
}
