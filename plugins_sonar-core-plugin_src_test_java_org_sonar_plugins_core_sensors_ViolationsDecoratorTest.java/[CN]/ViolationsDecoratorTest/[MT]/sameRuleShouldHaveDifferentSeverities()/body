{
  List<Violation> violations=Lists.newArrayList();
  violations.add(Violation.create(ruleA1,resource).setSeverity(RulePriority.CRITICAL));
  violations.add(Violation.create(ruleA1,resource).setSeverity(RulePriority.CRITICAL));
  violations.add(Violation.create(ruleA1,resource).setSeverity(RulePriority.MINOR));
  when(context.getViolations()).thenReturn(violations);
  decorator.decorate(resource,context);
  verify(context).saveMeasure(argThat(new IsRuleMeasure(CoreMetrics.CRITICAL_VIOLATIONS,ruleA1,2.0)));
  verify(context).saveMeasure(argThat(new IsRuleMeasure(CoreMetrics.MINOR_VIOLATIONS,ruleA1,1.0)));
}
