{
  List<Violation> violations=Lists.newArrayList();
  violations.add(Violation.create(ruleA1,resource).setSeverity(RulePriority.CRITICAL));
  violations.add(Violation.create(ruleA1,resource).setSeverity(RulePriority.CRITICAL));
  violations.add(Violation.create(ruleA2,resource).setSeverity(RulePriority.MAJOR));
  when(context.getViolations()).thenReturn(violations);
  decorator.decorate(resource,context);
  verify(context).saveMeasure(argThat(new IsRuleMeasure(CoreMetrics.CRITICAL_VIOLATIONS,ruleA1,2.0)));
  verify(context,never()).saveMeasure(argThat(new IsRuleMeasure(CoreMetrics.MAJOR_VIOLATIONS,ruleA1,0.0)));
  verify(context).saveMeasure(argThat(new IsRuleMeasure(CoreMetrics.MAJOR_VIOLATIONS,ruleA2,1.0)));
}
