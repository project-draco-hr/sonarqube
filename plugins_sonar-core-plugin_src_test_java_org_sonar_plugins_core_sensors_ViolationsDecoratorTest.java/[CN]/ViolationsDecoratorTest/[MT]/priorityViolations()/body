{
  when(resource.getScope()).thenReturn(Resource.SCOPE_SET);
  when(context.getViolations()).thenReturn(createViolations());
  when(context.getChildrenMeasures((MeasuresFilter)anyObject())).thenReturn(Collections.<Measure>emptyList());
  decorator.decorate(resource,context);
  verify(context).saveMeasure(argThat(new IsRuleMeasure(CoreMetrics.VIOLATIONS,null,null,RulePriority.BLOCKER,0.0)));
  verify(context).saveMeasure(argThat(new IsRuleMeasure(CoreMetrics.VIOLATIONS,null,null,RulePriority.CRITICAL,2.0)));
  verify(context).saveMeasure(argThat(new IsRuleMeasure(CoreMetrics.VIOLATIONS,null,null,RulePriority.MAJOR,1.0)));
  verify(context).saveMeasure(argThat(new IsRuleMeasure(CoreMetrics.VIOLATIONS,null,null,RulePriority.MINOR,1.0)));
  verify(context).saveMeasure(argThat(new IsRuleMeasure(CoreMetrics.VIOLATIONS,null,null,RulePriority.INFO,0.0)));
  verify(context).saveMeasure(argThat(new IsMeasure(CoreMetrics.BLOCKER_VIOLATIONS,0.0)));
  verify(context).saveMeasure(argThat(new IsMeasure(CoreMetrics.CRITICAL_VIOLATIONS,2.0)));
  verify(context).saveMeasure(argThat(new IsMeasure(CoreMetrics.MAJOR_VIOLATIONS,1.0)));
  verify(context).saveMeasure(argThat(new IsMeasure(CoreMetrics.MINOR_VIOLATIONS,1.0)));
  verify(context).saveMeasure(argThat(new IsMeasure(CoreMetrics.INFO_VIOLATIONS,0.0)));
}
