{
  if (platform != null) {
    throw new IllegalStateException("Already started");
  }
  tempDir=createTempDir();
  Properties properties=new Properties();
  properties.putAll(initialProps);
  properties.setProperty(CoreProperties.SONAR_HOME,tempDir.getAbsolutePath());
  properties.setProperty(DatabaseProperties.PROP_URL,"jdbc:h2:" + tempDir.getAbsolutePath() + "/h2");
  platform=new Platform();
  platform.init(properties);
  platform.addComponents(components);
  platform.doStart();
}
