{
  DbSession dbSession=myBatis.openSession(false);
  Connection connection=dbSession.getConnection();
  try {
    LOG.info("Truncate db tables");
    for (    String table : DatabaseVersion.TABLES) {
      try {
        connection.createStatement().execute("TRUNCATE TABLE " + table.toLowerCase());
        connection.commit();
      }
 catch (      Exception e) {
        throw new IllegalStateException("Fail to truncate db table " + table,e);
      }
    }
  }
  finally {
    dbSession.close();
  }
}
