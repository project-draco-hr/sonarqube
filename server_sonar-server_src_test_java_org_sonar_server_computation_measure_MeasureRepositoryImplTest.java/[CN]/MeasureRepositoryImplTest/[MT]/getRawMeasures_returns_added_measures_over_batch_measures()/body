{
  when(reportMetricValidator.validate(METRIC_KEY_1)).thenReturn(true);
  when(reportMetricValidator.validate(METRIC_KEY_2)).thenReturn(true);
  BatchReport.Measure batchMeasure1=BatchReport.Measure.newBuilder().setMetricKey(METRIC_KEY_1).setStringValue("some value").build();
  BatchReport.Measure batchMeasure2=BatchReport.Measure.newBuilder().setMetricKey(METRIC_KEY_2).setStringValue("some value").build();
  reportReader.putMeasures(FILE_COMPONENT.getReportAttributes().getRef(),ImmutableList.of(batchMeasure1,batchMeasure2));
  Measure addedMeasure=SOME_MEASURE;
  underTest.add(FILE_COMPONENT,metric1,addedMeasure);
  Measure addedMeasure2=Measure.newMeasureBuilder().forCharacteristic(SOME_CHARACTERISTIC.getId()).createNoValue();
  underTest.add(FILE_COMPONENT,metric1,addedMeasure2);
  SetMultimap<String,Measure> rawMeasures=underTest.getRawMeasures(FILE_COMPONENT);
  assertThat(rawMeasures.keySet()).hasSize(2);
  assertThat(rawMeasures.get(METRIC_KEY_1)).containsOnly(addedMeasure,addedMeasure2);
  assertThat(rawMeasures.get(METRIC_KEY_2)).containsOnly(Measure.newMeasureBuilder().create("some value"));
}
