{
  DependencyDto model=new DependencyDto();
  model.setProjectSnapshotId(projectResource.snapshotId());
  model.setUsage(dependency.getUsage());
  model.setWeight(dependency.getWeight());
  model.setFromComponentUuid(fromResource.resource().getUuid());
  model.setFromScope(fromResource.resource().getScope());
  model.setFromSnapshotId(fromResource.snapshotId());
  model.setToComponentUuid(toResource.resource().getUuid());
  model.setToScope(toResource.resource().getScope());
  model.setToSnapshotId(toResource.snapshotId());
  Dependency parentDependency=dependency.getParent();
  if (parentDependency != null) {
    if (parentDependency.getId() == null) {
      saveDependency(project,parentDependency);
    }
    model.setParentDependencyId(parentDependency.getId());
  }
  session.save(model);
  dependency.setId(model.getId());
}
