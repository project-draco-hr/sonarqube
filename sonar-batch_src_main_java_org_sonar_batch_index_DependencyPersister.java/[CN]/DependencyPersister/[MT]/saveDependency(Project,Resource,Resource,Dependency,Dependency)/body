{
  BatchResource fromResource=resourceCache.get(from);
  BatchResource toResource=resourceCache.get(to);
  BatchResource projectResource=resourceCache.get(project);
  DependencyDto model=new DependencyDto();
  model.setProjectSnapshotId(projectResource.snapshotId());
  model.setUsage(dependency.getUsage());
  model.setWeight(dependency.getWeight());
  model.setFromResourceId(fromResource.resource().getId());
  model.setFromScope(fromResource.resource().getScope());
  model.setFromSnapshotId(fromResource.snapshotId());
  model.setToResourceId(toResource.resource().getId());
  model.setToScope(toResource.resource().getScope());
  model.setToSnapshotId(toResource.snapshotId());
  if (parentDependency != null) {
    model.setParentDependencyId(parentDependency.getId());
  }
  session.save(model);
  dependency.setId(model.getId());
}
