{
  Filter filter=new KeepOneFilter(DateUtils.parseDate("2011-03-25"),DateUtils.parseDate("2011-08-25"),Calendar.MONTH,"month");
  List<PurgeableAnalysisDto> toDelete=filter.filter(Arrays.<PurgeableAnalysisDto>asList(DbCleanerTestUtils.createSnapshotWithDate(1L,"2011-05-01"),DbCleanerTestUtils.createSnapshotWithDate(2L,"2011-05-02").setLast(true),DbCleanerTestUtils.createSnapshotWithDate(3L,"2011-05-19").setHasEvents(true).setLast(false),DbCleanerTestUtils.createSnapshotWithDate(4L,"2011-05-23")));
  assertThat(toDelete).hasSize(2);
  List<Long> snapshotIds=snapshotIds(toDelete);
  assertThat(snapshotIds).contains(1L);
  assertThat(snapshotIds).contains(4L);
}
