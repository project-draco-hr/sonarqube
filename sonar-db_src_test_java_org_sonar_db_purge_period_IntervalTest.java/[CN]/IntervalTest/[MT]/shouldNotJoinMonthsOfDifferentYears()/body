{
  List<PurgeableAnalysisDto> snapshots=Arrays.asList(DbCleanerTestUtils.createSnapshotWithDate(1L,"2010-04-03"),DbCleanerTestUtils.createSnapshotWithDate(2L,"2011-04-13"));
  List<Interval> intervals=Interval.group(snapshots,DateUtils.parseDateTime("2010-01-01T00:00:00+0100"),DateUtils.parseDateTime("2011-12-31T00:00:00+0100"),Calendar.MONTH);
  assertThat(intervals.size()).isEqualTo(2);
  assertThat(intervals.get(0).count()).isEqualTo(1);
  assertThat(calendarField(intervals.get(0),Calendar.MONTH)).isEqualTo((Calendar.APRIL));
  assertThat(calendarField(intervals.get(0),Calendar.YEAR)).isEqualTo((2010));
  assertThat(intervals.get(1).count()).isEqualTo(1);
  assertThat(calendarField(intervals.get(1),Calendar.MONTH)).isEqualTo((Calendar.APRIL));
  assertThat(calendarField(intervals.get(1),Calendar.YEAR)).isEqualTo((2011));
}
