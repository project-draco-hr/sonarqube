{
  List<PurgeableSnapshotDto> snapshots=Arrays.asList(DbCleanerTestUtils.createSnapshotWithDate(1L,"2010-04-03"),DbCleanerTestUtils.createSnapshotWithDate(2L,"2011-04-13"));
  List<Interval> intervals=Interval.group(snapshots,DateUtils.parseDateTime("2010-01-01T00:00:00+0100"),DateUtils.parseDateTime("2011-12-31T00:00:00+0100"),Calendar.MONTH);
  assertThat(intervals.size(),is(2));
  assertThat(intervals.get(0).count(),is(1));
  assertThat(calendarField(intervals.get(0),Calendar.MONTH),is(Calendar.APRIL));
  assertThat(calendarField(intervals.get(0),Calendar.YEAR),is(2010));
  assertThat(intervals.get(1).count(),is(1));
  assertThat(calendarField(intervals.get(1),Calendar.MONTH),is(Calendar.APRIL));
  assertThat(calendarField(intervals.get(1),Calendar.YEAR),is(2011));
}
