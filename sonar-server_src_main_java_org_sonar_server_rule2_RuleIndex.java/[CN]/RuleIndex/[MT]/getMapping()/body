{
  XContentBuilder mapping=jsonBuilder().startObject().startObject(this.getType()).field("dynamic",true).startObject("properties");
  addMatchField(mapping,RuleField.KEY.key(),"string");
  addMatchField(mapping,RuleField.REPOSITORY.key(),"string");
  addMatchField(mapping,RuleField.SEVERITY.key(),"string");
  addMatchField(mapping,RuleField.STATUS.key(),"string");
  mapping.startObject(RuleField.NAME.key()).field("type","multi_field").startObject("fields").startObject(RuleField.NAME.key()).field("type","string").field("index","analyzed").endObject().startObject("search").field("type","string").field("index","analyzed").field("index_analyzer","rule_name").field("search_analyzer","standard").endObject().endObject().endObject();
  mapping.startObject("active").field("type","nested").field("dynamic",true).endObject();
  mapping.startObject("params").field("type","nested").field("dynamic",true).endObject();
  return mapping.endObject().endObject().endObject();
}
