{
  try {
    XContentBuilder mapping=jsonBuilder().startObject().startObject(this.getType()).field("dynamic",true).startObject("properties");
    addMatchField(mapping,RuleField.KEY.key(),"string");
    addMatchField(mapping,RuleField.REPOSITORY.key(),"string");
    addMatchField(mapping,RuleField.SEVERITY.key(),"string");
    mapping.startObject("active").field("type","nested").field("dynamic",true).endObject();
    return mapping.endObject().endObject().endObject();
  }
 catch (  IOException e) {
    LOG.error("Could not create mapping for {}",this.getIndexName());
    return null;
  }
}
