{
  String snapshotSource=snapshotSourceDao.selectSnapshotSource(snapshotId);
  Collection<SnapshotDataDto> snapshotDataEntries=snapshotDataDao.selectSnapshotData(snapshotId);
  if (snapshotSource != null && snapshotDataEntries != null) {
    DecorationDataHolder decorationDataHolder=new DecorationDataHolder();
    for (    SnapshotDataDto snapshotDataEntry : snapshotDataEntries) {
      if (snapshotDataEntry.isSyntaxHighlightingData()) {
        decorationDataHolder.loadSyntaxHighlightingData(snapshotDataEntry.getData());
      }
 else       if (snapshotDataEntry.isSymbolData()) {
        decorationDataHolder.loadSymbolReferences(snapshotDataEntry.getData());
      }
    }
    HtmlTextDecorator textDecorator=new HtmlTextDecorator();
    return textDecorator.decorateTextWithHtml(snapshotSource,decorationDataHolder);
  }
  return null;
}
