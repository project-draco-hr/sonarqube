{
  SqlSession session=mybatis.openSession();
  DashboardMapper dashboardMapper=session.getMapper(DashboardMapper.class);
  WidgetMapper widgetMapper=session.getMapper(WidgetMapper.class);
  WidgetPropertyMapper widgetPropertyMapper=session.getMapper(WidgetPropertyMapper.class);
  try {
    dashboardMapper.insert(dashboard);
    for (    Widget widget : dashboard.getWidgets()) {
      widget.setDashboardId(dashboard.getId());
      widgetMapper.insert(widget);
      for (      WidgetProperty widgetProperty : widget.getWidgetProperties()) {
        widgetProperty.setWidgetId(widget.getId());
        widgetPropertyMapper.insert(widgetProperty);
      }
    }
    session.commit();
  }
  finally {
    session.close();
  }
}
