{
  int resourceSnapshotId=getSnapshotIdFor(resource);
  List<DuplicationUnitDto> units=Lists.newArrayList();
  for (  Block block : blocks) {
    DuplicationUnitDto unit=new DuplicationUnitDto(currentProjectSnapshotId,resourceSnapshotId,block.getBlockHash().toString(),block.getIndexInFile(),block.getStartLine(),block.getEndLine());
    units.add(unit);
  }
  dao.insert(units);
}
