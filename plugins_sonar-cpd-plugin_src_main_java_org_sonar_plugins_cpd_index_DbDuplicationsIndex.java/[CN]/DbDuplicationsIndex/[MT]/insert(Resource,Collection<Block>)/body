{
  int resourceSnapshotId=getSnapshotIdFor(resource);
  List<DuplicationUnit> units=Lists.newArrayList();
  for (  Block block : blocks) {
    DuplicationUnit unit=new DuplicationUnit(currentProjectSnapshotId,resourceSnapshotId,block.getBlockHash().toString(),block.getIndexInFile(),block.getFirstLineNumber(),block.getLastLineNumber());
    units.add(unit);
  }
  dao.insert(units);
}
