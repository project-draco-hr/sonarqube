{
  String mainFileUuid="MAIN-FILE-UUID";
  MockUserSession.set().addProjectUuidPermissions(UserRole.CODEVIEWER,TestFile1.PROJECT_UUID);
  dbClient.componentDao().insert(dbSession,new ComponentDto().setUuid(TestFile1.FILE_UUID).setLongName(TestFile1.LONG_NAME).setKey(TestFile1.KEY).setProjectUuid(TestFile1.PROJECT_UUID),new ComponentDto().setUuid(TestFile2.FILE_UUID).setLongName(TestFile2.LONG_NAME).setProjectUuid(TestFile2.PROJECT_UUID).setKey(TestFile2.KEY),new ComponentDto().setUuid(mainFileUuid).setProjectUuid(TestFile1.PROJECT_UUID));
  dbSession.commit();
  es.putDocuments(TestIndexDefinition.INDEX,TestIndexDefinition.TYPE,new TestDoc().setUuid(TestFile1.UUID).setName(TestFile1.NAME).setFileUuid(TestFile1.FILE_UUID).setDurationInMs(TestFile1.DURATION_IN_MS).setStatus(TestFile1.STATUS).setMessage(TestFile1.MESSAGE).setCoveredFiles(TestFile1.COVERED_FILES).setStackTrace(TestFile1.STACKTRACE),new TestDoc().setUuid(TestFile2.UUID).setName(TestFile2.NAME).setFileUuid(TestFile2.FILE_UUID).setDurationInMs(TestFile2.DURATION_IN_MS).setStatus(TestFile2.STATUS).setStackTrace(TestFile2.STATUS).setMessage(TestFile2.MESSAGE).setCoveredFiles(TestFile2.COVERED_FILES).setStackTrace(TestFile2.STACKTRACE));
  WsTester.TestRequest request=ws.newGetRequest("api/tests","list").setParam(TestsListAction.SOURCE_FILE_UUID,mainFileUuid).setParam(TestsListAction.SOURCE_FILE_LINE_NUMBER,"10");
  request.execute().assertJson(getClass(),"list-main-file.json");
}
