{
  int count=0;
  Collection<File> files=FileUtils.listFiles(sourceDir,FILE_FILTER,DIR_FILTER);
  for (  File file : files) {
    InputFile input=newInputFile(fileSystem,sourceDir,type,file);
    if (accept(input)) {
      cache.put(fileSystem.moduleKey(),input);
      count++;
    }
  }
  return count;
}
