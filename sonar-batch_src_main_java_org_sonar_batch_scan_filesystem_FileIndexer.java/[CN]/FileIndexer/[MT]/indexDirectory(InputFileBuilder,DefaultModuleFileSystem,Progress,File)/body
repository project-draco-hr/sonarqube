{
  Collection<File> files=FileUtils.listFiles(dirToIndex,FILE_FILTER,DIR_FILTER);
  for (  File sourceFile : files) {
    String path=pathResolver.relativePath(fileSystem.baseDir(),sourceFile);
    if (path == null) {
      LoggerFactory.getLogger(getClass()).warn(String.format(FILE_IS_NOT_DECLARED_IN_MODULE_BASEDIR,sourceFile.getAbsoluteFile(),fileSystem.baseDir()));
    }
 else {
      if (exclusionFilters.accept(sourceFile,path,InputFile.Type.MAIN)) {
        indexFile(inputFileBuilder,fileSystem,status,sourceFile,path,InputFile.Type.MAIN);
      }
      if (exclusionFilters.accept(sourceFile,path,InputFile.Type.TEST)) {
        indexFile(inputFileBuilder,fileSystem,status,sourceFile,path,InputFile.Type.TEST);
      }
    }
  }
}
