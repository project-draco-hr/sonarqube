{
  Callable<Void> task=new Callable<Void>(){
    @Override public Void call() throws Exception {
      InputFile completedFile=inputFileBuilder.complete(inputFile,type);
      if (completedFile != null && accept(completedFile)) {
        status.markAsIndexed(inputFile);
        File parentDir=inputFile.file().getParentFile();
        String relativePath=new PathResolver().relativePath(fs.baseDir(),parentDir);
        if (relativePath != null) {
          DefaultInputDir inputDir=new DefaultInputDir(relativePath);
          inputDir.setFile(parentDir);
          inputDir.setKey(new StringBuilder().append(fs.moduleKey()).append(":").append(inputDir.relativePath()).toString());
          status.markAsIndexed(inputDir);
        }
      }
      return null;
    }
  }
;
  status.planForIndexing(task);
}
