{
  String baseName=prefix + System.currentTimeMillis() + "-";
  for (int counter=0; counter < TEMP_DIR_ATTEMPTS; counter++) {
    File tempDir=new File(baseDir,baseName + counter);
    if (tempDir.mkdirs()) {
      return tempDir;
    }
  }
  throw new IllegalStateException(MessageFormat.format("Failed to create directory within {0} attempts (tried {1} to {2})",TEMP_DIR_ATTEMPTS,baseName + 0,baseName + (TEMP_DIR_ATTEMPTS - 1)));
}
