{
  settings.setProperty(CoreProperties.CORE_IMPORT_SOURCES_PROPERTY,"true");
  File javaFile1=new File(baseDir,"src/main/java/foo/bar/Foo.java");
  FileUtils.write(javaFile1,"\uFEFFpublic class Test",Charsets.UTF_8);
  when(fs.inputFiles(FileQuery.all())).thenReturn((Iterable)Arrays.asList(new InputFileBuilder(javaFile1,Charset.forName("UTF-8"),"src/main/java/foo/bar/Foo.java").attribute(InputFile.ATTRIBUTE_SOURCE_RELATIVE_PATH,"foo/bar/Foo.java").attribute(InputFile.ATTRIBUTE_LANGUAGE,"java").build()));
  when(project.getLanguageKey()).thenReturn(Java.KEY);
  Languages languages=new Languages(Java.INSTANCE);
  ComponentIndexer indexer=new ComponentIndexer(project,languages,sonarIndex,settings,mock(ResourceKeyMigration.class),new DefaultModuleLanguages(settings,languages),mock(ResourceDao.class));
  indexer.execute(fs);
  Resource sonarFile=JavaFile.create("src/main/java/foo/bar/Foo.java","foo/bar/Foo.java",false);
  verify(sonarIndex).setSource(eq(sonarFile),argThat(new ArgumentMatcher<String>(){
    @Override public boolean matches(    Object arg0){
      String source=(String)arg0;
      return !source.contains("\uFEFF");
    }
  }
));
}
