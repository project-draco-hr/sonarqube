{
  db.truncateTables();
  PermissionTemplateDto permissionTemplateDto=new PermissionTemplateDto().setName("Test template").setKee("test_template");
  PermissionTemplateDto templateWithPermissions=new PermissionTemplateDto().setKee("test_template");
  underTest=mock(PermissionTemplateDao.class);
  when(underTest.selectByKey(db.getSession(),"test_template")).thenReturn(permissionTemplateDto);
  when(underTest.selectPermissionTemplate(db.getSession(),"test_template")).thenReturn(templateWithPermissions);
  when(underTest.selectPermissionTemplateWithPermissions(db.getSession(),"test_template")).thenCallRealMethod();
  PermissionTemplateDto permissionTemplate=underTest.selectPermissionTemplateWithPermissions(db.getSession(),"test_template");
  assertThat(permissionTemplate).isSameAs(templateWithPermissions);
}
