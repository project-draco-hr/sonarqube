{
  RulesProfile profile=getSession().getEntity(RulesProfile.class,profileId);
  if (profile != null && !profile.getProvided() && getChildren(profile).isEmpty()) {
    String hqlDeleteRc="DELETE " + ActiveRuleChange.class.getSimpleName() + " rc WHERE rc.rulesProfile=:rulesProfile";
    getSession().createQuery(hqlDeleteRc).setParameter("rulesProfile",profile).executeUpdate();
    String hql="UPDATE " + ResourceModel.class.getSimpleName() + " o SET o.rulesProfile=null WHERE o.rulesProfile=:rulesProfile";
    getSession().createQuery(hql).setParameter("rulesProfile",profile).executeUpdate();
    getSession().remove(profile);
    getSession().commit();
  }
}
