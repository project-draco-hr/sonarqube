{
  RulesProfile profile=getSession().getSingleResult(RulesProfile.class,"id",profileId);
  if (profile != null && !profile.getProvided()) {
    String hql="UPDATE " + RulesProfile.class.getSimpleName() + " o SET o.parentName=:newName  WHERE o.parentName=:oldName";
    getSession().getEntityManager().createQuery(hql).setParameter("oldName",profile.getName()).setParameter("newName",newProfileName).executeUpdate();
    profile.setName(newProfileName);
    getSession().save(profile);
    getSession().commit();
  }
}
