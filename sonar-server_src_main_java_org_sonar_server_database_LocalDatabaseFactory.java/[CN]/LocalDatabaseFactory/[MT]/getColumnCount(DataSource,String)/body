{
  Connection connection=null;
  ResultSet metaData=null;
  try {
    connection=dataSource.getConnection();
    metaData=connection.getMetaData().getColumns(null,null,table,null);
    int nbColumns=0;
    while (metaData.next()) {
      nbColumns++;
    }
    return nbColumns;
  }
  finally {
    closeQuietly(metaData);
    closeQuietly(connection);
  }
}
