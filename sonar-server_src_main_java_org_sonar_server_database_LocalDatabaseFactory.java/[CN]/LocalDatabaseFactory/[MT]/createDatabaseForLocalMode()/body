{
  String name="/tmp/" + System.nanoTime();
  DataSource source=database.getDataSource();
  BasicDataSource destination=dataSource(H2_DRIVER,H2_USER,H2_PASSWORD,H2_URL + name);
  create(destination,H2_DIALECT);
  copyTable(source,destination,"PROPERTIES","SELECT * FROM PROPERTIES WHERE (USER_ID IS NULL) AND (RESOURCE_ID IS NULL)");
  copyTable(source,destination,"RULES_PROFILES","SELECT * FROM RULES_PROFILES");
  copyTable(source,destination,"RULES","SELECT * FROM RULES");
  copyTable(source,destination,"RULES_PARAMETERS","SELECT * FROM RULES_PARAMETERS");
  copyTable(source,destination,"ACTIVE_RULES","SELECT * FROM ACTIVE_RULES");
  copyTable(source,destination,"ACTIVE_RULE_PARAMETERS","SELECT * FROM ACTIVE_RULE_PARAMETERS");
  copyTable(source,destination,"METRICS","SELECT * FROM METRICS");
  destination.close();
  return new File(name + ".h2.db").getAbsolutePath();
}
