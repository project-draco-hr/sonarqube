{
  LOG.info("Copy table " + table);
  int colCount=getColumnCount(source,table);
  truncate(dest,table);
  Connection sourceConnection=null;
  Statement sourceStatement=null;
  ResultSet sourceResultSet=null;
  Connection destConnection=null;
  ResultSet destResultSet=null;
  try {
    sourceConnection=source.getConnection();
    sourceStatement=sourceConnection.createStatement();
    sourceResultSet=sourceStatement.executeQuery(query);
    destConnection=dest.getConnection();
    destConnection.setAutoCommit(false);
    PreparedStatement destStatement=destConnection.prepareStatement("INSERT INTO " + table + " VALUES("+ StringUtils.repeat("?",",",colCount)+ ")");
    while (sourceResultSet.next()) {
      for (int col=1; col <= colCount; col++) {
        Object value=sourceResultSet.getObject(col);
        destStatement.setObject(col,value);
      }
      destStatement.addBatch();
    }
    destStatement.executeBatch();
    destConnection.commit();
    destStatement.close();
  }
  finally {
    closeQuietly(destResultSet);
    closeQuietly(destConnection);
    closeQuietly(sourceResultSet);
    closeQuietly(sourceStatement);
    closeQuietly(sourceConnection);
  }
}
