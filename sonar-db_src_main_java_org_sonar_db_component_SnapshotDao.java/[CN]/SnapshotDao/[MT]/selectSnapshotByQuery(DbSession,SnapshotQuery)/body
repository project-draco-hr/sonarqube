{
  List<SnapshotDto> snapshotDtos=mapper(session).selectSnapshotsByQuery(query);
  if (snapshotDtos.isEmpty()) {
    return null;
  }
  checkState(snapshotDtos.size() == 1,"Expected one snapshot to be returned, got %s",snapshotDtos.size());
  return snapshotDtos.get(0);
}
