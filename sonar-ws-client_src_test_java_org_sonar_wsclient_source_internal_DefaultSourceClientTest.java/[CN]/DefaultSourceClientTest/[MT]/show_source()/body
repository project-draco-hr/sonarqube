{
  HttpRequestFactory requestFactory=new HttpRequestFactory(httpServer.url());
  httpServer.stubResponseBody(Resources.toString(Resources.getResource(this.getClass(),"DefaultSourceClientTest/show_source.json"),Charsets.UTF_8));
  SourceClient client=new DefaultSourceClient(requestFactory);
  List<Source> sources=client.show(SourceShowQuery.create().setKey("MyFile").setFrom("20").setTo("25"));
  assertThat(httpServer.requestedPath()).isEqualTo("/api/sources/show?key=MyFile&from=20&to=25");
  assertThat(sources).hasSize(6);
  assertThat(sources.get(0).lineIndex()).isEqualTo(20);
  assertThat(sources.get(0).lineAsHtml()).isEqualTo("<span class=\"k\">package </span>org.sonar.check;");
}
