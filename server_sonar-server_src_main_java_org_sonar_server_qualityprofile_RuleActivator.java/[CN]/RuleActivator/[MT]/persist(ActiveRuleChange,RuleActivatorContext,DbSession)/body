{
  ActiveRuleDto activeRule=null;
  if (change.getType() == ActiveRuleChange.Type.ACTIVATED) {
    activeRule=doInsert(change,context,dbSession);
  }
 else   if (change.getType() == ActiveRuleChange.Type.DEACTIVATED) {
    ActiveRuleDao dao=db.activeRuleDao();
    dao.deleteByKey(dbSession,change.getKey());
  }
 else   if (change.getType() == ActiveRuleChange.Type.UPDATED) {
    activeRule=doUpdate(change,context,dbSession);
  }
  log.write(dbSession,Activity.Type.QPROFILE,change);
  return activeRule;
}
