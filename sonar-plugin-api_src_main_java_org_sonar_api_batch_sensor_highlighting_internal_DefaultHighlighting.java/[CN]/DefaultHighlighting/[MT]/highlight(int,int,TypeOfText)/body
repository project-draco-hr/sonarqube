{
  Preconditions.checkState(inputFile != null,"Call onFile() first");
  int maxValidOffset=((DefaultInputFile)inputFile).lastValidOffset();
  checkOffset(startOffset,maxValidOffset,"startOffset");
  checkOffset(endOffset,maxValidOffset,"endOffset");
  Preconditions.checkArgument(startOffset < endOffset,"startOffset (" + startOffset + ") should be < endOffset ("+ endOffset+ ") for file "+ inputFile+ ".");
  SyntaxHighlightingRule syntaxHighlightingRule=SyntaxHighlightingRule.create(startOffset,endOffset,typeOfText);
  this.syntaxHighlightingRuleSet.add(syntaxHighlightingRule);
  return this;
}
