{
  checkPermission();
  DbSession session=dbClient.openSession(false);
  try {
    List<RuleDebt> rules=newArrayList();
    for (    RuleDto rule : dbClient.ruleDao().selectEnabled(session)) {
      if (languageKey != null && !languageKey.equals(rule.getLanguage())) {
        continue;
      }
      RuleDebt ruleDebt=toRuleDebt(rule);
      if (ruleDebt != null) {
        rules.add(ruleDebt);
      }
    }
    return debtModelXMLExporter.export(rules);
  }
  finally {
    MyBatis.closeQuietly(session);
  }
}
