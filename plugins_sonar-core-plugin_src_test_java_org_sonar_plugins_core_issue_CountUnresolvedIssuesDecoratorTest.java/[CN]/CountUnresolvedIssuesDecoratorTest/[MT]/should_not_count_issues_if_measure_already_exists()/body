{
  when(resource.getScope()).thenReturn(Scopes.PROJECT);
  when(issuable.unresolvedIssues()).thenReturn(createIssues());
  when(context.getChildrenMeasures(any(MeasuresFilter.class))).thenReturn(Collections.<Measure>emptyList());
  when(context.getMeasure(CoreMetrics.VIOLATIONS)).thenReturn(new Measure(CoreMetrics.VIOLATIONS,3000.0));
  when(context.getMeasure(CoreMetrics.MAJOR_VIOLATIONS)).thenReturn(new Measure(CoreMetrics.MAJOR_VIOLATIONS,500.0));
  decorator.decorate(resource,context);
  verify(context,never()).saveMeasure(eq(CoreMetrics.VIOLATIONS),anyDouble());
  verify(context,never()).saveMeasure(eq(CoreMetrics.MAJOR_VIOLATIONS),anyDouble());
  verify(context,times(1)).saveMeasure(eq(CoreMetrics.CRITICAL_VIOLATIONS),anyDouble());
}
