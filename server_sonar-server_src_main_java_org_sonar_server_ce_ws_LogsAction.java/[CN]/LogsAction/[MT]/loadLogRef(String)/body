{
  DbSession dbSession=dbClient.openSession(false);
  try {
    Optional<CeQueueDto> queueDto=dbClient.ceQueueDao().selectByUuid(dbSession,taskUuid);
    if (queueDto.isPresent()) {
      return new LogFileRefComponentUuidTuple(LogFileRef.from(queueDto.get()),queueDto.get().getComponentUuid());
    }
    Optional<CeActivityDto> activityDto=dbClient.ceActivityDao().selectByUuid(dbSession,taskUuid);
    if (activityDto.isPresent()) {
      return new LogFileRefComponentUuidTuple(LogFileRef.from(activityDto.get()),activityDto.get().getComponentUuid());
    }
    throw new NotFoundException(format("Task %s not found",taskUuid));
  }
  finally {
    dbClient.closeSession(dbSession);
  }
}
