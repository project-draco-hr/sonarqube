{
  setUserAsSystemAdmin();
  ComponentDto module=componentDb.insertComponent(newModuleDto(project));
  ComponentDto subModule=componentDb.insertComponent(newModuleDto(module));
  propertyDefinitions.addComponents(asList(PropertyDefinition.builder("foo").defaultValue("default").build()));
  propertyDb.insertProperties(newGlobalPropertyDto().setKey("foo").setValue("global"),newComponentPropertyDto(project).setKey("foo").setValue("project"),newComponentPropertyDto(module).setKey("foo").setValue("module"));
  assertParentValue(executeRequestForComponentProperties(subModule,"foo").getSettings(0),"module");
  assertParentValue(executeRequestForComponentProperties(module,"foo").getSettings(0),"project");
  assertParentValue(executeRequestForComponentProperties(project,"foo").getSettings(0),"global");
  assertParentValue(executeRequestForGlobalProperties("foo").getSettings(0),"default");
}
