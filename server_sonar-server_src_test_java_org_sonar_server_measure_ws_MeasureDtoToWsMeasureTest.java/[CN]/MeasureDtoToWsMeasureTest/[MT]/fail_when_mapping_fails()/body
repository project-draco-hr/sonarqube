{
  MetricDto metric=spy(newMetricDto().setKey("metric-key"));
  when(metric.getValueType()).thenThrow(NullPointerException.class);
  expectedException.expect(IllegalStateException.class);
  expectedException.expectMessage("Error while mapping a measure of metric key 'metric-key' and parameters ");
  MeasureDtoToWsMeasure.measureDtoToWsMeasure(metric,newMeasureDto(metric,1L).setValue(5.5d).setData("data"));
}
