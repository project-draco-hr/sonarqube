{
  DbSession session=mybatis.openSession(true);
  try {
    for (    BatchResource batchResource : resourceCache.all()) {
      String componentKey=batchResource.resource().getEffectiveKey();
      String fileHashesdata=data.getStringData(componentKey,SnapshotDataTypes.FILE_HASHES);
      if (fileHashesdata != null) {
        SnapshotDataDto dto=new SnapshotDataDto();
        dto.setSnapshotId(batchResource.snapshotId());
        dto.setResourceId(batchResource.resource().getId());
        dto.setDataType(SnapshotDataTypes.FILE_HASHES);
        dto.setData(fileHashesdata);
        dao.insert(session,dto);
      }
    }
    session.commit();
  }
  finally {
    MyBatis.closeQuietly(session);
  }
}
