{
  XContentBuilder document=XContentFactory.jsonBuilder().startObject().field(ActiveRuleDocument.FIELD_ID,rule.getId()).field(ActiveRuleDocument.FIELD_SEVERITY,rule.getSeverity()).field(ActiveRuleDocument.FIELD_PROFILE_ID,rule.getRulesProfile().getId()).field(ActiveRuleDocument.FIELD_INHERITANCE,rule.getInheritance());
  if (rule.getNoteData() != null || rule.getNoteUserLogin() != null) {
    document.startObject(RuleDocument.FIELD_NOTE).field(ActiveRuleDocument.FIELD_NOTE_DATA,rule.getNoteData()).field(ActiveRuleDocument.FIELD_NOTE_USER_LOGIN,rule.getNoteUserLogin()).field(ActiveRuleDocument.FIELD_NOTE_CREATED_AT,rule.getNoteCreatedAt()).field(ActiveRuleDocument.FIELD_NOTE_UPDATED_AT,rule.getNoteUpdatedAt()).endObject();
  }
  if (!rule.getActiveRuleParams().isEmpty()) {
    document.startArray(ActiveRuleDocument.FIELD_PARAMS);
    for (    ActiveRuleParam param : rule.getActiveRuleParams()) {
      document.startObject().field(ActiveRuleDocument.FIELD_PARAM_KEY,param.getKey()).field(ActiveRuleDocument.FIELD_PARAM_VALUE,param.getValue()).endObject();
    }
    document.endArray();
  }
  document.endObject();
  return document;
}
