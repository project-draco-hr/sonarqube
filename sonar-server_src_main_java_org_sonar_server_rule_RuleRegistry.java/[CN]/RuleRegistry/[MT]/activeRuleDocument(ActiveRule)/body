{
  XContentBuilder document=XContentFactory.jsonBuilder().startObject().field(ActiveRuleDocument.FIELD_ID,rule.getId()).field(ActiveRuleDocument.FIELD_SEVERITY,rule.getSeverity()).field(ActiveRuleDocument.FIELD_PROFILE_ID,rule.getRulesProfile().getId()).field(ActiveRuleDocument.FIELD_INHERITANCE,rule.getInheritance());
  if (!rule.getActiveRuleParams().isEmpty()) {
    document.startArray(ActiveRuleDocument.FIELD_PARAMS);
    for (    ActiveRuleParam param : rule.getActiveRuleParams()) {
      document.startObject().field(ActiveRuleDocument.FIELD_PARAM_KEY,param.getKey()).field(ActiveRuleDocument.FIELD_PARAM_VALUE,param.getValue()).endObject();
    }
    document.endArray();
  }
  document.endObject();
  return document;
}
