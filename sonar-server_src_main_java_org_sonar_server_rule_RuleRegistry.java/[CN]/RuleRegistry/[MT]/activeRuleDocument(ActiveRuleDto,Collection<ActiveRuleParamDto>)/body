{
  XContentBuilder document=XContentFactory.jsonBuilder().startObject().field(ActiveRuleDocument.FIELD_ID,activeRule.getId()).field(ActiveRuleDocument.FIELD_ACTIVE_RULE_PARENT_ID,activeRule.getParentId()).field(ActiveRuleDocument.FIELD_SEVERITY,getSeverityFromOrdinal(activeRule.getSeverity())).field(ActiveRuleDocument.FIELD_PROFILE_ID,activeRule.getProfileId()).field(ActiveRuleDocument.FIELD_INHERITANCE,activeRule.getInheritance());
  if (activeRule.getNoteData() != null || activeRule.getNoteUserLogin() != null) {
    document.startObject(RuleDocument.FIELD_NOTE).field(ActiveRuleDocument.FIELD_NOTE_DATA,activeRule.getNoteData()).field(ActiveRuleDocument.FIELD_NOTE_USER_LOGIN,activeRule.getNoteUserLogin()).field(ActiveRuleDocument.FIELD_NOTE_CREATED_AT,activeRule.getNoteCreatedAt()).field(ActiveRuleDocument.FIELD_NOTE_UPDATED_AT,activeRule.getNoteUpdatedAt()).endObject();
  }
  if (!params.isEmpty()) {
    document.startArray(ActiveRuleDocument.FIELD_PARAMS);
    for (    ActiveRuleParamDto param : params) {
      document.startObject().field(ActiveRuleDocument.FIELD_PARAM_KEY,param.getKey()).field(ActiveRuleDocument.FIELD_PARAM_VALUE,param.getValue()).endObject();
    }
    document.endArray();
  }
  document.endObject();
  return document;
}
