{
  XContentBuilder document=XContentFactory.jsonBuilder().startObject().field(ActiveRuleDocument.FIELD_ID,activeRule.getId()).field(ActiveRuleDocument.FIELD_SEVERITY,Severity.get(activeRule.getSeverity())).field(ActiveRuleDocument.FIELD_PROFILE_ID,activeRule.getProfileId()).field(ActiveRuleDocument.FIELD_INHERITANCE,activeRule.getInheritance());
  if (!params.isEmpty()) {
    document.startArray(ActiveRuleDocument.FIELD_PARAMS);
    for (    ActiveRuleParamDto param : params) {
      document.startObject().field(ActiveRuleDocument.FIELD_PARAM_KEY,param.getKey()).field(ActiveRuleDocument.FIELD_PARAM_VALUE,param.getValue()).endObject();
    }
    document.endArray();
  }
  document.endObject();
  return document;
}
