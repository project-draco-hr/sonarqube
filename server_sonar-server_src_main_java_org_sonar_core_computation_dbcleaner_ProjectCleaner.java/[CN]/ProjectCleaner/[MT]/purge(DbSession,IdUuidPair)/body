{
  long start=System.currentTimeMillis();
  profiler.reset();
  Settings settings=projectSettingsFactory.newProjectSettings(session,idUuidPair.getId());
  PurgeConfiguration configuration=newDefaultPurgeConfiguration(settings,idUuidPair);
  cleanHistoricalData(session,configuration.rootProjectIdUuid().getId(),settings);
  doPurge(session,configuration);
  deleteIndexedIssuesBefore(idUuidPair.getUuid(),configuration.maxLiveDateOfClosedIssues());
  session.commit();
  logProfiling(start,settings);
  return this;
}
