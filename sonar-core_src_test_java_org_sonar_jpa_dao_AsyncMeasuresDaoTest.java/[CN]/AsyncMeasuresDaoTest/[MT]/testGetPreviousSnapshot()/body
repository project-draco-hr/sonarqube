{
  setupData("sharedFixture","testGetPreviousSnapshot");
  AsyncMeasuresDao asyncMeasuresDao=new AsyncMeasuresDao(getSession());
  Snapshot s=new Snapshot();
  s.setCreatedAt(stringToDate("2008-12-04 08:00:00.00"));
  s.setScope(ResourceModel.SCOPE_PROJECT);
  ResourceModel resource1=getSession().getEntity(ResourceModel.class,1);
  ResourceModel resource2=getSession().getEntity(ResourceModel.class,2);
  s.setResource(resource1);
  assertThat(asyncMeasuresDao.getPreviousSnapshot(s).getId(),is(1));
  s.setResource(resource2);
  assertThat(asyncMeasuresDao.getPreviousSnapshot(s).getId(),is(5));
}
