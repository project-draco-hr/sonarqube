{
  periodsHolder.setPeriods(PERIOD);
  DefaultIssue fileIssue=newCodeSmellIssue(10);
  DefaultIssue projectIssue=newCodeSmellIssue(30);
  when(calculator.calculate(same(fileIssue),anyList(),same(PERIOD))).thenReturn(4L);
  underTest.beforeComponent(FILE);
  underTest.onIssue(FILE,fileIssue);
  underTest.afterComponent(FILE);
  underTest.beforeComponent(PROJECT);
  underTest.onIssue(PROJECT,projectIssue);
  underTest.afterComponent(PROJECT);
  Measure newMeasure=newMaintainabilityEffortMeasure(PROJECT).get();
  assertThat(newMeasure.getVariations().getVariation(PERIOD.getIndex())).isEqualTo(4);
  assertThat(newMeasure.getVariations().hasVariation(PERIOD.getIndex() + 1)).isFalse();
}
