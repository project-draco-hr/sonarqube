{
  final SqlSession sqlSession=mybatis.openSession();
  try {
    ResourceIndexerMapper mapper=sqlSession.getMapper(ResourceIndexerMapper.class);
    List<List<Integer>> partitionsOfResourceIds=Lists.partition(resourceIds,DatabaseUtils.MAX_IN_ELEMENTS);
    for (    List<Integer> partitionOfResourceIds : partitionsOfResourceIds) {
      if (!partitionOfResourceIds.isEmpty()) {
        mapper.deleteByResourceIds(partitionOfResourceIds);
      }
    }
    sqlSession.commit();
  }
  finally {
    sqlSession.close();
  }
  return this;
}
