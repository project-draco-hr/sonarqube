{
  Project depProject=new Project(dependency.key(),project.getBranch(),dependency.key());
  Resource result=context.getResource(depProject);
  if (result == null || !((Project)result).getAnalysisVersion().equals(dependency.version())) {
    Library lib=new Library(dependency.key(),dependency.version());
    index.addResource(lib);
    resourcePersister.persist();
    result=context.getResource(lib);
  }
  return result;
}
