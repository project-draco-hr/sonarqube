{
  when(moduleQProfiles.findByLanguage("java")).thenReturn(JAVA_PROFILE);
  when(moduleQProfiles.findByLanguage("php")).thenReturn(PHP_PROFILE);
  when(moduleQProfiles.findByLanguage("abap")).thenReturn(null);
  fs.addLanguages("java","php");
  QProfileSensor sensor=new QProfileSensor(moduleQProfiles,fs,mock(AnalysisMode.class));
  assertThat(sensor.shouldExecuteOnProject(project)).isTrue();
  sensor.analyse(project,sensorContext);
  verify(sensorContext).saveMeasure(argThat(new IsMeasure(CoreMetrics.QUALITY_PROFILES,"[{\"key\":\"java-two\",\"language\":\"java\",\"name\":\"Java Two\",\"rulesUpdatedAt\":\"2014-01-15T12:00:00+0000\"}," + "{\"key\":\"php-one\",\"language\":\"php\",\"name\":\"Php One\",\"rulesUpdatedAt\":\"2014-01-15T12:00:00+0000\"}]")));
}
