{
  setupData("shared");
  QualityProfileDao dao=new QualityProfileDao(getMyBatis());
  when(moduleQProfiles.findByLanguage("java")).thenReturn(new QProfileWithId(2,"Java Two","java",20));
  when(moduleQProfiles.findByLanguage("php")).thenReturn(new QProfileWithId(3,"Php One","php",30));
  when(moduleQProfiles.findByLanguage("abap")).thenReturn(null);
  fs.addLanguages("java","php","abap");
  QProfileSensor sensor=new QProfileSensor(moduleQProfiles,fs,dao);
  assertThat(sensor.shouldExecuteOnProject(project)).isTrue();
  sensor.analyse(project,sensorContext);
  checkTable("mark_profiles_as_used","rules_profiles");
}
