{
  List<MavenProject> sortedProjects=session.getSortedProjects();
  MavenProject topLevelProject=null;
  for (  MavenProject project : sortedProjects) {
    if (project.isExecutionRoot()) {
      topLevelProject=project;
      break;
    }
  }
  if (topLevelProject != null && sortedProjects != null) {
    return new ProjectReactor(mavenProjectConverter.configure(sortedProjects,topLevelProject));
  }
 else {
    throw new IllegalStateException("Maven session is not in a good state. No top level project or empty reactor.");
  }
}
