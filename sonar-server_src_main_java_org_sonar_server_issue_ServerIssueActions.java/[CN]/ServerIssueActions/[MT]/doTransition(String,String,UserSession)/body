{
  IssueDto dto=loadDto(issueKey,userSession);
  DefaultIssue issue=dto.toDefaultIssue();
  IssueChangeContext context=IssueChangeContext.createUser(new Date(),userSession.login());
  if (workflow.doTransition(issue,transition,context)) {
    issueDao.update(Arrays.asList(IssueDto.toDto(issue,dto.getResourceId(),dto.getRuleId())));
  }
  return issue;
}
