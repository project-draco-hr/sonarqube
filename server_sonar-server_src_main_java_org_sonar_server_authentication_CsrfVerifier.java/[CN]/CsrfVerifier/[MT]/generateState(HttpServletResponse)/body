{
  String state=new BigInteger(130,new SecureRandom()).toString(32);
  Cookie cookie=new Cookie(CSRF_STATE_COOKIE,sha256Hex(state));
  cookie.setPath("/");
  cookie.setHttpOnly(true);
  cookie.setMaxAge(-1);
  cookie.setSecure(server.isSecured());
  response.addCookie(cookie);
  return state;
}
