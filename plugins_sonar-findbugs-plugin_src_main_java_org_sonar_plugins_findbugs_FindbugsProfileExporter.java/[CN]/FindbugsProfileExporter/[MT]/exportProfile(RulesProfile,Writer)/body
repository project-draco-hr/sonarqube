{
  try {
    FindBugsFilter filter=buildFindbugsFilter(profile.getActiveRulesByRepository(FindbugsConstants.REPOSITORY_KEY));
    XStream xstream=FindBugsFilter.createXStream();
    writer.append("<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!-- Generated by Sonar -->\n".concat(xstream.toXML(filter)));
  }
 catch (  IOException e) {
    throw new SonarException("Fail to export the Findbugs profile : " + profile,e);
  }
}
