{
  userSession.login().setGlobalPermissions(GlobalPermissions.SYSTEM_ADMIN);
  dbClient=db.getDbClient();
  dbSession=db.getSession();
  defautTemplatePermissionFinder=mock(DefaultPermissionTemplateFinder.class);
  when(defautTemplatePermissionFinder.getDefaultTemplateUuids()).thenReturn(Collections.<String>emptySet());
  PermissionDependenciesFinder finder=new PermissionDependenciesFinder(dbClient,new ComponentFinder(dbClient));
  ws=new WsActionTester(new DeleteTemplateAction(dbClient,userSession,finder,defautTemplatePermissionFinder));
  permissionTemplate=insertTemplateAndAssociatedPermissions(newPermissionTemplateDto().setKee(TEMPLATE_UUID));
  PermissionTemplateDto permissionTemplateInDatabase=dbClient.permissionTemplateDao().selectByUuidWithUserAndGroupPermissions(dbSession,TEMPLATE_UUID);
  assertThat(permissionTemplateInDatabase.getKee()).isEqualTo(TEMPLATE_UUID);
  assertThat(permissionTemplateInDatabase.getGroupsPermissions()).isNotEmpty();
  assertThat(permissionTemplateInDatabase.getUsersPermissions()).isNotEmpty();
}
