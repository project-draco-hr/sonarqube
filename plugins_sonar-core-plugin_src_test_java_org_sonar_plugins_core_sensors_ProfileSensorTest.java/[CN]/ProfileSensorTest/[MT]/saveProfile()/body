{
  RulesProfile profile=mock(RulesProfile.class);
  when(profile.getId()).thenReturn(22);
  when(profile.getName()).thenReturn("fake");
  when(profile.getVersion()).thenReturn(2);
  ModuleLanguages moduleLanguages=new ModuleLanguages(new Settings(),new Languages(Java.INSTANCE));
  moduleLanguages.addLanguage("java");
  Map<String,RulesProfile> ruleProfilesPerLanguages=new HashMap<String,RulesProfile>();
  ruleProfilesPerLanguages.put("java",profile);
  RulesProfileWrapper wrapper=new RulesProfileWrapper(moduleLanguages,ruleProfilesPerLanguages);
  SensorContext context=mock(SensorContext.class);
  DatabaseSession session=mock(DatabaseSession.class);
  ProfileSensor sensor=new ProfileSensor(wrapper,session,moduleLanguages);
  sensor.analyse(null,context);
  verify(context).saveMeasure(argThat(new IsMeasure(CoreMetrics.PROFILE,22d)));
  verify(context).saveMeasure(argThat(new IsMeasure(CoreMetrics.PROFILE_VERSION,2d)));
}
