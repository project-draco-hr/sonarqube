{
  Preconditions.checkArgument(dir.isDirectory(),"Not a directory: " + dir.getAbsolutePath());
  File file=new File(path);
  if (!file.isAbsolute()) {
    try {
      file=new File(dir,path).getCanonicalFile();
    }
 catch (    Exception e) {
      throw new IllegalStateException("Fail to resolve path '" + path + "' relative to: "+ dir.getAbsolutePath(),e);
    }
  }
  return file;
}
