{
  final String defaultGroup=settings.getString(CoreProperties.CORE_DEFAULT_GROUP);
  if (defaultGroup == null) {
    throw new IllegalStateException(String.format("The default group property '%s' is null",CoreProperties.CORE_DEFAULT_GROUP));
  }
  List<GroupDto> userGroups=dbClient.groupDao().findByUserLogin(dbSession,userDto.getLogin());
  if (!Iterables.any(userGroups,new Predicate<GroupDto>(){
    @Override public boolean apply(    @Nullable GroupDto input){
      return input != null && input.getKey().equals(defaultGroup);
    }
  }
)) {
    GroupDto groupDto=dbClient.groupDao().selectByKey(dbSession,defaultGroup);
    dbClient.userGroupDao().insert(dbSession,new UserGroupDto().setUserId(userDto.getId()).setGroupId(groupDto.getId()));
  }
}
