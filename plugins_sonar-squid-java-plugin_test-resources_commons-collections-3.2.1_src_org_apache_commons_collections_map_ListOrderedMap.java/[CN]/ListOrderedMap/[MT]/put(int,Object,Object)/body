{
  Map m=getMap();
  if (m.containsKey(key)) {
    Object result=m.remove(key);
    int pos=insertOrder.indexOf(key);
    insertOrder.remove(pos);
    if (pos < index) {
      index--;
    }
    insertOrder.add(index,key);
    m.put(key,value);
    return result;
  }
 else {
    insertOrder.add(index,key);
    m.put(key,value);
    return null;
  }
}
