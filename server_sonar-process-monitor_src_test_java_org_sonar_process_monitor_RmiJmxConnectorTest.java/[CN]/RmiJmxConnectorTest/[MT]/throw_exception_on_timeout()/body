{
  RmiJmxConnector connector=new RmiJmxConnector();
  ProcessRef ref=mock(ProcessRef.class);
  ProcessMXBean mxBean=mock(ProcessMXBean.class);
  connector.register(ref,mxBean);
  when(mxBean.isReady()).thenAnswer(new Answer<Boolean>(){
    @Override public Boolean answer(    InvocationOnMock invocationOnMock) throws Throwable {
      Thread.sleep(Long.MAX_VALUE);
      return null;
    }
  }
);
  try {
    connector.isReady(ref,5L);
    fail();
  }
 catch (  IllegalStateException e) {
    assertThat(e).hasMessage("Fail send JMX request");
  }
}
