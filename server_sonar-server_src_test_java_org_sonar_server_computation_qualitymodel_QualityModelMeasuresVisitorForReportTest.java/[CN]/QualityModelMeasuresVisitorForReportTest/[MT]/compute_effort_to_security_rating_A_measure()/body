{
  treeRootHolder.setRoot(ROOT_PROJECT);
  fillComponentIssuesVisitorRule.setIssues(FILE_1_REF,newVulnerabilityIssue(8L,BLOCKER),newVulnerabilityIssue(6L,MAJOR),newCodeSmellIssue(4L,MAJOR),newVulnerabilityIssue(10L,BLOCKER).setResolution(RESOLUTION_FIXED));
  fillComponentIssuesVisitorRule.setIssues(FILE_2_REF,newVulnerabilityIssue(2L,CRITICAL),newVulnerabilityIssue(1L,MINOR),newVulnerabilityIssue(5L,INFO),newIssue(MAJOR,VULNERABILITY));
  underTest.visit(ROOT_PROJECT);
  verifyAddedRawMeasure(FILE_1_REF,EFFORT_TO_REACH_SECURITY_RATING_A_KEY,8L + 6L);
  verifyAddedRawMeasure(FILE_2_REF,EFFORT_TO_REACH_SECURITY_RATING_A_KEY,2L + 1L);
  verifyAddedRawMeasure(DIRECTORY_REF,EFFORT_TO_REACH_SECURITY_RATING_A_KEY,17L);
  verifyAddedRawMeasure(MODULE_REF,EFFORT_TO_REACH_SECURITY_RATING_A_KEY,17L);
  verifyAddedRawMeasure(PROJECT_REF,EFFORT_TO_REACH_SECURITY_RATING_A_KEY,17L);
}
