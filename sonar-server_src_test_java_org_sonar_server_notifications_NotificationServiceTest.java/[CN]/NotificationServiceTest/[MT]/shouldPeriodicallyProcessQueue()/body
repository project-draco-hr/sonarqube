{
  NotificationQueueElement queueElement=mock(NotificationQueueElement.class);
  Notification notification=mock(Notification.class);
  when(queueElement.getNotification()).thenReturn(notification);
  when(manager.getFromQueue()).thenReturn(queueElement).thenReturn(null);
  doNothing().when(service).deliver(any(Notification.class));
  service.setPeriod(10);
  service.start();
  Thread.sleep(50);
  service.stop();
  verify(service).deliver(notification);
}
