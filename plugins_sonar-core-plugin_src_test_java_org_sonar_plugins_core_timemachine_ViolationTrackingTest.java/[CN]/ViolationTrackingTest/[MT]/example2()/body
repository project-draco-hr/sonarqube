{
  when(lastSnapshots.getSource(project)).thenReturn(load("example2-v1"));
  String source=load("example2-v2");
  RuleFailureModel referenceViolation1=newReferenceViolation("SystemPrintln",5,50);
  Violation newViolation1=newViolation("SystemPrintln",6,50);
  Violation newViolation2=newViolation("SystemPrintln",10,50);
  Violation newViolation3=newViolation("SystemPrintln",14,50);
  Map<Violation,RuleFailureModel> mapping=decorator.mapViolations(Arrays.asList(newViolation1,newViolation2,newViolation3),Arrays.asList(referenceViolation1),source,project);
  assertThat(newViolation1.isNew(),is(true));
  assertThat(newViolation2.isNew(),is(false));
  assertThat(mapping.get(newViolation2),equalTo(referenceViolation1));
  assertThat(newViolation3.isNew(),is(true));
}
