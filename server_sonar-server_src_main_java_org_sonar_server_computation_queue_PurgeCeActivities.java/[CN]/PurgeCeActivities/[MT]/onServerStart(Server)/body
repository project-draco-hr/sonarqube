{
  DbSession dbSession=dbClient.openSession(true);
  try {
    Calendar sixMonthsAgo=Calendar.getInstance();
    sixMonthsAgo.setTimeInMillis(system2.now());
    sixMonthsAgo.add(Calendar.DATE,-180);
    LOGGER.info("Delete the Compute Engine tasks created before {}",sixMonthsAgo.getTime());
    List<CeActivityDto> dtos=dbClient.ceActivityDao().selectOlderThan(dbSession,sixMonthsAgo.getTimeInMillis());
    for (    CeActivityDto dto : dtos) {
      dbClient.ceActivityDao().deleteByUuid(dbSession,dto.getUuid());
      ceLogging.deleteIfExists(LogFileRef.from(dto));
    }
    dbSession.commit();
  }
  finally {
    dbClient.closeSession(dbSession);
  }
}
