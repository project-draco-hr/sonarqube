{
  ComponentDto project=ComponentTesting.newProjectDto();
  ComponentDto file=ComponentTesting.newFileDto(project);
  dbClient.componentDao().insert(dbSession,project,file);
  RuleDto rule=RuleTesting.newXooX1();
  tester.get(RuleDao.class).insert(dbSession,rule);
  dbClient.issueDao().insert(dbSession,IssueTesting.newDto(rule,file,project));
  dbSession.commit();
  assertThat(indexClient.get(IssueIndex.class).countAll()).isEqualTo(1);
  tester.clearIndexes();
  assertThat(indexClient.get(IssueIndex.class).countAll()).isEqualTo(0);
  synchronizer.execute();
  assertThat(indexClient.get(IssueIndex.class).countAll()).isEqualTo(1);
}
