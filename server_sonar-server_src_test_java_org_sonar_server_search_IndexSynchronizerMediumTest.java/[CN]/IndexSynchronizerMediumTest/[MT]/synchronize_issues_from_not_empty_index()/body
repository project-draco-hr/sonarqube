{
  RuleDto rule=RuleTesting.newXooX1();
  tester.get(RuleDao.class).insert(dbSession,rule);
  ComponentDto project1=ComponentTesting.newProjectDto();
  ComponentDto file1=ComponentTesting.newFileDto(project1);
  dbClient.componentDao().insert(dbSession,project1,file1);
  dbClient.issueDao().insert(dbSession,IssueTesting.newDto(rule,file1,project1));
  ComponentDto project2=ComponentTesting.newProjectDto();
  ComponentDto file2=ComponentTesting.newFileDto(project2);
  dbClient.componentDao().insert(dbSession,project2,file2);
  dbClient.issueDao().insert(dbSession,IssueTesting.newDto(rule,file2,project2));
  dbSession.commit();
  indexClient.get(IssueIndex.class).deleteByProjectUuid(project2.uuid());
  assertThat(indexClient.get(IssueIndex.class).countAll()).isEqualTo(1);
  synchronizer.execute();
  assertThat(indexClient.get(IssueIndex.class).countAll()).isEqualTo(2);
}
