{
  StopWatch watch=profiling.start("previewdb",Level.BASIC);
  String h2Name=destFolder.getAbsolutePath() + File.separator + dbFileName;
  try {
    DataSource source=database.getDataSource();
    BasicDataSource destination=create(DIALECT,DRIVER,USER,PASSWORD,URL + h2Name + ";LOG=0;CACHE_SIZE=65536;LOCK_MODE=0;UNDO_LOG=0");
    copy(source,destination,projectId);
    close(destination);
    File dbFile=new File(h2Name + H2_FILE_SUFFIX);
    long size=dbFile.length();
    String message="";
    if (projectId == null) {
      message="Preview Database created, size is " + size + " bytes";
    }
 else {
      message="Preview Database for project " + projectId + " created, size is "+ size+ " bytes";
    }
    watch.stop(message);
    return dbFile;
  }
 catch (  SQLException e) {
    throw new SonarException("Unable to create database for DryRun",e);
  }
}
