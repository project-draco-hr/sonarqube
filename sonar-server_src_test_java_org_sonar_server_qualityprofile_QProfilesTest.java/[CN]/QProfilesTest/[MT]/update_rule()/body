{
  RuleDto rule=new RuleDto().setId(11).setRepositoryKey("squid").setRuleKey("XPath_1387869254").setParentId(10);
  when(ruleDao.selectById(11)).thenReturn(rule);
  when(ruleDao.selectByName("Updated name")).thenReturn(null);
  Map<String,String> paramsByKey=ImmutableMap.of("max","21");
  qProfiles.updateRule(11,"Updated name",Severity.MAJOR,"Updated description",paramsByKey);
  verify(ruleOperations).updateRule(eq(rule),eq("Updated name"),eq(Severity.MAJOR),eq("Updated description"),eq(paramsByKey),any(UserSession.class));
  verify(rules).findByRuleId(11);
}
