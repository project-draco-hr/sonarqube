{
  QualityProfileDto parentProfile=new QualityProfileDto().setId(2).setName("Parent").setLanguage("java");
  when(qualityProfileDao.selectByNameAndLanguage("Parent","java")).thenReturn(parentProfile);
  QualityProfileDto qualityProfile=new QualityProfileDto().setId(1).setName("My profile").setLanguage("java").setParent("Parent");
  when(qualityProfileDao.selectById(1)).thenReturn(qualityProfile);
  RuleDto rule=new RuleDto().setId(10).setRepositoryKey("squid").setRuleKey("AvoidCycle");
  when(ruleDao.selectById(10)).thenReturn(rule);
  when(activeRuleOperations.createActiveRule(eq(qualityProfile),eq(rule),eq(Severity.BLOCKER),any(UserSession.class))).thenReturn(new ActiveRuleDto().setId(5).setProfileId(1).setRuleId(10).setSeverity(1));
  ProfileRuleChanged result=qProfiles.activateRule(1,10,Severity.BLOCKER);
  assertThat(result.parentProfile()).isNotNull();
  assertThat(result.parentProfile().id()).isEqualTo(2);
}
